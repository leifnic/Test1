OBJECT Table 36 Sales Header
{
  OBJECT-PROPERTIES
  {
    Date=29-06-17;
    Time=09:34:32;
    Modified=Yes;
    Version List=NAVW18.00.00.38457,NAVDK8.00.00.38457,PM8.00.00.2.14;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Sell-to Customer Name;
    OnInsert=BEGIN
               InitInsert;
               InsertMode := TRUE;

               IF GetFilterCustNo <> '' THEN
                 VALIDATE("Sell-to Customer No.",GetFilterCustNo);

               IF GetFilterContNo <> '' THEN
                 VALIDATE("Sell-to Contact No.",GetFilterContNo);

               "Doc. No. Occurrence" := ArchiveManagement.GetNextOccurrenceNo(DATABASE::"Sales Header","Document Type","No.");

               //>>SYS
               "Ordre Oprettet af" := USERID;
               "Ordre Oprettet DT" := CURRENTDATETIME;

               IF "Document Type" = "Document Type"::Order THEN
                 DEKO.Tilf›jMineOrdrer("No.");
               //<<SYS
             END;

    OnDelete=VAR
               Opp@1000 : Record 5092;
               TempOpportunityEntry@1001 : TEMPORARY Record 5093;
               DOPaymentTransLogEntry@1002 : Record 829;
             BEGIN
               IF DOPaymentTransLogEntry.FINDFIRST THEN
                 DOPaymentTransLogMgt.ValidateCanDeleteDocument("Payment Method Code","Document Type",FORMAT("Document Type"),"No.");

               IF NOT UserSetupMgt.CheckRespCenter(0,"Responsibility Center") THEN
                 ERROR(
                   Text022,
                   RespCenter.TABLECAPTION,UserSetupMgt.GetSalesFilter);

               IF ("Opportunity No." <> '') AND
                  ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order])
               THEN
                 IF Opp.GET("Opportunity No.") THEN BEGIN
                   IF "Document Type" = "Document Type"::Order THEN BEGIN
                     IF NOT CONFIRM(Text040,TRUE) THEN
                       ERROR(Text044);
                     TempOpportunityEntry.INIT;
                     TempOpportunityEntry.VALIDATE("Opportunity No.",Opp."No.");
                     TempOpportunityEntry."Sales Cycle Code" := Opp."Sales Cycle Code";
                     TempOpportunityEntry."Contact No." := Opp."Contact No.";
                     TempOpportunityEntry."Contact Company No." := Opp."Contact Company No.";
                     TempOpportunityEntry."Salesperson Code" := Opp."Salesperson Code";
                     TempOpportunityEntry."Campaign No." := Opp."Campaign No.";
                     TempOpportunityEntry."Action Taken" := TempOpportunityEntry."Action Taken"::Lost;
                     TempOpportunityEntry.INSERT;
                     TempOpportunityEntry.SETRANGE("Action Taken",TempOpportunityEntry."Action Taken"::Lost);
                     PAGE.RUNMODAL(PAGE::"Close Opportunity",TempOpportunityEntry);
                     IF Opp.GET("Opportunity No.") THEN
                       IF Opp.Status <> Opp.Status::Lost THEN
                         ERROR(Text043);
                   END;
                   Opp."Sales Document Type" := Opp."Sales Document Type"::" ";
                   Opp."Sales Document No." := '';
                   Opp.MODIFY;
                   "Opportunity No." := '';
                 END;

               SalesPost.DeleteHeader(
                 Rec,SalesShptHeader,SalesInvHeader,SalesCrMemoHeader,ReturnRcptHeader,SalesInvHeaderPrepmt,SalesCrMemoHeaderPrepmt);
               VALIDATE("Applies-to ID",'');

               ApprovalMgt.DeleteApprovalEntry(DATABASE::"Sales Header","Document Type","No.");
               SalesLine.RESET;
               SalesLine.LOCKTABLE;

               WhseRequest.SETRANGE("Source Type",DATABASE::"Sales Line");
               WhseRequest.SETRANGE("Source Subtype","Document Type");
               WhseRequest.SETRANGE("Source No.","No.");
               WhseRequest.DELETEALL(TRUE);

               SalesLine.SETRANGE("Document Type","Document Type");
               SalesLine.SETRANGE("Document No.","No.");
               SalesLine.SETRANGE(Type,SalesLine.Type::"Charge (Item)");

               DeleteSalesLines;
               SalesLine.SETRANGE(Type);
               DeleteSalesLines;

               SalesCommentLine.SETRANGE("Document Type","Document Type");
               SalesCommentLine.SETRANGE("No.","No.");
               SalesCommentLine.DELETEALL;

               IF (SalesShptHeader."No." <> '') OR
                  (SalesInvHeader."No." <> '') OR
                  (SalesCrMemoHeader."No." <> '') OR
                  (ReturnRcptHeader."No." <> '') OR
                  (SalesInvHeaderPrepmt."No." <> '') OR
                  (SalesCrMemoHeaderPrepmt."No." <> '')
               THEN BEGIN
                 COMMIT;

                 //>>SYS
                 {IF SalesShptHeader."No." <> '' THEN
                   IF CONFIRM(
                        Text000,TRUE,
                        SalesShptHeader."No.")
                   THEN BEGIN
                     SalesShptHeader.SETRECFILTER;
                     SalesShptHeader.PrintRecords(TRUE);
                   END;

                 IF SalesInvHeader."No." <> '' THEN
                   IF CONFIRM(
                        Text001,TRUE,
                        SalesInvHeader."No.")
                   THEN BEGIN
                     SalesInvHeader.SETRECFILTER;
                     SalesInvHeader.PrintRecords(TRUE);
                   END;

                 IF SalesCrMemoHeader."No." <> '' THEN
                   IF CONFIRM(
                        Text002,TRUE,
                        SalesCrMemoHeader."No.")
                   THEN BEGIN
                     SalesCrMemoHeader.SETRECFILTER;
                     SalesCrMemoHeader.PrintRecords(TRUE);
                   END;

                 IF ReturnRcptHeader."No." <> '' THEN
                   IF CONFIRM(
                        Text023,TRUE,
                        ReturnRcptHeader."No.")
                   THEN BEGIN
                     ReturnRcptHeader.SETRECFILTER;
                     ReturnRcptHeader.PrintRecords(TRUE);
                   END;

                 IF SalesInvHeaderPrepmt."No." <> '' THEN
                   IF CONFIRM(
                        Text055,TRUE,
                        SalesInvHeader."No.")
                   THEN BEGIN
                     SalesInvHeaderPrepmt.SETRECFILTER;
                     SalesInvHeaderPrepmt.PrintRecords(TRUE);
                   END;

                 IF SalesCrMemoHeaderPrepmt."No." <> '' THEN
                   IF CONFIRM(
                        Text054,TRUE,
                        SalesCrMemoHeaderPrepmt."No.")
                   THEN BEGIN
                     SalesCrMemoHeaderPrepmt.SETRECFILTER;
                     SalesCrMemoHeaderPrepmt.PrintRecords(TRUE);
                   END;
                 }
                 //<<SYS

               END;

               //>>SYS
               IF D›rskemaHoved.GET("Document Type","No.") THEN
                 D›rskemaHoved.DELETE(TRUE);

               IF Glasskemahoved.GET("Document Type","No.") THEN
                 Glasskemahoved.DELETE(TRUE);

               D›rskemaHoved.RESET;
               D›rskemaHoved.SETCURRENTKEY("Document Type","D›r Ordrenr.");
               D›rskemaHoved.SETRANGE("Document Type","Document Type");
               D›rskemaHoved.SETRANGE("D›r Ordrenr.","No.");
               IF D›rskemaHoved.FINDFIRST THEN BEGIN
                 D›rskemalinie.SETRANGE("Document Type",D›rskemaHoved."Document Type");
                 D›rskemalinie.SETRANGE("Dokument No",D›rskemaHoved."Dokument No");
                 D›rskemalinie.MODIFYALL("D›r Linienr.",0);
                 D›rskemaHoved."D›r Ordrenr." := '';
                 D›rskemaHoved.MODIFY;
               END;

               IF MaletProfilSkemahoved.GET("Document Type","No.") THEN
                 MaletProfilSkemahoved.DELETE(TRUE);
               MaletProfilSkemahoved.RESET;
               MaletProfilSkemahoved.SETCURRENTKEY("Document Type","Profil Ordrenr.");
               MaletProfilSkemahoved.SETRANGE("Document Type","Document Type");
               MaletProfilSkemahoved.SETRANGE("Profil Ordrenr.","No.");
               IF MaletProfilSkemahoved.FINDFIRST THEN BEGIN
                 MaletProfilSkemalinie.SETRANGE("Document Type",MaletProfilSkemahoved."Document Type");
                 MaletProfilSkemalinie.SETRANGE("Dokument No",MaletProfilSkemahoved."Dokument No");
                 MaletProfilSkemalinie.MODIFYALL("Profil Linienr.",0);
                 MaletProfilSkemahoved."Profil Ordrenr." := '';
                 MaletProfilSkemahoved.MODIFY;
               END;

               MySalesOrders.SETCURRENTKEY("Order No.");
               MySalesOrders.SETRANGE("Order No.","No.");
               MySalesOrders.DELETEALL;
               //<<SYS
             END;

    OnRename=BEGIN
               ERROR(Text003,TABLECAPTION);
             END;

    CaptionML=[DAN=Salgshoved;
               ENU=Sales Header];
    LookupPageID=Page45;
  }
  FIELDS
  {
    { 1   ;   ;Document Type       ;Option        ;CaptionML=[DAN=Bilagstype;
                                                              ENU=Document Type];
                                                   OptionCaptionML=[DAN=Tilbud,Ordre,Faktura,Kreditnota,Rammeordre,Returv.ordre;
                                                                    DEU=Quote,Auftragsbest„tigung,Invoice,Credit Memo,Blanket Order,Return Order;
                                                                    ENU=Quote,Order Confirmation,Invoice,Credit Memo,Blanket Order,Return Order];
                                                   OptionString=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order }
    { 2   ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                CheckCreditLimitIfLineNotInsertedYet;
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Sell-to Customer No." <> xRec."Sell-to Customer No.") AND
                                                                   (xRec."Sell-to Customer No." <> '')
                                                                THEN BEGIN
                                                                  IF ("Opportunity No." <> '') AND ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) THEN
                                                                    ERROR(
                                                                      Text062,
                                                                      FIELDCAPTION("Sell-to Customer No."),
                                                                      FIELDCAPTION("Opportunity No."),
                                                                      "Opportunity No.",
                                                                      "Document Type");
                                                                  IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Sell-to Customer No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    SalesLine.SETRANGE("Document Type","Document Type");
                                                                    SalesLine.SETRANGE("Document No.","No.");
                                                                    IF "Sell-to Customer No." = '' THEN BEGIN
                                                                      IF SalesLine.FINDFIRST THEN
                                                                        ERROR(
                                                                          Text005,
                                                                          FIELDCAPTION("Sell-to Customer No."));
                                                                      INIT;
                                                                      SalesSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      IF xRec."Shipping No." <> '' THEN BEGIN
                                                                        "Shipping No. Series" := xRec."Shipping No. Series";
                                                                        "Shipping No." := xRec."Shipping No.";
                                                                      END;
                                                                      IF xRec."Posting No." <> '' THEN BEGIN
                                                                        "Posting No. Series" := xRec."Posting No. Series";
                                                                        "Posting No." := xRec."Posting No.";
                                                                      END;
                                                                      IF xRec."Return Receipt No." <> '' THEN BEGIN
                                                                        "Return Receipt No. Series" := xRec."Return Receipt No. Series";
                                                                        "Return Receipt No." := xRec."Return Receipt No.";
                                                                      END;
                                                                      IF xRec."Prepayment No." <> '' THEN BEGIN
                                                                        "Prepayment No. Series" := xRec."Prepayment No. Series";
                                                                        "Prepayment No." := xRec."Prepayment No.";
                                                                      END;
                                                                      IF xRec."Prepmt. Cr. Memo No." <> '' THEN BEGIN
                                                                        "Prepmt. Cr. Memo No. Series" := xRec."Prepmt. Cr. Memo No. Series";
                                                                        "Prepmt. Cr. Memo No." := xRec."Prepmt. Cr. Memo No.";
                                                                      END;
                                                                      EXIT;
                                                                    END;
                                                                    IF "Document Type" = "Document Type"::Order THEN
                                                                      SalesLine.SETFILTER("Quantity Shipped",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::Invoice THEN BEGIN
                                                                        SalesLine.SETRANGE("Sell-to Customer No.",xRec."Sell-to Customer No.");
                                                                        SalesLine.SETFILTER("Shipment No.",'<>%1','');
                                                                      END;

                                                                    IF SalesLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        SalesLine.TESTFIELD("Quantity Shipped",0)
                                                                      ELSE
                                                                        SalesLine.TESTFIELD("Shipment No.",'');
                                                                    SalesLine.SETRANGE("Shipment No.");
                                                                    SalesLine.SETRANGE("Quantity Shipped");

                                                                    IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                      SalesLine.SETFILTER("Prepmt. Amt. Inv.",'<>0');
                                                                      IF SalesLine.FIND('-') THEN
                                                                        SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                      SalesLine.SETRANGE("Prepmt. Amt. Inv.");
                                                                    END;

                                                                    IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                      SalesLine.SETFILTER("Return Qty. Received",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
                                                                        SalesLine.SETRANGE("Sell-to Customer No.",xRec."Sell-to Customer No.");
                                                                        SalesLine.SETFILTER("Return Receipt No.",'<>%1','');
                                                                      END;

                                                                    IF SalesLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                        SalesLine.TESTFIELD("Return Qty. Received",0)
                                                                      ELSE
                                                                        SalesLine.TESTFIELD("Return Receipt No.",'');
                                                                    SalesLine.RESET
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   (xRec."Sell-to Customer No." <> "Sell-to Customer No.")
                                                                THEN BEGIN
                                                                  SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Purch. Order Line No.",'<>0');
                                                                  IF NOT SalesLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Sell-to Customer No."));
                                                                  SalesLine.RESET;
                                                                END;

                                                                GetCust("Sell-to Customer No.");

                                                                Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE);
                                                                Cust.TESTFIELD("Gen. Bus. Posting Group");
                                                                "Sell-to Customer Template Code" := '';
                                                                "Sell-to Customer Name" := Cust.Name;
                                                                "Sell-to Customer Name 2" := Cust."Name 2";
                                                                "Sell-to Address" := Cust.Address;
                                                                "Sell-to Address 2" := Cust."Address 2";
                                                                "Sell-to City" := Cust.City;
                                                                "Sell-to Post Code" := Cust."Post Code";
                                                                "Sell-to County" := Cust.County;
                                                                "Sell-to Country/Region Code" := Cust."Country/Region Code";
                                                                "Account Code" := Cust."Account Code";
                                                                IF NOT SkipSellToContact THEN
                                                                  "Sell-to Contact" := Cust.Contact;
                                                                "Gen. Bus. Posting Group" := Cust."Gen. Bus. Posting Group";
                                                                "VAT Bus. Posting Group" := Cust."VAT Bus. Posting Group";
                                                                "Tax Area Code" := Cust."Tax Area Code";
                                                                "Tax Liable" := Cust."Tax Liable";
                                                                "VAT Registration No." := Cust."VAT Registration No.";
                                                                "VAT Country/Region Code" := Cust."Country/Region Code";
                                                                "Shipping Advice" := Cust."Shipping Advice";
                                                                "Responsibility Center" := UserSetupMgt.GetRespCenter(0,Cust."Responsibility Center");
                                                                VALIDATE("Location Code",UserSetupMgt.GetLocation(0,Cust."Location Code","Responsibility Center"));

                                                                IF "Sell-to Customer No." = xRec."Sell-to Customer No." THEN
                                                                  IF ShippedSalesLinesExist OR ReturnReceiptExist THEN BEGIN
                                                                    TESTFIELD("VAT Bus. Posting Group",xRec."VAT Bus. Posting Group");
                                                                    TESTFIELD("Gen. Bus. Posting Group",xRec."Gen. Bus. Posting Group");
                                                                  END;

                                                                "Sell-to IC Partner Code" := Cust."IC Partner Code";
                                                                "Send IC Document" := ("Sell-to IC Partner Code" <> '') AND ("IC Direction" = "IC Direction"::Outgoing);

                                                                IF Cust."Bill-to Customer No." <> '' THEN
                                                                  VALIDATE("Bill-to Customer No.",Cust."Bill-to Customer No.")
                                                                ELSE BEGIN
                                                                  IF "Bill-to Customer No." = "Sell-to Customer No." THEN
                                                                    SkipBillToContact := TRUE;
                                                                  VALIDATE("Bill-to Customer No.","Sell-to Customer No.");
                                                                  SkipBillToContact := FALSE;
                                                                END;

                                                                //>>SYS
                                                                IF "Ship-to Code" <> '' THEN
                                                                  VALIDATE("Ship-to Code",'');
                                                                "Shipping Agent Code" := Cust."Shipping Agent Code";
                                                                //<<SYS

                                                                GetShippingTime(FIELDNO("Sell-to Customer No."));

                                                                IF (xRec."Sell-to Customer No." <> "Sell-to Customer No.") OR
                                                                   (xRec."Currency Code" <> "Currency Code") OR
                                                                   (xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group") OR
                                                                   (xRec."VAT Bus. Posting Group" <> "VAT Bus. Posting Group")
                                                                THEN
                                                                  RecreateSalesLines(FIELDCAPTION("Sell-to Customer No."));

                                                                IF NOT SkipSellToContact THEN
                                                                  UpdateSellToCont("Sell-to Customer No.");

                                                                //>>SYS
                                                                IF Job.GET("Job No.") THEN BEGIN
                                                                  IF "Sell-to Customer No." <> xRec."Sell-to Customer No." THEN BEGIN
                                                                    VALIDATE("Shortcut Dimension 1 Code",Job."Global Dimension 1 Code");
                                                                    "Salesperson Code" := Job.Entrepriseleder;
                                                                  END;
                                                                END;

                                                                IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                  OrderCommentLine.SETRANGE("No.","Sell-to Customer No.");
                                                                  IF OrderCommentLine.FINDSET THEN BEGIN
                                                                    REPEAT
                                                                      CLEAR(SalesCommentLine);
                                                                      SalesCommentLine."Document Type" := SalesCommentLine."Document Type"::Order;
                                                                      SalesCommentLine."No." := "No.";
                                                                      //SalesCommentLine."Document Line No."
                                                                      SalesCommentLine."Line No." := OrderCommentLine."Line No.";
                                                                      SalesCommentLine.Date := OrderCommentLine.Date;
                                                                      SalesCommentLine.Comment := OrderCommentLine.Comment;
                                                                      SalesCommentLine."Udskrives p†" := SalesCommentLine."Udskrives p†"::Plukliste;
                                                                      SalesCommentLine.INSERT;
                                                                    UNTIL OrderCommentLine.NEXT = 0;
                                                                  END;
                                                                END;
                                                                //<<SYS
                                                              END;

                                                   CaptionML=[DAN=Kundenr.;
                                                              DEU="Kundenummer ";
                                                              ENU=Sell-to Customer No.] }
    { 3   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  NoSeriesMgt.TestManual(GetNoSeriesCode);
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[DAN=Nummer;
                                                              ENU=No.] }
    { 4   ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                BilltoCustomerNoChanged := xRec."Bill-to Customer No." <> "Bill-to Customer No.";
                                                                IF BilltoCustomerNoChanged THEN
                                                                  IF xRec."Bill-to Customer No." = '' THEN
                                                                    InitRecord
                                                                  ELSE BEGIN
                                                                    VALIDATE("Credit Card No.",'');
                                                                    IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                      Confirmed := TRUE
                                                                    ELSE
                                                                      Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Bill-to Customer No."));
                                                                    IF Confirmed THEN BEGIN
                                                                      SalesLine.SETRANGE("Document Type","Document Type");
                                                                      SalesLine.SETRANGE("Document No.","No.");
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        SalesLine.SETFILTER("Quantity Shipped",'<>0')
                                                                      ELSE
                                                                        IF "Document Type" = "Document Type"::Invoice THEN
                                                                          SalesLine.SETFILTER("Shipment No.",'<>%1','');

                                                                      IF SalesLine.FINDFIRST THEN
                                                                        IF "Document Type" = "Document Type"::Order THEN
                                                                          SalesLine.TESTFIELD("Quantity Shipped",0)
                                                                        ELSE
                                                                          SalesLine.TESTFIELD("Shipment No.",'');
                                                                      SalesLine.SETRANGE("Shipment No.");
                                                                      SalesLine.SETRANGE("Quantity Shipped");

                                                                      IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                        SalesLine.SETFILTER("Prepmt. Amt. Inv.",'<>0');
                                                                        IF SalesLine.FIND('-') THEN
                                                                          SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                        SalesLine.SETRANGE("Prepmt. Amt. Inv.");
                                                                      END;

                                                                      IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                        SalesLine.SETFILTER("Return Qty. Received",'<>0')
                                                                      ELSE
                                                                        IF "Document Type" = "Document Type"::"Credit Memo" THEN
                                                                          SalesLine.SETFILTER("Return Receipt No.",'<>%1','');

                                                                      IF SalesLine.FINDFIRST THEN
                                                                        IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                          SalesLine.TESTFIELD("Return Qty. Received",0)
                                                                        ELSE
                                                                          SalesLine.TESTFIELD("Return Receipt No.",'');
                                                                      SalesLine.RESET
                                                                    END ELSE
                                                                      "Bill-to Customer No." := xRec."Bill-to Customer No.";
                                                                  END;

                                                                GetCust("Bill-to Customer No.");
                                                                Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE);
                                                                Cust.TESTFIELD("Customer Posting Group");
                                                                CheckCrLimit;

                                                                "EAN No." := Cust."EAN No.";
                                                                "Bill-to Customer Template Code" := '';
                                                                "Bill-to Name" := Cust.Name;
                                                                "Bill-to Name 2" := Cust."Name 2";
                                                                "Bill-to Address" := Cust.Address;
                                                                "Bill-to Address 2" := Cust."Address 2";
                                                                "Bill-to City" := Cust.City;
                                                                "Bill-to Post Code" := Cust."Post Code";
                                                                "Bill-to County" := Cust.County;
                                                                "Bill-to Country/Region Code" := Cust."Country/Region Code";
                                                                IF NOT SkipBillToContact THEN
                                                                  "Bill-to Contact" := Cust.Contact;
                                                                "Payment Terms Code" := Cust."Payment Terms Code";
                                                                "Prepmt. Payment Terms Code" := Cust."Payment Terms Code";

                                                                IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
                                                                  "Payment Method Code" := '';
                                                                  IF PaymentTerms.GET("Payment Terms Code") THEN
                                                                    IF PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN
                                                                      "Payment Method Code" := Cust."Payment Method Code"
                                                                END ELSE
                                                                  "Payment Method Code" := Cust."Payment Method Code";

                                                                GLSetup.GET;
                                                                IF GLSetup."Bill-to/Sell-to VAT Calc." = GLSetup."Bill-to/Sell-to VAT Calc."::"Bill-to/Pay-to No." THEN BEGIN
                                                                  "VAT Bus. Posting Group" := Cust."VAT Bus. Posting Group";
                                                                  "VAT Country/Region Code" := Cust."Country/Region Code";
                                                                  "VAT Registration No." := Cust."VAT Registration No.";
                                                                  "Gen. Bus. Posting Group" := Cust."Gen. Bus. Posting Group";
                                                                END;
                                                                "Customer Posting Group" := Cust."Customer Posting Group";
                                                                "Currency Code" := Cust."Currency Code";
                                                                "Customer Price Group" := Cust."Customer Price Group";
                                                                "Prices Including VAT" := Cust."Prices Including VAT";
                                                                "Allow Line Disc." := Cust."Allow Line Disc.";
                                                                "Invoice Disc. Code" := Cust."Invoice Disc. Code";
                                                                "Customer Disc. Group" := Cust."Customer Disc. Group";
                                                                "Language Code" := Cust."Language Code";
                                                                "Salesperson Code" := Cust."Salesperson Code";
                                                                "Combine Shipments" := Cust."Combine Shipments";
                                                                Reserve := Cust.Reserve;
                                                                IF "Document Type" = "Document Type"::Order THEN
                                                                  "Prepayment %" := Cust."Prepayment %";

                                                                IF NOT BilltoCustomerNoChanged THEN BEGIN
                                                                  IF ShippedSalesLinesExist THEN BEGIN
                                                                    TESTFIELD("Customer Disc. Group",xRec."Customer Disc. Group");
                                                                    TESTFIELD("Currency Code",xRec."Currency Code");
                                                                  END;
                                                                END;

                                                                CreateDim(
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");

                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Prepmt. Payment Terms Code");
                                                                VALIDATE("Payment Method Code");
                                                                VALIDATE("Currency Code");
                                                                VALIDATE("Prepayment %");

                                                                IF (xRec."Sell-to Customer No." = "Sell-to Customer No.") AND
                                                                   BilltoCustomerNoChanged
                                                                THEN BEGIN
                                                                  RecreateSalesLines(FIELDCAPTION("Bill-to Customer No."));
                                                                  BilltoCustomerNoChanged := FALSE;
                                                                END;
                                                                IF NOT SkipBillToContact THEN
                                                                  UpdateBillToCont("Bill-to Customer No.");

                                                                "Bill-to IC Partner Code" := Cust."IC Partner Code";
                                                                "Send IC Document" := ("Bill-to IC Partner Code" <> '') AND ("IC Direction" = "IC Direction"::Outgoing);
                                                                "OIOUBL Profile Code" := Cust."OIOUBL Profile Code";

                                                                //>>SYS
                                                                Eksporterkl‘ringskode := Cust.Eksporterkl‘ringskode;
                                                                //<<SYS
                                                              END;

                                                   CaptionML=[DAN=Faktureres til kundenr.;
                                                              DEU=Rechnung an Kundenummer;
                                                              ENU=Bill-to Customer No.];
                                                   NotBlank=Yes }
    { 5   ;   ;Bill-to Name        ;Text50        ;CaptionML=[DAN=Faktureringsnavn;
                                                              ENU=Bill-to Name] }
    { 6   ;   ;Bill-to Name 2      ;Text50        ;CaptionML=[DAN=Faktureringsnavn 2;
                                                              ENU=Bill-to Name 2] }
    { 7   ;   ;Bill-to Address     ;Text50        ;CaptionML=[DAN=Faktureringsadresse;
                                                              ENU=Bill-to Address] }
    { 8   ;   ;Bill-to Address 2   ;Text50        ;CaptionML=[DAN=Faktureringsadresse 2;
                                                              ENU=Bill-to Address 2] }
    { 9   ;   ;Bill-to City        ;Text30        ;TableRelation="Post Code".City;
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DAN=Faktureringsby;
                                                              ENU=Bill-to City] }
    { 10  ;   ;Bill-to Contact     ;Text50        ;CaptionML=[DAN=Faktureres attention;
                                                              ENU=Bill-to Contact] }
    { 11  ;   ;Your Reference      ;Text35        ;CaptionML=[DAN=Deres reference;
                                                              DEU=Ihr Zeichen;
                                                              ENU=Your Reference] }
    { 12  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Sell-to Customer No.));
                                                   OnValidate=BEGIN
                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   (xRec."Ship-to Code" <> "Ship-to Code")
                                                                THEN BEGIN
                                                                  SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Purch. Order Line No.",'<>0');
                                                                  IF NOT SalesLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Ship-to Code"));
                                                                  SalesLine.RESET;
                                                                END;

                                                                IF ("Document Type" <> "Document Type"::"Return Order") AND
                                                                   ("Document Type" <> "Document Type"::"Credit Memo")
                                                                THEN
                                                                  IF "Ship-to Code" <> '' THEN BEGIN
                                                                    IF xRec."Ship-to Code" <> '' THEN
                                                                      BEGIN
                                                                      GetCust("Sell-to Customer No.");
                                                                      IF Cust."Location Code" <> '' THEN
                                                                        VALIDATE("Location Code",Cust."Location Code");
                                                                      "Tax Area Code" := Cust."Tax Area Code";
                                                                    END;
                                                                    ShipToAddr.GET("Sell-to Customer No.","Ship-to Code");
                                                                    "Ship-to Name" := ShipToAddr.Name;
                                                                    "Ship-to Name 2" := ShipToAddr."Name 2";
                                                                    "Ship-to Address" := ShipToAddr.Address;
                                                                    "Ship-to Address 2" := ShipToAddr."Address 2";
                                                                    "Ship-to City" := ShipToAddr.City;
                                                                    "Ship-to Post Code" := ShipToAddr."Post Code";
                                                                    "Ship-to County" := ShipToAddr.County;
                                                                    VALIDATE("Ship-to Country/Region Code",ShipToAddr."Country/Region Code");
                                                                    "Ship-to Contact" := ShipToAddr.Contact;
                                                                    "Shipment Method Code" := ShipToAddr."Shipment Method Code";
                                                                    IF ShipToAddr."Location Code" <> '' THEN
                                                                      VALIDATE("Location Code",ShipToAddr."Location Code");

                                                                    //>>SYS
                                                                    //"Shipping Agent Code" := ShipToAddr."Shipping Agent Code";
                                                                    //"Shipping Agent Service Code" := ShipToAddr."Shipping Agent Service Code";
                                                                    //<<SYS

                                                                    IF ShipToAddr."Tax Area Code" <> '' THEN
                                                                      "Tax Area Code" := ShipToAddr."Tax Area Code";
                                                                    "Tax Liable" := ShipToAddr."Tax Liable";
                                                                  END ELSE
                                                                    IF "Sell-to Customer No." <> '' THEN BEGIN
                                                                      GetCust("Sell-to Customer No.");
                                                                      "Ship-to Name" := Cust.Name;
                                                                      "Ship-to Name 2" := Cust."Name 2";
                                                                      "Ship-to Address" := Cust.Address;
                                                                      "Ship-to Address 2" := Cust."Address 2";
                                                                      "Ship-to City" := Cust.City;
                                                                      "Ship-to Post Code" := Cust."Post Code";
                                                                      "Ship-to County" := Cust.County;
                                                                      VALIDATE("Ship-to Country/Region Code",Cust."Country/Region Code");
                                                                      "Ship-to Contact" := Cust.Contact;
                                                                      "Shipment Method Code" := Cust."Shipment Method Code";
                                                                      "Tax Area Code" := Cust."Tax Area Code";
                                                                      "Tax Liable" := Cust."Tax Liable";
                                                                      IF Cust."Location Code" <> '' THEN
                                                                        VALIDATE("Location Code",Cust."Location Code");

                                                                      //>>SYS
                                                                      //"Shipping Agent Code" := Cust."Shipping Agent Code";
                                                                      //"Shipping Agent Service Code" := Cust."Shipping Agent Service Code";
                                                                      //<<SYS

                                                                    END;

                                                                GetShippingTime(FIELDNO("Ship-to Code"));

                                                                IF (xRec."Sell-to Customer No." = "Sell-to Customer No.") AND
                                                                   (xRec."Ship-to Code" <> "Ship-to Code")
                                                                THEN
                                                                  IF (xRec."VAT Country/Region Code" <> "VAT Country/Region Code") OR
                                                                     (xRec."Tax Area Code" <> "Tax Area Code")
                                                                  THEN
                                                                    RecreateSalesLines(FIELDCAPTION("Ship-to Code"))
                                                                  ELSE BEGIN
                                                                    IF xRec."Shipping Agent Code" <> "Shipping Agent Code" THEN
                                                                      MessageIfSalesLinesExist(FIELDCAPTION("Shipping Agent Code"));
                                                                    IF xRec."Shipping Agent Service Code" <> "Shipping Agent Service Code" THEN
                                                                      MessageIfSalesLinesExist(FIELDCAPTION("Shipping Agent Service Code"));
                                                                    IF xRec."Tax Liable" <> "Tax Liable" THEN
                                                                      VALIDATE("Tax Liable");
                                                                  END;
                                                              END;

                                                   CaptionML=[DAN=Leveringsadressekode;
                                                              ENU=Ship-to Code] }
    { 13  ;   ;Ship-to Name        ;Text50        ;CaptionML=[DAN=Leveringsnavn;
                                                              ENU=Ship-to Name] }
    { 14  ;   ;Ship-to Name 2      ;Text50        ;CaptionML=[DAN=Leveringsnavn 2;
                                                              ENU=Ship-to Name 2] }
    { 15  ;   ;Ship-to Address     ;Text50        ;CaptionML=[DAN=Leveringsadresse;
                                                              ENU=Ship-to Address] }
    { 16  ;   ;Ship-to Address 2   ;Text50        ;CaptionML=[DAN=Leveringsadresse 2;
                                                              ENU=Ship-to Address 2] }
    { 17  ;   ;Ship-to City        ;Text30        ;TableRelation="Post Code".City;
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DAN=Leveringsby;
                                                              ENU=Ship-to City] }
    { 18  ;   ;Ship-to Contact     ;Text50        ;CaptionML=[DAN=Leveres attention;
                                                              ENU=Ship-to Contact] }
    { 19  ;   ;Order Date          ;Date          ;OnValidate=BEGIN
                                                                IF ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) AND
                                                                   NOT ("Order Date" = xRec."Order Date")
                                                                THEN
                                                                  PriceMessageIfSalesLinesExist(FIELDCAPTION("Order Date"));
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DAN=Ordredato;
                                                              ENU=Order Date] }
    { 20  ;   ;Posting Date        ;Date          ;OnValidate=BEGIN
                                                                TestNoSeriesDate(
                                                                  "Posting No.","Posting No. Series",
                                                                  FIELDCAPTION("Posting No."),FIELDCAPTION("Posting No. Series"));
                                                                TestNoSeriesDate(
                                                                  "Prepayment No.","Prepayment No. Series",
                                                                  FIELDCAPTION("Prepayment No."),FIELDCAPTION("Prepayment No. Series"));
                                                                TestNoSeriesDate(
                                                                  "Prepmt. Cr. Memo No.","Prepmt. Cr. Memo No. Series",
                                                                  FIELDCAPTION("Prepmt. Cr. Memo No."),FIELDCAPTION("Prepmt. Cr. Memo No. Series"));

                                                                VALIDATE("Document Date","Posting Date");

                                                                IF ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"]) AND
                                                                   NOT ("Posting Date" = xRec."Posting Date")
                                                                THEN
                                                                  PriceMessageIfSalesLinesExist(FIELDCAPTION("Posting Date"));

                                                                IF "Currency Code" <> '' THEN BEGIN
                                                                  UpdateCurrencyFactor;
                                                                  IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                    ConfirmUpdateCurrencyFactor;
                                                                END;

                                                                SynchronizeAsmHeader;
                                                              END;

                                                   CaptionML=[DAN=Bogf›ringsdato;
                                                              ENU=Posting Date] }
    { 21  ;   ;Shipment Date       ;Date          ;OnValidate=BEGIN
                                                                //>>INV
                                                                IF UserSetup.GET(USERID) THEN BEGIN
                                                                  IF UserSetup.Logistik = FALSE THEN
                                                                    TESTFIELD(Status,Status::Open);
                                                                END
                                                                ELSE
                                                                  TESTFIELD(Status,Status::Open);
                                                                //<<INV

                                                                UpdateSalesLines(FIELDCAPTION("Shipment Date"),CurrFieldNo <> 0);

                                                                //>>SYS
                                                                IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                  WarehouseActivityHeader.SETCURRENTKEY("Ordrenr.");
                                                                  WarehouseActivityHeader.SETRANGE("Ordrenr.","No.");
                                                                  IF WarehouseActivityHeader.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                    REPEAT
                                                                      WarehouseActivityHeader.Afsendelsesdato := "Shipment Date";
                                                                      WarehouseActivityHeader.MODIFY;
                                                                    UNTIL WarehouseActivityHeader.NEXT = 0;
                                                                  END;

                                                                  WarehouseShipmentHeader.SETCURRENTKEY("Order No.");
                                                                  WarehouseShipmentHeader.SETRANGE("Order No.","No.");
                                                                  IF WarehouseShipmentHeader.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                    REPEAT
                                                                      WarehouseShipmentHeader."Shipment Date" := "Shipment Date";
                                                                      WarehouseShipmentHeader.MODIFY;
                                                                    UNTIL WarehouseShipmentHeader.NEXT = 0;
                                                                  END;
                                                                END;
                                                                //<<SYS
                                                              END;

                                                   CaptionML=[DAN=Afsendelsesdato;
                                                              DEU=Versanddatum;
                                                              ENU=Shipment Date] }
    { 22  ;   ;Posting Description ;Text50        ;CaptionML=[DAN=Bogf›ringsbeskrivelse;
                                                              ENU=Posting Description] }
    { 23  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   OnValidate=BEGIN
                                                                IF ("Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Payment Terms Code");
                                                                  IF (("Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"]) AND
                                                                      NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos")
                                                                  THEN BEGIN
                                                                    VALIDATE("Due Date","Document Date");
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                    "Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    "Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    IF NOT UpdateDocumentDate THEN
                                                                      VALIDATE("Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Due Date","Document Date");
                                                                  IF NOT UpdateDocumentDate THEN BEGIN
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                  END;
                                                                END;
                                                                IF xRec."Payment Terms Code" = "Prepmt. Payment Terms Code" THEN BEGIN
                                                                  IF xRec."Prepayment Due Date" = 0D THEN
                                                                    "Prepayment Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                  VALIDATE("Prepmt. Payment Terms Code","Payment Terms Code");
                                                                END;
                                                              END;

                                                   CaptionML=[DAN=Betalingsbeting.kode;
                                                              ENU=Payment Terms Code] }
    { 24  ;   ;Due Date            ;Date          ;CaptionML=[DAN=Forfaldsdato;
                                                              ENU=Due Date] }
    { 25  ;   ;Payment Discount %  ;Decimal       ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[DAN=Kontantrabatpct.;
                                                              ENU=Payment Discount %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 26  ;   ;Pmt. Discount Date  ;Date          ;CaptionML=[DAN=Kont.rabatdato;
                                                              ENU=Pmt. Discount Date] }
    { 27  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                              END;

                                                   CaptionML=[DAN=Leveringskode;
                                                              ENU=Shipment Method Code] }
    { 28  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Location Code" <> xRec."Location Code") AND
                                                                   (xRec."Sell-to Customer No." = "Sell-to Customer No.")
                                                                THEN
                                                                  MessageIfSalesLinesExist(FIELDCAPTION("Location Code"));

                                                                UpdateShipToAddress;

                                                                IF "Location Code" <> '' THEN BEGIN
                                                                  IF Location.GET("Location Code") THEN
                                                                    "Outbound Whse. Handling Time" := Location."Outbound Whse. Handling Time";
                                                                END ELSE BEGIN
                                                                  IF InvtSetup.GET THEN
                                                                    "Outbound Whse. Handling Time" := InvtSetup."Outbound Whse. Handling Time";
                                                                END;
                                                              END;

                                                   CaptionML=[DAN=Lokationskode;
                                                              ENU=Location Code] }
    { 29  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[DAN=Genvejsdimension 1-kode;
                                                              ENU=Shortcut Dimension 1 Code];
                                                   CaptionClass='1,2,1' }
    { 30  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[DAN=Genvejsdimension 2-kode;
                                                              ENU=Shortcut Dimension 2 Code];
                                                   CaptionClass='1,2,2' }
    { 31  ;   ;Customer Posting Group;Code10      ;TableRelation="Customer Posting Group";
                                                   CaptionML=[DAN=Debitorbogf›ringsgruppe;
                                                              ENU=Customer Posting Group];
                                                   Editable=No }
    { 32  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=VAR
                                                                DOPaymentTransLogEntry@1001 : Record 829;
                                                              BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date")]) OR ("Currency Code" <> xRec."Currency Code") THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                IF DOPaymentTransLogEntry.FINDFIRST THEN
                                                                  DOPaymentTransLogMgt.ValidateHasNoValidTransactions("Document Type",FORMAT("Document Type"),"No.");
                                                                IF (CurrFieldNo <> FIELDNO("Currency Code")) AND ("Currency Code" = xRec."Currency Code") THEN
                                                                  UpdateCurrencyFactor
                                                                ELSE
                                                                  IF "Currency Code" <> xRec."Currency Code" THEN BEGIN
                                                                    UpdateCurrencyFactor;
                                                                    RecreateSalesLines(FIELDCAPTION("Currency Code"));
                                                                  END ELSE
                                                                    IF "Currency Code" <> '' THEN BEGIN
                                                                      UpdateCurrencyFactor;
                                                                      IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                        ConfirmUpdateCurrencyFactor;
                                                                    END;
                                                              END;

                                                   CaptionML=[DAN=Valutakode;
                                                              ENU=Currency Code] }
    { 33  ;   ;Currency Factor     ;Decimal       ;OnValidate=BEGIN
                                                                IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Currency Factor"),FALSE);
                                                              END;

                                                   CaptionML=[DAN=Valutafaktor;
                                                              ENU=Currency Factor];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0;
                                                   Editable=No }
    { 34  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   OnValidate=BEGIN
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Customer Price Group"));
                                                              END;

                                                   CaptionML=[DAN=Debitorprisgruppe;
                                                              ENU=Customer Price Group] }
    { 35  ;   ;Prices Including VAT;Boolean       ;OnValidate=VAR
                                                                SalesLine@1000 : Record 37;
                                                                Currency@1001 : Record 4;
                                                                RecalculatePrice@1002 : Boolean;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF "Prices Including VAT" <> xRec."Prices Including VAT" THEN BEGIN
                                                                  SalesLine.SETRANGE("Document Type","Document Type");
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Job Contract Entry No.",'<>%1',0);
                                                                  IF SalesLine.FIND('-') THEN BEGIN
                                                                    SalesLine.TESTFIELD("Job No.",'');
                                                                    SalesLine.TESTFIELD("Job Contract Entry No.",0);
                                                                  END;

                                                                  SalesLine.RESET;
                                                                  SalesLine.SETRANGE("Document Type","Document Type");
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Unit Price",'<>%1',0);
                                                                  SalesLine.SETFILTER("VAT %",'<>%1',0);
                                                                  IF SalesLine.FINDFIRST THEN BEGIN
                                                                    RecalculatePrice :=
                                                                      CONFIRM(
                                                                        STRSUBSTNO(
                                                                          Text024,
                                                                          FIELDCAPTION("Prices Including VAT"),SalesLine.FIELDCAPTION("Unit Price")),
                                                                        TRUE);
                                                                    SalesLine.SetSalesHeader(Rec);

                                                                    IF RecalculatePrice AND "Prices Including VAT" THEN
                                                                      SalesLine.MODIFYALL(Amount,0,TRUE);

                                                                    IF "Currency Code" = '' THEN
                                                                      Currency.InitRoundingPrecision
                                                                    ELSE
                                                                      Currency.GET("Currency Code");
                                                                    SalesLine.LOCKTABLE;
                                                                    LOCKTABLE;
                                                                    SalesLine.FINDSET;
                                                                    REPEAT
                                                                      SalesLine.TESTFIELD("Quantity Invoiced",0);
                                                                      SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                      IF NOT RecalculatePrice THEN BEGIN
                                                                        SalesLine."VAT Difference" := 0;
                                                                        SalesLine.InitOutstandingAmount;
                                                                      END ELSE
                                                                        IF "Prices Including VAT" THEN BEGIN
                                                                          SalesLine."Unit Price" :=
                                                                            ROUND(
                                                                              SalesLine."Unit Price" * (1 + (SalesLine."VAT %" / 100)),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF SalesLine.Quantity <> 0 THEN BEGIN
                                                                            SalesLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                SalesLine.Quantity * SalesLine."Unit Price" * SalesLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            SalesLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                SalesLine."Inv. Discount Amount" * (1 + (SalesLine."VAT %" / 100)),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END ELSE BEGIN
                                                                          SalesLine."Unit Price" :=
                                                                            ROUND(
                                                                              SalesLine."Unit Price" / (1 + (SalesLine."VAT %" / 100)),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF SalesLine.Quantity <> 0 THEN BEGIN
                                                                            SalesLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                SalesLine.Quantity * SalesLine."Unit Price" * SalesLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            SalesLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                SalesLine."Inv. Discount Amount" / (1 + (SalesLine."VAT %" / 100)),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END;
                                                                      SalesLine.MODIFY;
                                                                    UNTIL SalesLine.NEXT = 0;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[DAN=Priser inkl. moms;
                                                              ENU=Prices Including VAT] }
    { 37  ;   ;Invoice Disc. Code  ;Code20        ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Invoice Disc. Code"));
                                                              END;

                                                   AccessByPermission=TableData 19=R;
                                                   CaptionML=[DAN=Fakturarabatkode;
                                                              ENU=Invoice Disc. Code] }
    { 40  ;   ;Customer Disc. Group;Code20        ;TableRelation="Customer Discount Group";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Customer Disc. Group"));
                                                              END;

                                                   CaptionML=[DAN=Debitorrabatgruppe;
                                                              ENU=Customer Disc. Group] }
    { 41  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   OnValidate=BEGIN
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Language Code"));
                                                              END;

                                                   CaptionML=[DAN=Sprogkode;
                                                              ENU=Language Code] }
    { 43  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=VAR
                                                                ApprovalEntry@1001 : Record 454;
                                                              BEGIN
                                                                ApprovalEntry.SETRANGE("Table ID",DATABASE::"Sales Header");
                                                                ApprovalEntry.SETRANGE("Document Type","Document Type");
                                                                ApprovalEntry.SETRANGE("Document No.","No.");
                                                                ApprovalEntry.SETFILTER(Status,'<>%1&<>%2',ApprovalEntry.Status::Canceled,ApprovalEntry.Status::Rejected);
                                                                IF NOT ApprovalEntry.ISEMPTY THEN
                                                                  ERROR(Text053,FIELDCAPTION("Salesperson Code"));

                                                                CreateDim(
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");

                                                                //>>SYS
                                                                IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                  IF "Salesperson Code" <> '' THEN BEGIN
                                                                    CLEAR(UserSetup2);
                                                                    UserSetup2.SETRANGE("Salespers./Purch. Code","Salesperson Code");
                                                                    IF UserSetup2.FINDFIRST THEN BEGIN
                                                                      IF NOT MySalesOrders.GET(UserSetup2."User ID","No.") THEN BEGIN
                                                                        MySalesOrders."User ID" := UserSetup2."User ID";
                                                                        MySalesOrders."Order No." := "No.";
                                                                        MySalesOrders.INSERT;
                                                                      END;
                                                                    END;
                                                                  END
                                                                  ELSE BEGIN
                                                                    CLEAR(UserSetup2);
                                                                    UserSetup2.SETRANGE("Salespers./Purch. Code",xRec."Salesperson Code");
                                                                    IF MySalesOrders.GET(UserSetup2."User ID","No.") THEN
                                                                      MySalesOrders.DELETE;
                                                                  END;
                                                                END;
                                                                //<<SYS
                                                              END;

                                                   CaptionML=[DAN=Entrepriseleder;
                                                              ENU=Salesperson Code] }
    { 45  ;   ;Order Class         ;Code10        ;CaptionML=[DAN=Ordregruppe;
                                                              ENU=Order Class] }
    { 46  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Comment Line" WHERE (Document Type=FIELD(Document Type),
                                                                                                 No.=FIELD(No.),
                                                                                                 Document Line No.=CONST(0)));
                                                   CaptionML=[DAN=Bem‘rkning;
                                                              ENU=Comment];
                                                   Editable=No }
    { 47  ;   ;No. Printed         ;Integer       ;CaptionML=[DAN=Udskrevet;
                                                              ENU=No. Printed];
                                                   Editable=No }
    { 51  ;   ;On Hold             ;Code3         ;CaptionML=[DAN=Afvent;
                                                              ENU=On Hold] }
    { 52  ;   ;Applies-to Doc. Type;Option        ;CaptionML=[DAN=Udligningsbilagstype;
                                                              ENU=Applies-to Doc. Type];
                                                   OptionCaptionML=[DAN=" ,Betaling,Faktura,Kreditnota,Rentenota,Rykker,Refusion";
                                                                    ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 53  ;   ;Applies-to Doc. No. ;Code20        ;OnValidate=BEGIN
                                                                IF "Applies-to Doc. No." <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');

                                                                IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." <> '') AND
                                                                   ("Applies-to Doc. No." <> '')
                                                                THEN BEGIN
                                                                  SetAmountToApply("Applies-to Doc. No.","Bill-to Customer No.");
                                                                  SetAmountToApply(xRec."Applies-to Doc. No.","Bill-to Customer No.");
                                                                END ELSE
                                                                  IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." = '') THEN
                                                                    SetAmountToApply("Applies-to Doc. No.","Bill-to Customer No.")
                                                                  ELSE
                                                                    IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND ("Applies-to Doc. No." = '') THEN
                                                                      SetAmountToApply(xRec."Applies-to Doc. No.","Bill-to Customer No.");
                                                              END;

                                                   OnLookup=BEGIN
                                                              TESTFIELD("Bal. Account No.",'');
                                                              CustLedgEntry.SETCURRENTKEY("Customer No.",Open,Positive,"Due Date");
                                                              CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                                                              CustLedgEntry.SETRANGE(Open,TRUE);
                                                              IF "Applies-to Doc. No." <> '' THEN BEGIN
                                                                CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                                                IF CustLedgEntry.FINDFIRST THEN;
                                                                CustLedgEntry.SETRANGE("Document Type");
                                                                CustLedgEntry.SETRANGE("Document No.");
                                                              END ELSE
                                                                IF "Applies-to Doc. Type" <> 0 THEN BEGIN
                                                                  CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                  IF CustLedgEntry.FINDFIRST THEN;
                                                                  CustLedgEntry.SETRANGE("Document Type");
                                                                END ELSE
                                                                  IF Amount <> 0 THEN BEGIN
                                                                    CustLedgEntry.SETRANGE(Positive,Amount < 0);
                                                                    IF CustLedgEntry.FINDFIRST THEN;
                                                                    CustLedgEntry.SETRANGE(Positive);
                                                                  END;

                                                              ApplyCustEntries.SetSales(Rec,CustLedgEntry,SalesHeader.FIELDNO("Applies-to Doc. No."));
                                                              ApplyCustEntries.SETTABLEVIEW(CustLedgEntry);
                                                              ApplyCustEntries.SETRECORD(CustLedgEntry);
                                                              ApplyCustEntries.LOOKUPMODE(TRUE);
                                                              IF ApplyCustEntries.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ApplyCustEntries.GetCustLedgEntry(CustLedgEntry);
                                                                GenJnlApply.CheckAgainstApplnCurrency(
                                                                  "Currency Code",CustLedgEntry."Currency Code",GenJnILine."Account Type"::Customer,TRUE);
                                                                "Applies-to Doc. Type" := CustLedgEntry."Document Type";
                                                                "Applies-to Doc. No." := CustLedgEntry."Document No.";
                                                              END;
                                                              CLEAR(ApplyCustEntries);
                                                            END;

                                                   CaptionML=[DAN=Udligningsbilagsnr.;
                                                              ENU=Applies-to Doc. No.] }
    { 55  ;   ;Bal. Account No.    ;Code20        ;TableRelation=IF (Bal. Account Type=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Bal. Account Type=CONST(Bank Account)) "Bank Account";
                                                   OnValidate=BEGIN
                                                                IF "Bal. Account No." <> '' THEN
                                                                  CASE "Bal. Account Type" OF
                                                                    "Bal. Account Type"::"G/L Account":
                                                                      BEGIN
                                                                        GLAcc.GET("Bal. Account No.");
                                                                        GLAcc.CheckGLAcc;
                                                                        GLAcc.TESTFIELD("Direct Posting",TRUE);
                                                                      END;
                                                                    "Bal. Account Type"::"Bank Account":
                                                                      BEGIN
                                                                        BankAcc.GET("Bal. Account No.");
                                                                        BankAcc.TESTFIELD(Blocked,FALSE);
                                                                        BankAcc.TESTFIELD("Currency Code","Currency Code");
                                                                      END;
                                                                  END;
                                                              END;

                                                   CaptionML=[DAN=Modkonto;
                                                              ENU=Bal. Account No.] }
    { 56  ;   ;Recalculate Invoice Disc.;Boolean  ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Document No.=FIELD(No.),
                                                                                         Recalculate Invoice Disc.=CONST(Yes)));
                                                   CaptionML=[DAN=Genberegn fakturarabat;
                                                              ENU=Recalculate Invoice Disc.];
                                                   Editable=No }
    { 57  ;   ;Ship                ;Boolean       ;CaptionML=[DAN=Lever;
                                                              ENU=Ship];
                                                   Editable=No }
    { 58  ;   ;Invoice             ;Boolean       ;CaptionML=[DAN=Fakturer;
                                                              ENU=Invoice] }
    { 59  ;   ;Print Posted Documents;Boolean     ;CaptionML=[DAN=Udskriv bogf›rte dokumenter;
                                                              ENU=Print Posted Documents] }
    { 60  ;   ;Amount              ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line".Amount WHERE (Document Type=FIELD(Document Type),
                                                                                              Document No.=FIELD(No.)));
                                                   CaptionML=[DAN=Bel›b;
                                                              ENU=Amount];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Amount Including VAT;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Amount Including VAT" WHERE (Document Type=FIELD(Document Type),
                                                                                                              Document No.=FIELD(No.)));
                                                   CaptionML=[DAN=Bel›b inkl. moms;
                                                              ENU=Amount Including VAT];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 62  ;   ;Shipping No.        ;Code20        ;CaptionML=[DAN=Tildelt salgslev.nr.;
                                                              ENU=Shipping No.] }
    { 63  ;   ;Posting No.         ;Code20        ;CaptionML=[DAN=Tildelt fakturanr.;
                                                              ENU=Posting No.] }
    { 64  ;   ;Last Shipping No.   ;Code20        ;TableRelation="Sales Shipment Header";
                                                   CaptionML=[DAN=Sidste salgslev.nr.;
                                                              ENU=Last Shipping No.];
                                                   Editable=No }
    { 65  ;   ;Last Posting No.    ;Code20        ;TableRelation="Sales Invoice Header";
                                                   CaptionML=[DAN=Sidste fakturanr.;
                                                              ENU=Last Posting No.];
                                                   Editable=No }
    { 66  ;   ;Prepayment No.      ;Code20        ;CaptionML=[DAN=Forudbetalingsnr.;
                                                              ENU=Prepayment No.] }
    { 67  ;   ;Last Prepayment No. ;Code20        ;TableRelation="Sales Invoice Header";
                                                   CaptionML=[DAN=Sidste forudbetalingsnr.;
                                                              ENU=Last Prepayment No.] }
    { 68  ;   ;Prepmt. Cr. Memo No.;Code20        ;CaptionML=[DAN=Forudbetalingskreditnota nr.;
                                                              ENU=Prepmt. Cr. Memo No.] }
    { 69  ;   ;Last Prepmt. Cr. Memo No.;Code20   ;TableRelation="Sales Cr.Memo Header";
                                                   CaptionML=[DAN=Sidste forudbetalingskreditnota nr.;
                                                              ENU=Last Prepmt. Cr. Memo No.] }
    { 70  ;   ;VAT Registration No.;Text20        ;CaptionML=[DAN=SE/CVR-nr.;
                                                              DEU=Umsatzsteuer-ID-Nr./Steuernr.;
                                                              ENU=VAT Registration No.] }
    { 71  ;   ;Combine Shipments   ;Boolean       ;CaptionML=[DAN=Tillad samlefaktura;
                                                              ENU=Combine Shipments] }
    { 73  ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=[DAN=rsagskode;
                                                              ENU=Reason Code] }
    { 74  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN BEGIN
                                                                    "VAT Bus. Posting Group" := GenBusPostingGrp."Def. VAT Bus. Posting Group";
                                                                    RecreateSalesLines(FIELDCAPTION("Gen. Bus. Posting Group"));
                                                                  END;
                                                              END;

                                                   CaptionML=[DAN=Virksomhedsbogf›ringsgruppe;
                                                              ENU=Gen. Bus. Posting Group] }
    { 75  ;   ;EU 3-Party Trade    ;Boolean       ;CaptionML=[DAN=Trekantshandel;
                                                              ENU=EU 3-Party Trade] }
    { 76  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION("Transaction Type"),FALSE);
                                                              END;

                                                   CaptionML=[DAN=Transaktionsart;
                                                              ENU=Transaction Type] }
    { 77  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION("Transport Method"),FALSE);
                                                              END;

                                                   CaptionML=[DAN=Transportm†de;
                                                              ENU=Transport Method] }
    { 78  ;   ;VAT Country/Region Code;Code10     ;TableRelation=Country/Region;
                                                   CaptionML=[DAN=Lande-/omr†dekode for moms;
                                                              ENU=VAT Country/Region Code] }
    { 79  ;   ;Sell-to Customer Name;Text50       ;CaptionML=[DAN=Kundenavn;
                                                              ENU=Sell-to Customer Name] }
    { 80  ;   ;Sell-to Customer Name 2;Text50     ;CaptionML=[DAN=Kundenavn 2;
                                                              ENU=Sell-to Customer Name 2] }
    { 81  ;   ;Sell-to Address     ;Text50        ;CaptionML=[DAN=Kundeadresse;
                                                              ENU=Sell-to Address] }
    { 82  ;   ;Sell-to Address 2   ;Text50        ;CaptionML=[DAN=Kundeadresse 2;
                                                              ENU=Sell-to Address 2] }
    { 83  ;   ;Sell-to City        ;Text30        ;TableRelation="Post Code".City;
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Sell-to City","Sell-to Post Code","Sell-to County","Sell-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DAN=Kundeby;
                                                              ENU=Sell-to City] }
    { 84  ;   ;Sell-to Contact     ;Text50        ;CaptionML=[DAN=Kundeattention;
                                                              ENU=Sell-to Contact] }
    { 85  ;   ;Bill-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DAN=Faktureringspostnr.;
                                                              ENU=Bill-to Post Code] }
    { 86  ;   ;Bill-to County      ;Text30        ;CaptionML=[DAN=Faktureringsamt;
                                                              ENU=Bill-to County] }
    { 87  ;   ;Bill-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[DAN=Lande-/omr†dekode til fakturering;
                                                              ENU=Bill-to Country/Region Code] }
    { 88  ;   ;Sell-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Sell-to City","Sell-to Post Code","Sell-to County","Sell-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DAN=Kundepostnr.;
                                                              ENU=Sell-to Post Code] }
    { 89  ;   ;Sell-to County      ;Text30        ;CaptionML=[DAN=Kundeamt;
                                                              ENU=Sell-to County] }
    { 90  ;   ;Sell-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[DAN=Lande-/omr†dekode for kunde;
                                                              ENU=Sell-to Country/Region Code] }
    { 91  ;   ;Ship-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DAN=Leveringspostnr.;
                                                              ENU=Ship-to Post Code] }
    { 92  ;   ;Ship-to County      ;Text30        ;CaptionML=[DAN=Leveringsamt;
                                                              ENU=Ship-to County] }
    { 93  ;   ;Ship-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[DAN=Lande-/omr†dekode for levering;
                                                              ENU=Ship-to Country/Region Code] }
    { 94  ;   ;Bal. Account Type   ;Option        ;CaptionML=[DAN=Modkontotype;
                                                              ENU=Bal. Account Type];
                                                   OptionCaptionML=[DAN=Finanskonto,Bankkonto;
                                                                    ENU=G/L Account,Bank Account];
                                                   OptionString=G/L Account,Bank Account }
    { 97  ;   ;Exit Point          ;Code10        ;TableRelation="Entry/Exit Point";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION("Exit Point"),FALSE);
                                                              END;

                                                   CaptionML=[DAN=Udf›rselssted;
                                                              ENU=Exit Point] }
    { 98  ;   ;Correction          ;Boolean       ;CaptionML=[DAN=Rettelse;
                                                              ENU=Correction] }
    { 99  ;   ;Document Date       ;Date          ;OnValidate=BEGIN
                                                                IF xRec."Document Date" <> "Document Date" THEN
                                                                  UpdateDocumentDate := TRUE;
                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Prepmt. Payment Terms Code");
                                                              END;

                                                   CaptionML=[DAN=Bilagsdato;
                                                              ENU=Document Date] }
    { 100 ;   ;External Document No.;Code35       ;CaptionML=[DAN=Eksternt bilagsnr.;
                                                              ENU=External Document No.] }
    { 101 ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION(Area),FALSE);
                                                              END;

                                                   CaptionML=[DAN=Omr†de;
                                                              ENU=Area] }
    { 102 ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION("Transaction Specification"),FALSE);
                                                              END;

                                                   CaptionML=[DAN=Transaktionsspecifikation;
                                                              ENU=Transaction Specification] }
    { 104 ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   OnValidate=VAR
                                                                SEPADirectDebitMandate@1000 : Record 1230;
                                                                DOPaymentTransLogEntry@1001 : Record 829;
                                                              BEGIN
                                                                IF DOPaymentTransLogEntry.FINDFIRST THEN
                                                                  DOPaymentTransLogMgt.ValidateHasNoValidTransactions("Document Type",FORMAT("Document Type"),"No.");
                                                                IF DOPaymentMgt.IsValidPaymentMethod(xRec."Payment Method Code") AND NOT DOPaymentMgt.IsValidPaymentMethod("Payment Method Code")
                                                                THEN
                                                                  TESTFIELD("Credit Card No.",'');
                                                                PaymentMethod.INIT;
                                                                IF "Payment Method Code" <> '' THEN
                                                                  PaymentMethod.GET("Payment Method Code");
                                                                IF PaymentMethod."Direct Debit" THEN BEGIN
                                                                  IF "Direct Debit Mandate ID" = '' THEN
                                                                    "Direct Debit Mandate ID" := SEPADirectDebitMandate.GetDefaultMandate("Bill-to Customer No.","Due Date");
                                                                  IF "Payment Terms Code" = '' THEN
                                                                    "Payment Terms Code" := PaymentMethod."Direct Debit Pmt. Terms Code";
                                                                END;
                                                                "Bal. Account Type" := PaymentMethod."Bal. Account Type";
                                                                "Bal. Account No." := PaymentMethod."Bal. Account No.";
                                                                IF "Bal. Account No." <> '' THEN BEGIN
                                                                  TESTFIELD("Applies-to Doc. No.",'');
                                                                  TESTFIELD("Applies-to ID",'');
                                                                END;
                                                                "Payment Channel" := PaymentMethod."Payment Channel";
                                                              END;

                                                   CaptionML=[DAN=Betalingsformskode;
                                                              ENU=Payment Method Code] }
    { 105 ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF xRec."Shipping Agent Code" = "Shipping Agent Code" THEN
                                                                  EXIT;

                                                                "Shipping Agent Service Code" := '';
                                                                GetShippingTime(FIELDNO("Shipping Agent Code"));
                                                                UpdateSalesLines(FIELDCAPTION("Shipping Agent Code"),CurrFieldNo <> 0);

                                                                //>>SYS
                                                                IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                  WarehouseActivityHeader.SETCURRENTKEY("Ordrenr.");
                                                                  WarehouseActivityHeader.SETRANGE("Ordrenr.","No.");
                                                                  IF WarehouseActivityHeader.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                    REPEAT
                                                                      WarehouseActivityHeader."Shipping Agent Code" := "Shipping Agent Code";
                                                                      IF ShippingAgent.GET("Shipping Agent Code") THEN
                                                                        WarehouseActivityHeader."Shipping Agent Name" := ShippingAgent.Name;
                                                                      WarehouseActivityHeader.MODIFY;
                                                                    UNTIL WarehouseActivityHeader.NEXT = 0;
                                                                  END;
                                                                END;
                                                                //<<SYS
                                                              END;

                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[DAN=Spedit›rkode;
                                                              ENU=Shipping Agent Code] }
    { 106 ;   ;Package Tracking No.;Text30        ;CaptionML=[DAN=Pakkesporingsnr.;
                                                              ENU=Package Tracking No.] }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[DAN=Nummerserie;
                                                              ENU=No. Series];
                                                   Editable=No }
    { 108 ;   ;Posting No. Series  ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Posting No. Series" <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  TestNoSeries;
                                                                  NoSeriesMgt.TestSeries(GetPostingNoSeriesCode,"Posting No. Series");
                                                                END;
                                                                TESTFIELD("Posting No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                TestNoSeries;
                                                                IF NoSeriesMgt.LookupSeries(GetPostingNoSeriesCode,"Posting No. Series") THEN
                                                                  VALIDATE("Posting No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[DAN=Bogf›ringsnummerserie;
                                                              ENU=Posting No. Series] }
    { 109 ;   ;Shipping No. Series ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Shipping No. Series" <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  SalesSetup.TESTFIELD("Posted Shipment Nos.");
                                                                  NoSeriesMgt.TestSeries(SalesSetup."Posted Shipment Nos.","Shipping No. Series");
                                                                END;
                                                                TESTFIELD("Shipping No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                SalesSetup.TESTFIELD("Posted Shipment Nos.");
                                                                IF NoSeriesMgt.LookupSeries(SalesSetup."Posted Shipment Nos.","Shipping No. Series") THEN
                                                                  VALIDATE("Shipping No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[DAN=Leverancenummerserie;
                                                              ENU=Shipping No. Series] }
    { 114 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Tax Area Code"));
                                                              END;

                                                   CaptionML=[DAN=Skatteomr†dekode;
                                                              ENU=Tax Area Code] }
    { 115 ;   ;Tax Liable          ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Tax Liable"));
                                                              END;

                                                   CaptionML=[DAN=Skattepligtig;
                                                              ENU=Tax Liable] }
    { 116 ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF xRec."VAT Bus. Posting Group" <> "VAT Bus. Posting Group" THEN
                                                                  RecreateSalesLines(FIELDCAPTION("VAT Bus. Posting Group"));
                                                              END;

                                                   CaptionML=[DAN=Momsvirksomhedsbogf.gruppe;
                                                              ENU=VAT Bus. Posting Group] }
    { 117 ;   ;Reserve             ;Option        ;AccessByPermission=TableData 27=R;
                                                   CaptionML=[DAN=Reserver;
                                                              ENU=Reserve];
                                                   OptionCaptionML=[DAN=Aldrig,Eventuelt,Altid;
                                                                    ENU=Never,Optional,Always];
                                                   OptionString=Never,Optional,Always }
    { 118 ;   ;Applies-to ID       ;Code50        ;OnValidate=VAR
                                                                TempCustLedgEntry@1000 : Record 21;
                                                              BEGIN
                                                                IF "Applies-to ID" <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');
                                                                IF ("Applies-to ID" <> xRec."Applies-to ID") AND (xRec."Applies-to ID" <> '') THEN BEGIN
                                                                  CustLedgEntry.SETCURRENTKEY("Customer No.",Open);
                                                                  CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                                                                  CustLedgEntry.SETRANGE(Open,TRUE);
                                                                  CustLedgEntry.SETRANGE("Applies-to ID",xRec."Applies-to ID");
                                                                  IF CustLedgEntry.FINDFIRST THEN
                                                                    CustEntrySetApplID.SetApplId(CustLedgEntry,TempCustLedgEntry,'');
                                                                  CustLedgEntry.RESET;
                                                                END;
                                                              END;

                                                   CaptionML=[DAN=Udlignings-id;
                                                              ENU=Applies-to ID] }
    { 119 ;   ;VAT Base Discount % ;Decimal       ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                GLSetup.GET;
                                                                IF "VAT Base Discount %" > GLSetup."VAT Tolerance %" THEN
                                                                  ERROR(
                                                                    Text007,
                                                                    FIELDCAPTION("VAT Base Discount %"),
                                                                    GLSetup.FIELDCAPTION("VAT Tolerance %"),
                                                                    GLSetup.TABLECAPTION);

                                                                IF ("VAT Base Discount %" = xRec."VAT Base Discount %") AND
                                                                   (CurrFieldNo <> 0)
                                                                THEN
                                                                  EXIT;

                                                                SalesLine.SETRANGE("Document Type","Document Type");
                                                                SalesLine.SETRANGE("Document No.","No.");
                                                                SalesLine.SETFILTER(Type,'<>%1',SalesLine.Type::" ");
                                                                SalesLine.SETFILTER(Quantity,'<>0');
                                                                SalesLine.LOCKTABLE;
                                                                LOCKTABLE;
                                                                IF SalesLine.FINDSET THEN BEGIN
                                                                  MODIFY;
                                                                  REPEAT
                                                                    IF (SalesLine."Quantity Invoiced" <> SalesLine.Quantity) OR
                                                                       ("Shipping Advice" <> "Shipping Advice"::Partial) OR
                                                                       (SalesLine.Type <> SalesLine.Type::"Charge (Item)") OR
                                                                       (CurrFieldNo <> 0)
                                                                    THEN BEGIN
                                                                      SalesLine.UpdateAmounts;
                                                                      SalesLine.MODIFY;
                                                                    END;
                                                                  UNTIL SalesLine.NEXT = 0;
                                                                END;
                                                                SalesLine.RESET;
                                                              END;

                                                   CaptionML=[DAN=Momsgrundlagsrabat %;
                                                              ENU=VAT Base Discount %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 120 ;   ;Status              ;Option        ;CaptionML=[DAN=Status;
                                                              ENU=Status];
                                                   OptionCaptionML=[DAN=ben,Frigivet,Afventer godkendelse,Afventer forudbetaling;
                                                                    ENU=Open,Released,Pending Approval,Pending Prepayment];
                                                   OptionString=Open,Released,Pending Approval,Pending Prepayment;
                                                   Editable=No }
    { 121 ;   ;Invoice Discount Calculation;Option;CaptionML=[DAN=Beregning af fakturarabat;
                                                              ENU=Invoice Discount Calculation];
                                                   OptionCaptionML=[DAN=Ingen,%,Bel›b;
                                                                    ENU=None,%,Amount];
                                                   OptionString=None,%,Amount;
                                                   Editable=No }
    { 122 ;   ;Invoice Discount Value;Decimal     ;CaptionML=[DAN=Fakturarabatv‘rdi;
                                                              ENU=Invoice Discount Value];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 123 ;   ;Send IC Document    ;Boolean       ;OnValidate=BEGIN
                                                                IF "Send IC Document" THEN BEGIN
                                                                  IF "Bill-to IC Partner Code" = '' THEN
                                                                    TESTFIELD("Sell-to IC Partner Code");
                                                                  TESTFIELD("IC Direction","IC Direction"::Outgoing);
                                                                END;
                                                              END;

                                                   CaptionML=[DAN=Send IC-dokument;
                                                              ENU=Send IC Document] }
    { 124 ;   ;IC Status           ;Option        ;CaptionML=[DAN=IC-status;
                                                              ENU=IC Status];
                                                   OptionCaptionML=[DAN=Ny,Ventende,Sendt;
                                                                    ENU=New,Pending,Sent];
                                                   OptionString=New,Pending,Sent }
    { 125 ;   ;Sell-to IC Partner Code;Code20     ;TableRelation="IC Partner";
                                                   CaptionML=[DAN=Kundes kode for IC-partner;
                                                              ENU=Sell-to IC Partner Code];
                                                   Editable=No }
    { 126 ;   ;Bill-to IC Partner Code;Code20     ;TableRelation="IC Partner";
                                                   CaptionML=[DAN=Fakt.kode for IC-partner;
                                                              ENU=Bill-to IC Partner Code];
                                                   Editable=No }
    { 129 ;   ;IC Direction        ;Option        ;OnValidate=BEGIN
                                                                IF "IC Direction" = "IC Direction"::Incoming THEN
                                                                  "Send IC Document" := FALSE;
                                                              END;

                                                   CaptionML=[DAN=IC-retning;
                                                              ENU=IC Direction];
                                                   OptionCaptionML=[DAN=Udg†ende,Indg†ende;
                                                                    ENU=Outgoing,Incoming];
                                                   OptionString=Outgoing,Incoming }
    { 130 ;   ;Prepayment %        ;Decimal       ;OnValidate=BEGIN
                                                                IF xRec."Prepayment %" <> "Prepayment %" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Prepayment %"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DAN=Forudbetaling i %;
                                                              ENU=Prepayment %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 131 ;   ;Prepayment No. Series;Code10       ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Prepayment No. Series" <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  SalesSetup.TESTFIELD("Posted Prepmt. Inv. Nos.");
                                                                  NoSeriesMgt.TestSeries(GetPostingPrepaymentNoSeriesCode,"Prepayment No. Series");
                                                                END;
                                                                TESTFIELD("Prepayment No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                SalesSetup.TESTFIELD("Posted Prepmt. Inv. Nos.");
                                                                IF NoSeriesMgt.LookupSeries(GetPostingPrepaymentNoSeriesCode,"Prepayment No. Series") THEN
                                                                  VALIDATE("Prepayment No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[DAN=Forudbetalingsnummerserie;
                                                              ENU=Prepayment No. Series] }
    { 132 ;   ;Compress Prepayment ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[DAN=Komprimer forudbetaling;
                                                              ENU=Compress Prepayment] }
    { 133 ;   ;Prepayment Due Date ;Date          ;CaptionML=[DAN=Forfaldsdato for forudbetaling;
                                                              ENU=Prepayment Due Date] }
    { 134 ;   ;Prepmt. Cr. Memo No. Series;Code10 ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Prepmt. Cr. Memo No." <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  SalesSetup.TESTFIELD("Posted Prepmt. Cr. Memo Nos.");
                                                                  NoSeriesMgt.TestSeries(GetPostingPrepaymentNoSeriesCode,"Prepmt. Cr. Memo No. Series");
                                                                END;
                                                                TESTFIELD("Prepmt. Cr. Memo No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                SalesSetup.TESTFIELD("Posted Prepmt. Cr. Memo Nos.");
                                                                IF NoSeriesMgt.LookupSeries(GetPostingPrepaymentNoSeriesCode,"Prepmt. Cr. Memo No. Series") THEN
                                                                  VALIDATE("Prepmt. Cr. Memo No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[DAN=Nummerserie til forudbetalingskreditnota;
                                                              ENU=Prepmt. Cr. Memo No. Series] }
    { 135 ;   ;Prepmt. Posting Description;Text50 ;CaptionML=[DAN=Beskrivelse af bogf›rt forudbetaling;
                                                              ENU=Prepmt. Posting Description] }
    { 138 ;   ;Prepmt. Pmt. Discount Date;Date    ;CaptionML=[DAN=Forudb. - dato for kont.rabat;
                                                              ENU=Prepmt. Pmt. Discount Date] }
    { 139 ;   ;Prepmt. Payment Terms Code;Code10  ;TableRelation="Payment Terms";
                                                   OnValidate=VAR
                                                                PaymentTerms@1000 : Record 3;
                                                              BEGIN
                                                                IF ("Prepmt. Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Prepmt. Payment Terms Code");
                                                                  IF (("Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"]) AND
                                                                      NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos")
                                                                  THEN BEGIN
                                                                    VALIDATE("Prepayment Due Date","Document Date");
                                                                    VALIDATE("Prepmt. Pmt. Discount Date",0D);
                                                                    VALIDATE("Prepmt. Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                    "Prepayment Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    "Prepmt. Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    IF NOT UpdateDocumentDate THEN
                                                                      VALIDATE("Prepmt. Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Prepayment Due Date","Document Date");
                                                                  IF NOT UpdateDocumentDate THEN BEGIN
                                                                    VALIDATE("Prepmt. Pmt. Discount Date",0D);
                                                                    VALIDATE("Prepmt. Payment Discount %",0);
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[DAN=Forudb. - kode for betal.betingelser;
                                                              ENU=Prepmt. Payment Terms Code] }
    { 140 ;   ;Prepmt. Payment Discount %;Decimal ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[DAN=Forudb. - kontantrabat i %;
                                                              ENU=Prepmt. Payment Discount %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 151 ;   ;Quote No.           ;Code20        ;CaptionML=[DAN=Tilbudsnr.;
                                                              ENU=Quote No.];
                                                   Editable=No }
    { 160 ;   ;Job Queue Status    ;Option        ;OnLookup=VAR
                                                              JobQueueEntry@1000 : Record 472;
                                                            BEGIN
                                                              IF "Job Queue Status" = "Job Queue Status"::" " THEN
                                                                EXIT;
                                                              JobQueueEntry.ShowStatusMsg("Job Queue Entry ID");
                                                            END;

                                                   CaptionML=[DAN=Opgavek›status;
                                                              ENU=Job Queue Status];
                                                   OptionCaptionML=[DAN=" ,Planlagt til bogf›ring,Fejl,Bogf›ring";
                                                                    ENU=" ,Scheduled for Posting,Error,Posting"];
                                                   OptionString=[ ,Scheduled for Posting,Error,Posting];
                                                   Editable=No }
    { 161 ;   ;Job Queue Entry ID  ;GUID          ;CaptionML=[DAN=Opgavek›post-id;
                                                              ENU=Job Queue Entry ID];
                                                   Editable=No }
    { 165 ;   ;Incoming Document Entry No.;Integer;TableRelation="Incoming Document" WHERE (Status=FILTER(New|Approved));
                                                   OnValidate=VAR
                                                                IncomingDocument@1000 : Record 130;
                                                              BEGIN
                                                                IncomingDocument.SetSalesDoc(Rec);
                                                              END;

                                                   CaptionML=[DAN=L›benummer for indg†ende dokumenter;
                                                              ENU=Incoming Document Entry No.] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDocDim;
                                                            END;

                                                   CaptionML=[DAN=Dimensionsgruppe-id;
                                                              ENU=Dimension Set ID];
                                                   Editable=No }
    { 825 ;   ;Authorization Required;Boolean     ;CaptionML=[DAN=Godkendelse er p†kr‘vet;
                                                              ENU=Authorization Required] }
    { 827 ;   ;Credit Card No.     ;Code20        ;TableRelation="DO Payment Credit Card" WHERE (Customer No.=FIELD(Bill-to Customer No.));
                                                   OnValidate=VAR
                                                                DOPaymentTransLogEntry@1000 : Record 829;
                                                              BEGIN
                                                                IF NOT DOPaymentTransLogEntry.ISEMPTY THEN
                                                                  DOPaymentTransLogMgt.ValidateHasNoValidTransactions("Document Type",FORMAT("Document Type"),"No.");

                                                                IF "Credit Card No." = '' THEN
                                                                  EXIT;

                                                                DOPaymentMgt.CheckCreditCardData("Credit Card No.");

                                                                IF NOT DOPaymentMgt.IsValidPaymentMethod("Payment Method Code") THEN
                                                                  FIELDERROR("Payment Method Code");
                                                              END;

                                                   CaptionML=[DAN=Kreditkortnr.;
                                                              ENU=Credit Card No.] }
    { 1200;   ;Direct Debit Mandate ID;Code35     ;TableRelation="SEPA Direct Debit Mandate" WHERE (Customer No.=FIELD(Bill-to Customer No.),
                                                                                                    Closed=CONST(No),
                                                                                                    Blocked=CONST(No));
                                                   CaptionML=[DAN=Id for Direct Debit-betalingsaftale;
                                                              ENU=Direct Debit Mandate ID] }
    { 1305;   ;Invoice Discount Amount;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Inv. Discount Amount" WHERE (Document No.=FIELD(No.),
                                                                                                              Document Type=FIELD(Document Type)));
                                                   CaptionML=[DAN=Fakturarabatbel›b;
                                                              ENU=Invoice Discount Amount];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5043;   ;No. of Archived Versions;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Max("Sales Header Archive"."Version No." WHERE (Document Type=FIELD(Document Type),
                                                                                                               No.=FIELD(No.),
                                                                                                               Doc. No. Occurrence=FIELD(Doc. No. Occurrence)));
                                                   CaptionML=[DAN=Antal arkiverede versioner;
                                                              ENU=No. of Archived Versions];
                                                   Editable=No }
    { 5048;   ;Doc. No. Occurrence ;Integer       ;CaptionML=[DAN=Forekomster af dok.nr.;
                                                              ENU=Doc. No. Occurrence] }
    { 5050;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   OnValidate=BEGIN
                                                                CreateDim(
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");
                                                              END;

                                                   CaptionML=[DAN=Kampagnenr.;
                                                              ENU=Campaign No.] }
    { 5051;   ;Sell-to Customer Template Code;Code10;
                                                   TableRelation="Customer Template";
                                                   OnValidate=VAR
                                                                SellToCustTemplate@1000 : Record 5105;
                                                              BEGIN
                                                                TESTFIELD("Document Type","Document Type"::Quote);
                                                                TESTFIELD(Status,Status::Open);

                                                                IF NOT InsertMode AND
                                                                   ("Sell-to Customer Template Code" <> xRec."Sell-to Customer Template Code") AND
                                                                   (xRec."Sell-to Customer Template Code" <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Sell-to Customer Template Code"));
                                                                  IF Confirmed THEN BEGIN
                                                                    SalesLine.RESET;
                                                                    SalesLine.SETRANGE("Document Type","Document Type");
                                                                    SalesLine.SETRANGE("Document No.","No.");
                                                                    IF "Sell-to Customer Template Code" = '' THEN BEGIN
                                                                      IF NOT SalesLine.ISEMPTY THEN
                                                                        ERROR(Text005,FIELDCAPTION("Sell-to Customer Template Code"));
                                                                      INIT;
                                                                      SalesSetup.GET;
                                                                      InitRecord;
                                                                      "No. Series" := xRec."No. Series";
                                                                      IF xRec."Shipping No." <> '' THEN BEGIN
                                                                        "Shipping No. Series" := xRec."Shipping No. Series";
                                                                        "Shipping No." := xRec."Shipping No.";
                                                                      END;
                                                                      IF xRec."Posting No." <> '' THEN BEGIN
                                                                        "Posting No. Series" := xRec."Posting No. Series";
                                                                        "Posting No." := xRec."Posting No.";
                                                                      END;
                                                                      IF xRec."Return Receipt No." <> '' THEN BEGIN
                                                                        "Return Receipt No. Series" := xRec."Return Receipt No. Series";
                                                                        "Return Receipt No." := xRec."Return Receipt No.";
                                                                      END;
                                                                      IF xRec."Prepayment No." <> '' THEN BEGIN
                                                                        "Prepayment No. Series" := xRec."Prepayment No. Series";
                                                                        "Prepayment No." := xRec."Prepayment No.";
                                                                      END;
                                                                      IF xRec."Prepmt. Cr. Memo No." <> '' THEN BEGIN
                                                                        "Prepmt. Cr. Memo No. Series" := xRec."Prepmt. Cr. Memo No. Series";
                                                                        "Prepmt. Cr. Memo No." := xRec."Prepmt. Cr. Memo No.";
                                                                      END;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    "Sell-to Customer Template Code" := xRec."Sell-to Customer Template Code";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF SellToCustTemplate.GET("Sell-to Customer Template Code") THEN BEGIN
                                                                  SellToCustTemplate.TESTFIELD("Gen. Bus. Posting Group");
                                                                  "Gen. Bus. Posting Group" := SellToCustTemplate."Gen. Bus. Posting Group";
                                                                  "VAT Bus. Posting Group" := SellToCustTemplate."VAT Bus. Posting Group";
                                                                  IF "Bill-to Customer No." = '' THEN
                                                                    VALIDATE("Bill-to Customer Template Code","Sell-to Customer Template Code");
                                                                END;

                                                                IF NOT InsertMode AND
                                                                   ((xRec."Sell-to Customer Template Code" <> "Sell-to Customer Template Code") OR
                                                                    (xRec."Currency Code" <> "Currency Code"))
                                                                THEN
                                                                  RecreateSalesLines(FIELDCAPTION("Sell-to Customer Template Code"));
                                                              END;

                                                   CaptionML=[DAN=Kundeskabelonkode;
                                                              ENU=Sell-to Customer Template Code] }
    { 5052;   ;Sell-to Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContBusinessRelation@1004 : Record 5054;
                                                                Cont@1002 : Record 5050;
                                                                Opportunity@1000 : Record 5092;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF ("Sell-to Contact No." <> xRec."Sell-to Contact No.") AND
                                                                   (xRec."Sell-to Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF ("Sell-to Contact No." = '') AND ("Opportunity No." <> '') THEN
                                                                    ERROR(Text049,FIELDCAPTION("Sell-to Contact No."));
                                                                  IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Sell-to Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    SalesLine.RESET;
                                                                    SalesLine.SETRANGE("Document Type","Document Type");
                                                                    SalesLine.SETRANGE("Document No.","No.");
                                                                    IF ("Sell-to Contact No." = '') AND ("Sell-to Customer No." = '') THEN BEGIN
                                                                      IF NOT SalesLine.ISEMPTY THEN
                                                                        ERROR(Text005,FIELDCAPTION("Sell-to Contact No."));
                                                                      INIT;
                                                                      SalesSetup.GET;
                                                                      InitRecord;
                                                                      "No. Series" := xRec."No. Series";
                                                                      IF xRec."Shipping No." <> '' THEN BEGIN
                                                                        "Shipping No. Series" := xRec."Shipping No. Series";
                                                                        "Shipping No." := xRec."Shipping No.";
                                                                      END;
                                                                      IF xRec."Posting No." <> '' THEN BEGIN
                                                                        "Posting No. Series" := xRec."Posting No. Series";
                                                                        "Posting No." := xRec."Posting No.";
                                                                      END;
                                                                      IF xRec."Return Receipt No." <> '' THEN BEGIN
                                                                        "Return Receipt No. Series" := xRec."Return Receipt No. Series";
                                                                        "Return Receipt No." := xRec."Return Receipt No.";
                                                                      END;
                                                                      IF xRec."Prepayment No." <> '' THEN BEGIN
                                                                        "Prepayment No. Series" := xRec."Prepayment No. Series";
                                                                        "Prepayment No." := xRec."Prepayment No.";
                                                                      END;
                                                                      IF xRec."Prepmt. Cr. Memo No." <> '' THEN BEGIN
                                                                        "Prepmt. Cr. Memo No. Series" := xRec."Prepmt. Cr. Memo No. Series";
                                                                        "Prepmt. Cr. Memo No." := xRec."Prepmt. Cr. Memo No.";
                                                                      END;
                                                                      EXIT;
                                                                    END;
                                                                    IF "Opportunity No." <> '' THEN BEGIN
                                                                      Opportunity.GET("Opportunity No.");
                                                                      IF Opportunity."Contact No." <> "Sell-to Contact No." THEN BEGIN
                                                                        MODIFY;
                                                                        Opportunity.VALIDATE("Contact No.","Sell-to Contact No.");
                                                                        Opportunity.MODIFY;
                                                                      END
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Sell-to Customer No." <> '') AND ("Sell-to Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Sell-to Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Sell-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    IF ContBusinessRelation."Contact No." <> Cont."Company No." THEN
                                                                      ERROR(Text038,Cont."No.",Cont.Name,"Sell-to Customer No.");
                                                                END;

                                                                UpdateSellToCust("Sell-to Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Sell-to Customer No." <> '' THEN
                                                                IF Cont.GET("Sell-to Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Sell-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;

                                                              IF "Sell-to Contact No." <> '' THEN
                                                                IF Cont.GET("Sell-to Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Sell-to Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[DAN=Kundeattentionnr.;
                                                              ENU=Sell-to Contact No.] }
    { 5053;   ;Bill-to Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContBusinessRelation@1004 : Record 5054;
                                                                Cont@1002 : Record 5050;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF ("Bill-to Contact No." <> xRec."Bill-to Contact No.") AND
                                                                   (xRec."Bill-to Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Bill-to Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    SalesLine.RESET;
                                                                    SalesLine.SETRANGE("Document Type","Document Type");
                                                                    SalesLine.SETRANGE("Document No.","No.");
                                                                    IF ("Bill-to Contact No." = '') AND ("Bill-to Customer No." = '') THEN BEGIN
                                                                      IF NOT SalesLine.ISEMPTY THEN
                                                                        ERROR(Text005,FIELDCAPTION("Bill-to Contact No."));
                                                                      INIT;
                                                                      SalesSetup.GET;
                                                                      InitRecord;
                                                                      "No. Series" := xRec."No. Series";
                                                                      IF xRec."Shipping No." <> '' THEN BEGIN
                                                                        "Shipping No. Series" := xRec."Shipping No. Series";
                                                                        "Shipping No." := xRec."Shipping No.";
                                                                      END;
                                                                      IF xRec."Posting No." <> '' THEN BEGIN
                                                                        "Posting No. Series" := xRec."Posting No. Series";
                                                                        "Posting No." := xRec."Posting No.";
                                                                      END;
                                                                      IF xRec."Return Receipt No." <> '' THEN BEGIN
                                                                        "Return Receipt No. Series" := xRec."Return Receipt No. Series";
                                                                        "Return Receipt No." := xRec."Return Receipt No.";
                                                                      END;
                                                                      IF xRec."Prepayment No." <> '' THEN BEGIN
                                                                        "Prepayment No. Series" := xRec."Prepayment No. Series";
                                                                        "Prepayment No." := xRec."Prepayment No.";
                                                                      END;
                                                                      IF xRec."Prepmt. Cr. Memo No." <> '' THEN BEGIN
                                                                        "Prepmt. Cr. Memo No. Series" := xRec."Prepmt. Cr. Memo No. Series";
                                                                        "Prepmt. Cr. Memo No." := xRec."Prepmt. Cr. Memo No.";
                                                                      END;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    "Bill-to Contact No." := xRec."Bill-to Contact No.";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Bill-to Customer No." <> '') AND ("Bill-to Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Bill-to Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Bill-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    IF ContBusinessRelation."Contact No." <> Cont."Company No." THEN
                                                                      ERROR(Text038,Cont."No.",Cont.Name,"Bill-to Customer No.");
                                                                END;

                                                                UpdateBillToCust("Bill-to Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Bill-to Customer No." <> '' THEN
                                                                IF Cont.GET("Bill-to Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Bill-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;

                                                              IF "Bill-to Contact No." <> '' THEN
                                                                IF Cont.GET("Bill-to Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Bill-to Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[DAN=Faktureres attentionnr.;
                                                              ENU=Bill-to Contact No.] }
    { 5054;   ;Bill-to Customer Template Code;Code10;
                                                   TableRelation="Customer Template";
                                                   OnValidate=VAR
                                                                BillToCustTemplate@1001 : Record 5105;
                                                              BEGIN
                                                                TESTFIELD("Document Type","Document Type"::Quote);
                                                                TESTFIELD(Status,Status::Open);

                                                                IF NOT InsertMode AND
                                                                   ("Bill-to Customer Template Code" <> xRec."Bill-to Customer Template Code") AND
                                                                   (xRec."Bill-to Customer Template Code" <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Bill-to Customer Template Code"));
                                                                  IF Confirmed THEN BEGIN
                                                                    SalesLine.RESET;
                                                                    SalesLine.SETRANGE("Document Type","Document Type");
                                                                    SalesLine.SETRANGE("Document No.","No.");
                                                                    IF "Bill-to Customer Template Code" = '' THEN BEGIN
                                                                      IF NOT SalesLine.ISEMPTY THEN
                                                                        ERROR(Text005,FIELDCAPTION("Bill-to Customer Template Code"));
                                                                      INIT;
                                                                      SalesSetup.GET;
                                                                      InitRecord;
                                                                      "No. Series" := xRec."No. Series";
                                                                      IF xRec."Shipping No." <> '' THEN BEGIN
                                                                        "Shipping No. Series" := xRec."Shipping No. Series";
                                                                        "Shipping No." := xRec."Shipping No.";
                                                                      END;
                                                                      IF xRec."Posting No." <> '' THEN BEGIN
                                                                        "Posting No. Series" := xRec."Posting No. Series";
                                                                        "Posting No." := xRec."Posting No.";
                                                                      END;
                                                                      IF xRec."Return Receipt No." <> '' THEN BEGIN
                                                                        "Return Receipt No. Series" := xRec."Return Receipt No. Series";
                                                                        "Return Receipt No." := xRec."Return Receipt No.";
                                                                      END;
                                                                      IF xRec."Prepayment No." <> '' THEN BEGIN
                                                                        "Prepayment No. Series" := xRec."Prepayment No. Series";
                                                                        "Prepayment No." := xRec."Prepayment No.";
                                                                      END;
                                                                      IF xRec."Prepmt. Cr. Memo No." <> '' THEN BEGIN
                                                                        "Prepmt. Cr. Memo No. Series" := xRec."Prepmt. Cr. Memo No. Series";
                                                                        "Prepmt. Cr. Memo No." := xRec."Prepmt. Cr. Memo No.";
                                                                      END;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    "Bill-to Customer Template Code" := xRec."Bill-to Customer Template Code";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                VALIDATE("Ship-to Code",'');
                                                                IF BillToCustTemplate.GET("Bill-to Customer Template Code") THEN BEGIN
                                                                  BillToCustTemplate.TESTFIELD("Customer Posting Group");
                                                                  "Customer Posting Group" := BillToCustTemplate."Customer Posting Group";
                                                                  "Invoice Disc. Code" := BillToCustTemplate."Invoice Disc. Code";
                                                                  "Customer Price Group" := BillToCustTemplate."Customer Price Group";
                                                                  "Customer Disc. Group" := BillToCustTemplate."Customer Disc. Group";
                                                                  "Allow Line Disc." := BillToCustTemplate."Allow Line Disc.";
                                                                  VALIDATE("Payment Terms Code",BillToCustTemplate."Payment Terms Code");
                                                                  VALIDATE("Payment Method Code",BillToCustTemplate."Payment Method Code");
                                                                  "Shipment Method Code" := BillToCustTemplate."Shipment Method Code";
                                                                END;

                                                                CreateDim(
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center");

                                                                IF NOT InsertMode AND
                                                                   (xRec."Sell-to Customer Template Code" = "Sell-to Customer Template Code") AND
                                                                   (xRec."Bill-to Customer Template Code" <> "Bill-to Customer Template Code")
                                                                THEN
                                                                  RecreateSalesLines(FIELDCAPTION("Bill-to Customer Template Code"));
                                                              END;

                                                   CaptionML=[DAN=Skabelonkode til Faktureres til kunde;
                                                              ENU=Bill-to Customer Template Code] }
    { 5055;   ;Opportunity No.     ;Code20        ;TableRelation=IF (Document Type=FILTER(<>Order)) Opportunity.No. WHERE (Contact No.=FIELD(Sell-to Contact No.),
                                                                                                                           Closed=CONST(No))
                                                                                                                           ELSE IF (Document Type=CONST(Order)) Opportunity.No. WHERE (Contact No.=FIELD(Sell-to Contact No.),
                                                                                                                                                                                       Sales Document No.=FIELD(No.),
                                                                                                                                                                                       Sales Document Type=CONST(Order));
                                                   OnValidate=BEGIN
                                                                LinkSalesDocWithOpportunity(xRec."Opportunity No.");
                                                              END;

                                                   CaptionML=[DAN=Leadnummer;
                                                              ENU=Opportunity No.] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF NOT UserSetupMgt.CheckRespCenter(0,"Responsibility Center") THEN
                                                                  ERROR(
                                                                    Text027,
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetSalesFilter);

                                                                "Location Code" := UserSetupMgt.GetLocation(0,'',"Responsibility Center");
                                                                IF "Location Code" <> '' THEN BEGIN
                                                                  IF Location.GET("Location Code") THEN
                                                                    "Outbound Whse. Handling Time" := Location."Outbound Whse. Handling Time";
                                                                END ELSE BEGIN
                                                                  IF InvtSetup.GET THEN
                                                                    "Outbound Whse. Handling Time" := InvtSetup."Outbound Whse. Handling Time";
                                                                END;

                                                                UpdateShipToAddress;

                                                                CreateDim(
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");

                                                                IF xRec."Responsibility Center" <> "Responsibility Center" THEN BEGIN
                                                                  RecreateSalesLines(FIELDCAPTION("Responsibility Center"));
                                                                  "Assigned User ID" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[DAN=Ansvarscenter;
                                                              ENU=Responsibility Center] }
    { 5750;   ;Shipping Advice     ;Option        ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF InventoryPickConflict("Document Type","No.","Shipping Advice") THEN
                                                                  ERROR(Text066,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice"),TABLECAPTION);
                                                                IF WhseShpmntConflict("Document Type","No.","Shipping Advice") THEN
                                                                  ERROR(STRSUBSTNO(Text070,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice"),TABLECAPTION));
                                                                WhseSourceHeader.SalesHeaderVerifyChange(Rec,xRec);
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DAN=Afsendelsesadvis;
                                                              ENU=Shipping Advice];
                                                   OptionCaptionML=[DAN=Delvis,Komplet;
                                                                    ENU=Partial,Complete];
                                                   OptionString=Partial,Complete }
    { 5751;   ;Shipped Not Invoiced;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Document No.=FIELD(No.),
                                                                                         Qty. Shipped Not Invoiced=FILTER(<>0)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DAN=Lev. bel›b (ufakt.);
                                                              ENU=Shipped Not Invoiced];
                                                   Editable=No }
    { 5752;   ;Completely Shipped  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Min("Sales Line"."Completely Shipped" WHERE (Document Type=FIELD(Document Type),
                                                                                                            Document No.=FIELD(No.),
                                                                                                            Type=FILTER(Item),
                                                                                                            Location Code=FIELD(Location Filter)));
                                                   CaptionML=[DAN=Levering komplet;
                                                              ENU=Completely Shipped];
                                                   Editable=No }
    { 5753;   ;Posting from Whse. Ref.;Integer    ;AccessByPermission=TableData 14=R;
                                                   CaptionML=[DAN=Bogf›ring fra lagerref.;
                                                              ENU=Posting from Whse. Ref.] }
    { 5754;   ;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Location;
                                                   CaptionML=[DAN=Lokationsfilter;
                                                              ENU=Location Filter] }
    { 5790;   ;Requested Delivery Date;Date       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Promised Delivery Date" <> 0D THEN
                                                                  ERROR(
                                                                    Text028,
                                                                    FIELDCAPTION("Requested Delivery Date"),
                                                                    FIELDCAPTION("Promised Delivery Date"));

                                                                IF "Requested Delivery Date" <> xRec."Requested Delivery Date" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Requested Delivery Date"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[DAN=nsket leveringsdato;
                                                              ENU=Requested Delivery Date] }
    { 5791;   ;Promised Delivery Date;Date        ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Promised Delivery Date" <> xRec."Promised Delivery Date" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Promised Delivery Date"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[DAN=Bekr‘ftet leveringsdato;
                                                              ENU=Promised Delivery Date] }
    { 5792;   ;Shipping Time       ;DateFormula   ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Shipping Time" <> xRec."Shipping Time" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Shipping Time"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DAN=Transporttid;
                                                              ENU=Shipping Time] }
    { 5793;   ;Outbound Whse. Handling Time;DateFormula;
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Outbound Whse. Handling Time" <> xRec."Outbound Whse. Handling Time") AND
                                                                   (xRec."Sell-to Customer No." = "Sell-to Customer No.")
                                                                THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Outbound Whse. Handling Time"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 7320=R;
                                                   CaptionML=[DAN=Udg†ende lagerekspeditionstid;
                                                              ENU=Outbound Whse. Handling Time] }
    { 5794;   ;Shipping Agent Service Code;Code10 ;TableRelation="Shipping Agent Services".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                GetShippingTime(FIELDNO("Shipping Agent Service Code"));
                                                                UpdateSalesLines(FIELDCAPTION("Shipping Agent Service Code"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DAN=Spedit›rservicekode;
                                                              ENU=Shipping Agent Service Code] }
    { 5795;   ;Late Order Shipping ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Sell-to Customer No.=FIELD(Sell-to Customer No.),
                                                                                         Document No.=FIELD(No.),
                                                                                         Shipment Date=FIELD(Date Filter),
                                                                                         Outstanding Quantity=FILTER(<>0)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DAN=Forsinket leverance;
                                                              ENU=Late Order Shipping];
                                                   Editable=No }
    { 5796;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[DAN=Datofilter;
                                                              ENU=Date Filter] }
    { 5800;   ;Receive             ;Boolean       ;CaptionML=[DAN=Modtag;
                                                              ENU=Receive] }
    { 5801;   ;Return Receipt No.  ;Code20        ;CaptionML=[DAN=Returvaremodt.nr.;
                                                              ENU=Return Receipt No.] }
    { 5802;   ;Return Receipt No. Series;Code10   ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Return Receipt No. Series" <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  SalesSetup.TESTFIELD("Posted Return Receipt Nos.");
                                                                  NoSeriesMgt.TestSeries(SalesSetup."Posted Return Receipt Nos.","Return Receipt No. Series");
                                                                END;
                                                                TESTFIELD("Return Receipt No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                SalesSetup.TESTFIELD("Posted Return Receipt Nos.");
                                                                IF NoSeriesMgt.LookupSeries(SalesSetup."Posted Return Receipt Nos.","Return Receipt No. Series") THEN
                                                                  VALIDATE("Return Receipt No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[DAN=Returvaremodt.nummerserie;
                                                              ENU=Return Receipt No. Series] }
    { 5803;   ;Last Return Receipt No.;Code20     ;TableRelation="Return Receipt Header";
                                                   CaptionML=[DAN=Sidste returvaremodt.nr.;
                                                              ENU=Last Return Receipt No.];
                                                   Editable=No }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Allow Line Disc."));
                                                              END;

                                                   CaptionML=[DAN=Tillad linjerabat;
                                                              ENU=Allow Line Disc.] }
    { 7200;   ;Get Shipment Used   ;Boolean       ;CaptionML=[DAN=Hent anvendt levering;
                                                              ENU=Get Shipment Used];
                                                   Editable=No }
    { 9000;   ;Assigned User ID    ;Code50        ;TableRelation="User Setup";
                                                   OnValidate=BEGIN
                                                                IF NOT UserSetupMgt.CheckRespCenter2(0,"Responsibility Center","Assigned User ID") THEN
                                                                  ERROR(
                                                                    Text061,"Assigned User ID",
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetSalesFilter2("Assigned User ID"));
                                                              END;

                                                   CaptionML=[DAN=Tildelt bruger-id;
                                                              ENU=Assigned User ID] }
    { 13600;  ;EAN No.             ;Code13        ;OnValidate=BEGIN
                                                                IF NOT OIOXMLDocumentEncode.IsValidEANNo("EAN No.",TRUE) THEN
                                                                  FIELDERROR("EAN No.",Text13606);
                                                              END;

                                                   CaptionML=[DAN=EAN-nr.;
                                                              DEU=EAN-Nr.;
                                                              ENU=EAN No.] }
    { 13602;  ;Account Code        ;Text30        ;OnValidate=BEGIN
                                                                SalesLine.RESET;
                                                                SalesLine.SETRANGE("Document Type","Document Type");
                                                                SalesLine.SETRANGE("Document No.","No.");
                                                                SalesLine.SETFILTER(Type,'>%1',SalesLine.Type::" ");
                                                                SalesLine.SETFILTER("Account Code",'%1|%2',xRec."Account Code",'');
                                                                SalesLine.MODIFYALL("Account Code","Account Code");
                                                              END;

                                                   CaptionML=[DAN=Kontokode;
                                                              DEU=Kontonummer;
                                                              ENU=Account Code] }
    { 13604;  ;OIOUBL Profile Code ;Code10        ;TableRelation="OIOUBL Profile";
                                                   CaptionML=[DAN=OIOUBL-profilkode;
                                                              ENU=OIOUBL Profile Code] }
    { 13605;  ;Sell-to Contact Phone No.;Text30   ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[DAN=Telefonnummer til kundekontakt;
                                                              ENU=Sell-to Contact Phone No.] }
    { 13606;  ;Sell-to Contact Fax No.;Text30     ;CaptionML=[DAN=Faxnummer til kundekontakt;
                                                              ENU=Sell-to Contact Fax No.] }
    { 13607;  ;Sell-to Contact E-Mail;Text80      ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[DAN=Mailadresse til kundekontakt;
                                                              ENU=Sell-to Contact E-Mail] }
    { 13608;  ;Sell-to Contact Role;Option        ;CaptionML=[DAN=Kundekontaktens rolle;
                                                              ENU=Sell-to Contact Role];
                                                   OptionCaptionML=[DAN=" ,,,Indk›bsansvarlig,,,Bogholder,,,Budgetansvarlig,,,Indk›ber";
                                                                    ENU=" ,,,Purchase Responsible,,,Accountant,,,Budget Responsible,,,Requisitioner"];
                                                   OptionString=[ ,,,Purchase Responsible,,,Accountant,,,Budget Responsible,,,Requisitioner] }
    { 13620;  ;Payment Channel     ;Option        ;OnValidate=BEGIN
                                                                IF "Payment Channel" = "Payment Channel"::"Payment Slip" THEN
                                                                  ERROR(Text13607,FIELDCAPTION("Payment Channel"),"Payment Channel");
                                                              END;

                                                   CaptionML=[DAN=Betalingskanal;
                                                              ENU=Payment Channel];
                                                   OptionCaptionML=[DAN=" ,Betalingsbon,Kontooverf›rsel,National transaktion,Direct Debit";
                                                                    ENU=" ,Payment Slip,Account Transfer,National Clearing,Direct Debit"];
                                                   OptionString=[ ,Payment Slip,Account Transfer,National Clearing,Direct Debit] }
    { 50000;  ;Job No.             ;Code20        ;TableRelation=Job;
                                                   OnValidate=VAR
                                                                xJobTask@1000000000 : Code[20];
                                                              BEGIN
                                                                // >> NaviCom: Check sagen
                                                                _Sag.GET("Job No.");
                                                                _Sag.TESTFIELD(Blocked,0);
                                                                IF (_Sag.Status = _Sag.Status::Completed) THEN
                                                                  ERROR('Sagen er afsluttet!');
                                                                // <<

                                                                // >> 27:
                                                                _Sag.TESTFIELD(Status,_Sag.Status::Order);
                                                                _Sag.TESTFIELD("Global Dimension 1 Code");
                                                                _Sag.TESTFIELD("Job Posting Group");
                                                                // << 27

                                                                // >> 36:
                                                                IF "Sell-to Customer No." <> '99992' THEN
                                                                // << 36
                                                                //[03] Sintas start
                                                                  IF "Intern(Debitor)" THEN
                                                                    ERROR('Der kan kun angives sagsnr. p† externe debitorer');

                                                                IF _Sag.GET("Job No.") THEN BEGIN
                                                                  Sagstype := _Sag.Sagstype;
                                                                  "Salesperson Code" := _Sag.Entrepriseleder;
                                                                // >> 31:
                                                                //   "External Document No." := _Sag."Eksternt bilagsnr.";
                                                                   VALIDATE("Deres M‘rke",_Sag."Eksternt bilagsnr.");
                                                                // << 31

                                                                END;
                                                                //[03] Sintas slut
                                                                //[05] Sintas start
                                                                IF "Job No." <> '' THEN BEGIN
                                                                  "Ship-to Name"        := _Sag.Leveringsnavn;
                                                                  "Ship-to Name 2"    := _Sag."Leveringsnavn 2";
                                                                  "Ship-to Address"     := _Sag.Leveringsadresse;
                                                                  "Ship-to Address 2" := _Sag."Leveringsadresse 2";
                                                                  "Ship-to City"          := _Sag.Leveringsby;
                                                                  "Ship-to Contact"  := _Sag."Leveres attention";

                                                                // >> 26:
                                                                //SYSDAB >>
                                                                  //"Ship-to Contact" := '';
                                                                //SYSDAB <<
                                                                // << 26

                                                                // >> SYS1.05:
                                                                IF ("Document Type" <> "Document Type"::"Credit Memo") AND ("Document Type" <> "Document Type"::Invoice) THEN
                                                                  "Ship-to Contact" := _Sag.T›mrerformand;
                                                                // << SYS1.05

                                                                  "Ship-to Post Code"   := _Sag."Leveringspostnr.";
                                                                  "Ship-to County"         := _Sag.Leveringsamt;
                                                                  "Ship-to Country/Region Code"   := _Sag.Leveringslandekode;
                                                                  VALIDATE("Salesperson Code",_Sag.Entrepriseleder);
                                                                //[15] Sintas start
                                                                  SagsBeskrivelse  := _Sag.Description;
                                                                //[15] Sintas slut
                                                                //[16] Sintas start
                                                                  VALIDATE("Shortcut Dimension 1 Code",_Sag."Global Dimension 1 Code");
                                                                //[16] Sintas slut
                                                                //[12] SIntas start
                                                                  Cust2.GET("Bill-to Customer No.");
                                                                  IF _Sag."Betalingsbeting.kode" <> '' THEN
                                                                    VALIDATE("Payment Terms Code",_Sag."Betalingsbeting.kode")
                                                                  ELSE
                                                                    VALIDATE("Payment Terms Code",Cust2."Payment Terms Code");

                                                                //[12] Sintas slut
                                                                END;
                                                                //[05] Sintas slut

                                                                // >> 21:
                                                                SalesLine.SETRANGE("Document Type","Document Type");
                                                                SalesLine.SETRANGE("Document No.","No.");
                                                                SalesLine.SETFILTER("Job No.",'<>%1','');
                                                                IF SalesLine.FIND('-') THEN BEGIN
                                                                  REPEAT
                                                                    SalesLine.RegningsArbejde := _Sag.RegningsArbejde;
                                                                    IF _Sag."Global Dimension 1 Code" <> '' THEN
                                                                      SalesLine.VALIDATE("Shortcut Dimension 1 Code",_Sag."Global Dimension 1 Code");
                                                                  UNTIL SalesLine.NEXT =0;
                                                                END;
                                                                // << 21

                                                                // >> 23:
                                                                IF D›rskemaHoved.GET("Document Type","No.") THEN BEGIN
                                                                  D›rskemaHoved."Sagsnr." := "Job No.";
                                                                  D›rskemaHoved.MODIFY;
                                                                END;
                                                                // << 23
                                                                // >> 25:
                                                                IF Glasskemahoved.GET("Document Type","No.") THEN BEGIN
                                                                  Glasskemahoved."Sagsnr." := "Job No.";
                                                                  Glasskemahoved.MODIFY;
                                                                END;
                                                                // << 25
                                                                // >> 37:
                                                                PurchaseHeader.SETRANGE("Document Type",PurchaseHeader."Document Type"::Order);
                                                                PurchaseHeader.SETRANGE("Salgsordrenr.","No.");
                                                                IF PurchaseHeader.FIND('-') THEN REPEAT
                                                                  PurchaseHeader."Job No." := "Job No.";
                                                                  PurchaseHeader.MODIFY;
                                                                UNTIL PurchaseHeader.NEXT = 0;
                                                                // << 37
                                                              END;

                                                   CaptionML=[DAN=Sagsnr.;
                                                              DEU=Objekt Nr.;
                                                              ENU=Job No.] }
    { 50001;  ;Ordretype           ;Option        ;OptionString=[ ,Sagsreservation] }
    { 50002;  ;Job Task No.        ;Code20        ;TableRelation="Job Task"."Job Task No." WHERE (Job No.=FIELD(Job No.));
                                                   CaptionML=[DAN=Sagsopgavenr.;
                                                              ENU=Job Task No.] }
    { 50005;  ;Deres M‘rke         ;Text50        ;OnValidate=BEGIN
                                                                // >> 31:
                                                                "External Document No." := COPYSTR("Deres M‘rke",1,20);
                                                                // << 31
                                                              END;
                                                               }
    { 50010;  ;Bonus               ;Boolean        }
    { 50011;  ;Kreditv‘rdighed     ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Kreditv‘rdighed WHERE (No.=FIELD(Sell-to Customer No.)));
                                                   OptionString=[ ,God,D†rlig,Forsigtig,Incasso,Konkurs,Betalingsstandsning,Skal betale kontant];
                                                   Editable=No }
    { 50012;  ;Intern(Debitor)     ;Boolean       ;Editable=No }
    { 50013;  ;Sagstype            ;Option        ;OptionString=Entreprise,Export,DK varesalg }
    { 50015;  ;Nettov‘gt i kg      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum(Kollilinier."Totalv‘gt i kg" WHERE (Ordrenr.=FIELD(No.)));
                                                   Editable=No }
    { 50016;  ;Bruttov‘gt i kg     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Kollihoved."Total bruttov‘gt i kg" WHERE (Ordrenr.=FIELD(No.)));
                                                   Editable=No }
    { 50017;  ;Mü                  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum(Kollihoved.Mü WHERE (Ordrenr.=FIELD(No.)));
                                                   Editable=No }
    { 50018;  ;Kolliantal          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum(Kollilinier."Antal kolli" WHERE (Ordrenr.=FIELD(No.)));
                                                   Editable=No }
    { 50019;  ;Leveringstidspunkt  ;Time          ;OnValidate=BEGIN
                                                                // >> 24:
                                                                IF NOT UserSetup.GET(USERID) THEN
                                                                  UserSetup."Frit leveringstidspunkt p† ord" := FALSE;

                                                                IF NOT UserSetup."Frit leveringstidspunkt p† ord" THEN BEGIN // Kontroller
                                                                  IF "Shipment Date" - TODAY = 0 THEN BEGIN
                                                                    IF ROUND((Leveringstidspunkt-TIME)/3600000) < 19 THEN
                                                                     ERROR('Der kan ikke leveres samme dag');
                                                                  END;

                                                                  IF "Shipment Date" - TODAY = 1 THEN BEGIN
                                                                    IF ROUND(((235959T-TIME) + (Leveringstidspunkt - 000000T))/3600000) < 19 THEN
                                                                      ERROR('Der skal v‘re mindst 19 timer til levering');
                                                                  END;
                                                                END;
                                                                // << 24

                                                                //>>SYS
                                                                IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                  WarehouseActivityHeader.SETCURRENTKEY("Ordrenr.");
                                                                  WarehouseActivityHeader.SETRANGE("Ordrenr.","No.");
                                                                  IF WarehouseActivityHeader.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                    REPEAT
                                                                      WarehouseActivityHeader.Afsendelsestid := Leveringstidspunkt;
                                                                      WarehouseActivityHeader.MODIFY;
                                                                    UNTIL WarehouseActivityHeader.NEXT = 0;
                                                                  END;

                                                                  WarehouseShipmentHeader.SETCURRENTKEY("Order No.");
                                                                  WarehouseShipmentHeader.SETRANGE("Order No.","No.");
                                                                  IF WarehouseShipmentHeader.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                    REPEAT
                                                                      WarehouseShipmentHeader.Afsendelsestid := Leveringstidspunkt;
                                                                      WarehouseShipmentHeader.MODIFY;
                                                                    UNTIL WarehouseShipmentHeader.NEXT = 0;
                                                                  END;
                                                                END;
                                                                //<<SYS
                                                              END;
                                                               }
    { 50020;  ;Plukkeliste(udskrevet);Integer      }
    { 50021;  ;Eksporterkl‘ringskode;Code20       ;TableRelation="Diverse tekster hoved".Nummer WHERE (Type=CONST(Eksporttekst)) }
    { 50023;  ;SagsBeskrivelse     ;Text50        ;CaptionML=DAN=Sagsbeskrivelse }
    { 50024;  ;Tilbud status       ;Option        ;OptionCaptionML=[DAN=Under oprettelse,Kunde godkendt,DEKO;
                                                                    ENU=Under Creation,Customer Approved,DEKO];
                                                   OptionString=Under oprettelse,Kunde godkendt,DEKO }
    { 50025;  ;D›rskema findes     ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(D›rskemahoved WHERE (Document Type=FIELD(Document Type),
                                                                                          Dokument No=FIELD(No.)));
                                                   Editable=No }
    { 50026;  ;Glasskema findes    ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(Glasskemahoved WHERE (Document Type=FIELD(Document Type),
                                                                                           Dokument No=FIELD(No.)));
                                                   Editable=No }
    { 50027;  ;Malet Profilskema findes;Boolean   ;FieldClass=FlowField;
                                                   CalcFormula=Exist(MaletProfilSkemahoved WHERE (Document Type=FIELD(Document Type),
                                                                                                  Dokument No=FIELD(No.)));
                                                   Editable=No }
    { 50030;  ;Fakturakrav Overholdt;Code10        }
    { 50031;  ;Own Brand           ;Text50        ;CaptionML=[DAN=Eget m‘rke;
                                                              ENU=Own Brand] }
    { 50050;  ;Plukliste Tid       ;Time           }
    { 50051;  ;Plukliste Dato      ;Date           }
    { 50052;  ;Plukliste Korrektion;Integer        }
    { 50053;  ;Plukliste Printer   ;Text50         }
    { 50055;  ;I Pluk              ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Warehouse Activity Header" WHERE (Type=CONST(Pick),
                                                                                                        Ordrenr.=FIELD(No.),
                                                                                                        Assigned User ID=FILTER(<>'')));
                                                   OnValidate=BEGIN
                                                                // >> 29:
                                                                UserSetup.GET(USERID);
                                                                IF NOT UserSetup.Logistik //THEN
                                                                // >> DAB
                                                                AND NOT UserSetup."Ignore In Pick" THEN
                                                                  ERROR('Du har ikke rettigheder til dette felt.');
                                                                // << 29
                                                              END;
                                                               }
    { 50056;  ;Pluk ansvarlig      ;Code20         }
    { 50057;  ;Kontrol ansvarlig   ;Code20         }
    { 50058;  ;ShippedNotInvoiced  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=CONST(Order),
                                                                                         Document No.=FIELD(No.),
                                                                                         Qty. Shipped Not Invoiced=FILTER(<>0))) }
    { 50060;  ;Ordre Oprettet af   ;Code50        ;Editable=No }
    { 50061;  ;Ordre Oprettet DT   ;DateTime      ;Editable=No }
    { 50062;  ;My Order            ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("My Sales Orders" WHERE (Order No.=FIELD(No.),
                                                                                              User ID=FIELD(User Filter)));
                                                   Editable=No }
    { 50063;  ;User Filter         ;Code30        ;FieldClass=FlowFilter }
    { 50070;  ;Send ikke fakturamail;Boolean       }
    { 50071;  ;Indk›bes til Sagsnr.;Code20        ;TableRelation=Job }
    { 50080;  ;Glasskema           ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Glasskemahoved WHERE (Document Type=FIELD(Document Type),
                                                                                           Dokument No=FIELD(No.)));
                                                   Editable=No }
    { 50081;  ;D›rskema            ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(D›rskemahoved WHERE (Document Type=FIELD(Document Type),
                                                                                          Dokument No=FIELD(No.)));
                                                   Editable=No }
    { 50082;  ;BK skema            ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("BK Skemahoved" WHERE (Document Type=FIELD(Document Type),
                                                                                            Dokument No=FIELD(No.)));
                                                   Editable=No }
    { 50083;  ;Malet profilskema   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(MaletProfilSkemahoved WHERE (Document Type=FIELD(Document Type),
                                                                                                  Dokument No=FIELD(No.)));
                                                   Editable=No }
    { 50084;  ;D›rskema - d›rordre ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(D›rskemahoved WHERE (Document Type=FIELD(Document Type),
                                                                                          D›r Ordrenr.=FIELD(No.)));
                                                   Editable=No }
    { 50090;  ;Faktureringskrav    ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Faktureringskrav WHERE (No.=FIELD(Bill-to Customer No.)));
                                                   Editable=No }
    { 50100;  ;Sagstypekode        ;Code20        ;TableRelation=Sagstyper;
                                                   OnValidate=BEGIN
                                                                IF Sagstypekode = '' THEN
                                                                  ERROR('Sagstypekode skal udfyldes!')
                                                                ELSE BEGIN
                                                                  SagstypeRec.GET(Sagstypekode);
                                                                  "Sagstype beskrivelse" := SagstypeRec.Beskrivelse;
                                                                  Sagstype := SagstypeRec.Sagstype;
                                                                END;
                                                              END;
                                                               }
    { 50101;  ;Sagstype beskrivelse;Text50         }
    { 50140;  ;N‘ste K›bsordre     ;Code1         ;InitValue=0 }
    { 50200;  ;Line Amount         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Line Amount" WHERE (Document Type=FIELD(Document Type),
                                                                                                     Document No.=FIELD(No.)));
                                                   Editable=No }
    { 60000;  ;Job Blocked         ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Job.Blocked WHERE (No.=FIELD(Job No.)));
                                                   OnValidate=VAR
                                                                SalesHeader@1000000004 : Record 36;
                                                                SalesLine@1000000003 : Record 37;
                                                                lText001@1000000006 : TextConst 'DAN=Der er leverede men ikke fakturerede linier p† salgsordre %1. Sagen kan ikke sp‘rres!;ENU=<Der blev fundet fakturerede eller leverede linier p† salgsordrer tilknyttet denne sag.\Visse salgsordrer kunne derfor ikke slettes>';
                                                                lText002@1000000005 : TextConst 'DAN=Der er fundet salgsordrer tilknyttet denne sag.\Skal de slettes?;ENU=<Der er fundet ordrer tilknyttet denne sag.\Skal de tilknyttede ordrer slettes?>';
                                                                PurchaseHeader@1000000008 : Record 38;
                                                                PurchaseLine@1000000007 : Record 39;
                                                                lText003@1000000010 : TextConst 'DAN=Der er modtagne men ikke fakturerede linier p† k›bsordre %1. Sagen kan ikke sp‘rres!;ENU=<Der blev fundet fakturerede eller leverede linier p† salgsordrer tilknyttet denne sag.\Visse salgsordrer kunne derfor ikke slettes>';
                                                                lText004@1000000009 : TextConst 'DAN=Der er fundet k›bsordrer tilknyttet denne sag.\Skal de slettes?;ENU=<Der er fundet ordrer tilknyttet denne sag.\Skal de tilknyttede ordrer slettes?>';
                                                              BEGIN
                                                              END;

                                                   CaptionML=[DAN=Sag sp‘rret;
                                                              ENU=Job Blocked];
                                                   OptionCaptionML=[DAN=" ,Bogf›ring,Alle";
                                                                    ENU=" ,Posting,All"];
                                                   OptionString=[ ,Posting,All];
                                                   Editable=No }
    { 60001;  ;Called From Scanner ;Boolean        }
    { 60002;  ;Antal varelinier    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Document No.=FIELD(No.),
                                                                                         Type=CONST(Item)));
                                                   Editable=No }
    { 73006;  ;Leveres att. mobil  ;Code20         }
    { 73080;  ;Leveres att. E-mail ;Text80        ;OnValidate=BEGIN
                                                                // >> 4:
                                                                IF "Leveres att. E-mail" <> '' THEN
                                                                  IF STRPOS("Leveres att. E-mail",'@') = 0 THEN
                                                                    ERROR('E-Mail skal indeholde @.');
                                                                // << 4
                                                              END;

                                                   ExtendedDatatype=E-Mail }
    { 73090;  ;T›mrerformand       ;Text50         }
    { 73091;  ;T›mrerformand mobil ;Text50         }
    { 73092;  ;Kran                ;Boolean       ;OnValidate=BEGIN
                                                                //>>SYS
                                                                IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                  WarehouseActivityHeader.SETCURRENTKEY("Ordrenr.");
                                                                  WarehouseActivityHeader.SETRANGE("Ordrenr.","No.");
                                                                  IF WarehouseActivityHeader.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                    REPEAT
                                                                      WarehouseActivityHeader.Kran := Kran;
                                                                      WarehouseActivityHeader.MODIFY;
                                                                    UNTIL WarehouseActivityHeader.NEXT = 0;
                                                                  END;

                                                                  WarehouseShipmentHeader.SETCURRENTKEY("Order No.");
                                                                  WarehouseShipmentHeader.SETRANGE("Order No.","No.");
                                                                  IF WarehouseShipmentHeader.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                    REPEAT
                                                                      WarehouseShipmentHeader.Kran := Kran;
                                                                      WarehouseShipmentHeader.MODIFY;
                                                                    UNTIL WarehouseShipmentHeader.NEXT = 0;
                                                                  END;
                                                                END;
                                                                //<<SYS
                                                              END;
                                                               }
    { 73093;  ;Afhenter            ;Boolean       ;OnValidate=BEGIN
                                                                //>>SYS
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                  WarehouseActivityHeader.SETCURRENTKEY("Ordrenr.");
                                                                  WarehouseActivityHeader.SETRANGE("Ordrenr.","No.");
                                                                  IF WarehouseActivityHeader.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                    REPEAT
                                                                      WarehouseActivityHeader.Afhenter := Afhenter;
                                                                      WarehouseActivityHeader.MODIFY;
                                                                    UNTIL WarehouseActivityHeader.NEXT = 0;
                                                                  END;

                                                                  WarehouseShipmentHeader.SETCURRENTKEY("Order No.");
                                                                  WarehouseShipmentHeader.SETRANGE("Order No.","No.");
                                                                  IF WarehouseShipmentHeader.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                    REPEAT
                                                                      WarehouseShipmentHeader.Afhenter := Afhenter;
                                                                      WarehouseShipmentHeader.MODIFY;
                                                                    UNTIL WarehouseShipmentHeader.NEXT = 0;
                                                                  END;
                                                                END;
                                                                //<<SYS
                                                              END;
                                                               }
    { 73094;  ;Kurer               ;Boolean       ;OnValidate=BEGIN
                                                                //>>SYS
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                  WarehouseActivityHeader.SETCURRENTKEY("Ordrenr.");
                                                                  WarehouseActivityHeader.SETRANGE("Ordrenr.","No.");
                                                                  IF WarehouseActivityHeader.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                    REPEAT
                                                                      WarehouseActivityHeader.Kurer := Kurer;
                                                                      WarehouseActivityHeader.MODIFY;
                                                                    UNTIL WarehouseActivityHeader.NEXT = 0;
                                                                  END;

                                                                  WarehouseShipmentHeader.SETCURRENTKEY("Order No.");
                                                                  WarehouseShipmentHeader.SETRANGE("Order No.","No.");
                                                                  IF WarehouseShipmentHeader.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                    REPEAT
                                                                      WarehouseShipmentHeader.Kurer := Kurer;
                                                                      WarehouseShipmentHeader.MODIFY;
                                                                    UNTIL WarehouseShipmentHeader.NEXT = 0;
                                                                  END;
                                                                END;
                                                                //<<SYS
                                                              END;

                                                   CaptionML=[DAN=Kur‚r;
                                                              ENU=Kurer] }
    { 73095;  ;Afvent forsendelse  ;Boolean       ;OnValidate=BEGIN
                                                                //>>SYS
                                                                IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                  WarehouseActivityHeader.SETCURRENTKEY("Ordrenr.");
                                                                  WarehouseActivityHeader.SETRANGE("Ordrenr.","No.");
                                                                  IF WarehouseActivityHeader.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                    REPEAT
                                                                      WarehouseActivityHeader."Afvent forsendelse" := "Afvent forsendelse";
                                                                      WarehouseActivityHeader.MODIFY;
                                                                    UNTIL WarehouseActivityHeader.NEXT = 0;
                                                                  END;

                                                                  WarehouseShipmentHeader.SETCURRENTKEY("Order No.");
                                                                  WarehouseShipmentHeader.SETRANGE("Order No.","No.");
                                                                  IF WarehouseShipmentHeader.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                    REPEAT
                                                                      WarehouseShipmentHeader."Afvent forsendelse" := "Afvent forsendelse";
                                                                      WarehouseShipmentHeader.MODIFY;
                                                                    UNTIL WarehouseShipmentHeader.NEXT = 0;
                                                                  END;
                                                                END;
                                                                //<<SYS
                                                              END;
                                                               }
    { 73096;  ;Afhentning          ;Boolean        }
    { 73097;  ;Afhentningsdato     ;Date           }
    { 6016800;;Payment Reference (PM);Text30      ;CaptionML=[DAN=Betalingsreference (PM);
                                                              ENU=Payment Reference (PM)] }
  }
  KEYS
  {
    {    ;Document Type,No.                       ;Clustered=Yes }
    {    ;No.,Document Type                        }
    {    ;Document Type,Sell-to Customer No.       }
    {    ;Document Type,Bill-to Customer No.       }
    {    ;Document Type,Combine Shipments,Bill-to Customer No.,Currency Code,EU 3-Party Trade }
    {    ;Sell-to Customer No.,External Document No. }
    {    ;Document Type,Sell-to Contact No.        }
    {    ;Bill-to Contact No.                      }
    {    ;Incoming Document Entry No.              }
    {    ;Document Type,Job No.                    }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'DAN=nsker du at udskrive leverance %1?;ENU=Do you want to print shipment %1?';
      Text001@1001 : TextConst 'DAN=nsker du at udskrive faktura %1?;ENU=Do you want to print invoice %1?';
      Text002@1002 : TextConst 'DAN=nsker du at udskrive kreditnota %1?;ENU=Do you want to print credit memo %1?';
      Text003@1003 : TextConst 'DAN=%1 kan ikke omd›bes.;ENU=You cannot rename a %1.';
      Text004@1004 : TextConst 'DAN=Skal %1 ‘ndres?;ENU=Do you want to change %1?';
      Text005@1005 : TextConst 'DAN=Du kan ikke nulstille %1, fordi dokumentet stadig indeholder en eller flere linjer.;ENU=You cannot reset %1 because the document still has one or more lines.';
      Text006@1006 : TextConst 'DAN=Du kan ikke ‘ndre %1, fordi ordren er knyttet til en eller flere k›bsordrer.;ENU=You cannot change %1 because the order is associated with one or more purchase orders.';
      Text007@1007 : TextConst 'DAN=%1 kan ikke v‘re st›rre end %2 i tabellen %3.;ENU=%1 cannot be greater than %2 in the %3 table.';
      Text009@1009 : TextConst 'DAN=Hvis du sletter dette dokument, opst†r der et hul i nummerserien for leverancer. Der oprettes en tom leverance %1 for at udfylde hullet i nummerserien.\\Vil du forts‘tte?;ENU=Deleting this document will cause a gap in the number series for shipments. An empty shipment %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text012@1012 : TextConst 'DAN=Hvis du sletter dette dokument, opst†r der et hul i nummerserien for bogf›rte fakturaer. Der oprettes en tom bogf›rt faktura %1 for at udfylde hullet i nummerserien.\\Vil du forts‘tte?;ENU=Deleting this document will cause a gap in the number series for posted invoices. An empty posted invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text014@1014 : TextConst 'DAN=Hvis du sletter dette dokument, opst†r der et hul i nummerserien for bogf›rte kreditnotaer. Der oprettes en tom bogf›rt kreditnota %1 for at udfylde hullet i nummerserien.\\Vil du forts‘tte?;ENU=Deleting this document will cause a gap in the number series for posted credit memos. An empty posted credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text015@1015 : TextConst 'DAN=Hvis du ‘ndrer %1, slettes de eksisterende salgslinjer, og der oprettes nye salgslinjer p† baggrund af de nye oplysninger i hovedet.\\Vil du ‘ndre %1?;ENU=If you change %1, the existing sales lines will be deleted and new sales lines based on the new information on the header will be created.\\Do you want to change %1?';
      Text017@1017 : TextConst 'DAN=Du skal slette de eksisterende salgslinjer, f›r du kan ‘ndre %1.;ENU=You must delete the existing sales lines before you can change %1.';
      Text018@1018 : TextConst 'DAN=Du har ‘ndret %1 p† salgshovedet, men det er ikke blevet ‘ndret p† de eksisterende salgslinjer.\;ENU=You have changed %1 on the sales header, but it has not been changed on the existing sales lines.\';
      Text019@1019 : TextConst 'DAN=Du skal opdatere de eksisterende salgslinjer manuelt.;ENU=You must update the existing sales lines manually.';
      Text020@1020 : TextConst 'DAN=’ndringen kan p†virke den valutakurs, der blev brugt i prisberegningen p† salgslinjerne.;ENU=The change may affect the exchange rate used in the price calculation of the sales lines.';
      Text021@1021 : TextConst 'DAN=Vil du opdatere valutakursen?;ENU=Do you want to update the exchange rate?';
      Text022@1022 : TextConst 'DAN=Du kan ikke slette dette bilag. Dit id tillader kun behandling fra %1 %2.;ENU=You cannot delete this document. Your identification is set up to process from %1 %2 only.';
      Text023@1023 : TextConst 'DAN=Vil du udskrive returvaremodtagelse %1?;ENU=Do you want to print return receipt %1?';
      Text024@1024 : TextConst 'DAN=Du har redigeret feltet %1. Genberegningen af moms kan resultere i ›redifferencer, s† du skal kontrollere bel›bene efter genberegningen. Vil du opdatere feltet %2 p† linjerne, s† den nye v‘rdi for %1 afspejles?;ENU=You have modified the %1 field. The recalculation of VAT may cause penny differences, so you must check the amounts afterward. Do you want to update the %2 field on the lines to reflect the new value of %1?';
      Text027@1027 : TextConst 'DAN=Dit id tillader kun behandling fra %1 %2.;ENU=Your identification is set up to process from %1 %2 only.';
      Text028@1028 : TextConst 'DAN=%1 kan ikke ‘ndres, n†r %2 er udfyldt.;ENU=You cannot change the %1 when the %2 has been filled in.';
      Text030@1030 : TextConst 'DAN=Hvis du sletter dette dokument, opst†r der et hul i nummerserien for returvaremodtagelse. Der oprettes en tom returvaremodtagelse %1 for at udfylde hullet i nummerserien.\\Vil du forts‘tte?;ENU=Deleting this document will cause a gap in the number series for return receipts. An empty return receipt %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text031@1031 : TextConst 'DAN=Du har ‘ndret %1.\\;ENU=You have modified %1.\\';
      Text032@1032 : TextConst 'DAN=Vil du opdatere linjerne?;ENU=Do you want to update the lines?';
      Text067@2002 : TextConst 'DAN=%1 %4 med bel›bet %2 er allerede godkendt den %3 og er endnu ikke udl›bet. Du skal annullere den forrige godkendelse, f›r du kan godkende denne %1 igen.;ENU=%1 %4 with amount of %2 has already been authorized on %3 and is not expired yet. You must void the previous authorization before you can re-authorize this %1.';
      Text068@2003 : TextConst 'DAN=Der er intet at annullere.;ENU=There is nothing to void.';
      Text069@2004 : TextConst 'DAN=Den valgte handling kan ikke udf›res med den angivne %1.;ENU=The selected operation cannot complete with the specified %1.';
      SalesSetup@1033 : Record 311;
      GLSetup@1034 : Record 98;
      GLAcc@1035 : Record 15;
      SalesHeader@1036 : Record 36;
      SalesLine@1037 : Record 37;
      CustLedgEntry@1038 : Record 21;
      Cust@1039 : Record 18;
      PaymentTerms@1040 : Record 3;
      PaymentMethod@1041 : Record 289;
      CurrExchRate@1042 : Record 330;
      SalesCommentLine@1043 : Record 44;
      ShipToAddr@1044 : Record 222;
      PostCode@1045 : Record 225;
      BankAcc@1046 : Record 270;
      SalesShptHeader@1047 : Record 110;
      SalesInvHeader@1048 : Record 112;
      SalesCrMemoHeader@1049 : Record 114;
      ReturnRcptHeader@1050 : Record 6660;
      SalesInvHeaderPrepmt@1101 : Record 112;
      SalesCrMemoHeaderPrepmt@1100 : Record 114;
      GenBusPostingGrp@1051 : Record 250;
      GenJnILine@1052 : Record 81;
      RespCenter@1053 : Record 5714;
      InvtSetup@1054 : Record 313;
      Location@1055 : Record 14;
      WhseRequest@1056 : Record 5765;
      ShippingAgentService@1057 : Record 5790;
      TempReqLine@1089 : TEMPORARY Record 246;
      UserSetupMgt@1058 : Codeunit 5700;
      NoSeriesMgt@1059 : Codeunit 396;
      CustCheckCreditLimit@1060 : Codeunit 312;
      TransferExtendedText@1061 : Codeunit 378;
      GenJnlApply@1062 : Codeunit 225;
      SalesPost@1063 : Codeunit 80;
      CustEntrySetApplID@1064 : Codeunit 101;
      DimMgt@1065 : Codeunit 408;
      ApprovalMgt@1099 : Codeunit 439;
      WhseSourceHeader@1073 : Codeunit 5781;
      ArchiveManagement@1075 : Codeunit 5063;
      SalesLineReserve@1066 : Codeunit 99000832;
      DOPaymentMgt@2000 : Codeunit 825;
      DOPaymentTransLogMgt@2001 : Codeunit 829;
      ApplyCustEntries@1067 : Page 232;
      CurrencyDate@1068 : Date;
      HideValidationDialog@1069 : Boolean;
      Confirmed@1070 : Boolean;
      Text035@1076 : TextConst 'DAN=Du kan ikke frigive et tilbud eller oprette en ordre, medmindre du angiver en debitor p† tilbuddet.\\Vil du oprette en debitor nu?;ENU=You cannot Release Quote or Make Order unless you specify a customer on the quote.\\Do you want to create customer(s) now?';
      Text037@1078 : TextConst 'DAN=Kontakten %1 %2 er ikke knyttet til debitoren %3.;ENU=Contact %1 %2 is not related to customer %3.';
      Text038@1074 : TextConst 'DAN=Kontakten %1 %2 er knyttet til en anden virksomhed end debitoren %3.;ENU=Contact %1 %2 is related to a different company than customer %3.';
      Text039@1086 : TextConst 'DAN=Kontakten %1 %2 er ikke knyttet til en debitor.;ENU=Contact %1 %2 is not related to a customer.';
      ReservEntry@1079 : Record 337;
      TempReservEntry@1080 : TEMPORARY Record 337;
      Text040@1083 : TextConst 'DAN=Der er knyttet et vundet lead til denne ordre.\Det skal have statussen Tabt, f›r ordren kan slettes.\Vil du ‘ndre status for dette lead nu?;ENU=A won opportunity is linked to this order.\It has to be changed to status Lost before the Order can be deleted.\Do you want to change the status for this opportunity now?';
      Text043@1087 : TextConst 'DAN=Guiden blev afbrudt;ENU=Wizard Aborted';
      Text044@1088 : TextConst 'DAN=Status for dette lead er ikke blevet ‘ndret. Sletningen af ordren blev afbrudt.;ENU=The status of the opportunity has not been changed. The program has aborted deleting the order.';
      SkipSellToContact@1016 : Boolean;
      SkipBillToContact@1025 : Boolean;
      Text045@1081 : TextConst 'DAN="Du kan ikke ‘ndre feltet %1, fordi %2 %3 har %4 = %5 og %6 allerede er blevet tildelt %7 %8.";ENU="You can not change the %1 field because %2 %3 has %4 = %5 and the %6 has already been assigned %7 %8."';
      Text048@1091 : TextConst 'DAN=Salgstilbuddet %1 er allerede blevet tildelt til leadet %2. Vil du omfordele dette tilbud?;ENU=Sales quote %1 has already been assigned to opportunity %2. Would you like to reassign this quote?';
      Text049@1092 : TextConst 'DAN=Feltet %1 kan ikke v‘re tomt, fordi dette tilbud er knyttet til et lead.;ENU=The %1 field cannot be blank because this quote is linked to an opportunity.';
      InsertMode@1093 : Boolean;
      CompanyInfo@1094 : Record 79;
      HideCreditCheckDialogue@1097 : Boolean;
      Text051@1071 : TextConst 'DAN=Salgene %1 %2 findes allerede.;ENU=The sales %1 %2 already exists.';
      Text052@1098 : TextConst 'DAN=Salgene %1 %2 har varesporing. Vil du slette den alligevel?;ENU=The sales %1 %2 has item tracking. Do you want to delete it anyway?';
      Text053@1102 : TextConst 'DAN=Du skal annullere godkendelsesprocessen, hvis du vil ‘ndre %1.;ENU=You must cancel the approval process if you wish to change the %1.';
      Text055@1008 : TextConst 'DAN=Vil du udskrive forudbetalingsfakturaen %1?;ENU=Do you want to print prepayment invoice %1?';
      Text054@1010 : TextConst 'DAN=Vil du udskrive forudbetalingskreditnotaen %1?;ENU=Do you want to print prepayment credit memo %1?';
      Text056@1105 : TextConst 'DAN=Hvis dette bilag slettes, opst†r der et hul i nummerserien for forudbetalingsfakturaer. Der oprettes en tom forudbetalingsfaktura %1 for at udfylde hullet i nummerserien.\\Vil du forts‘tte?;ENU=Deleting this document will cause a gap in the number series for prepayment invoices. An empty prepayment invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text057@1108 : TextConst 'DAN=Hvis dette bilag slettes, opst†r der et hul i nummerserien for forudbetalingskreditnotaer. Der oprettes en tom forudbetalingskreditnota %1 for at udfylde hullet i nummerserien.\\Vil du forts‘tte?;ENU=Deleting this document will cause a gap in the number series for prepayment credit memos. An empty prepayment credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text061@1110 : TextConst 'DAN=%1 er konfigureret til kun at behandle emner fra %2 %3.;ENU=%1 is set up to process from %2 %3 only.';
      Text062@1072 : TextConst 'DAN=Du kan ikke ‘ndre %1, fordi tilh›rende %2 %3 er blevet tildelt dette %4.;ENU=You cannot change %1 because the corresponding %2 %3 has been assigned to this %4.';
      Text063@1077 : TextConst 'DAN=Der findes reservationer p† denne ordre. Disse reservationer annulleres, hvis der opst†r en datokonflikt som f›lge af denne ‘ndring.\\Vil du forts‘tte?;ENU=Reservations exist for this order. These reservations will be canceled if a date conflict is caused by this change.\\Do you want to continue?';
      Text064@1090 : TextConst 'DAN=Du har muligvis ‘ndret en dimension.\\Vil du opdatere linjerne?;ENU=You may have changed a dimension.\\Do you want to update the lines?';
      UpdateDocumentDate@1120 : Boolean;
      Text066@1095 : TextConst 'DAN=Du kan ikke ‘ndre %1 til %2 grundet et †bent pluk (lager) p† %3.;ENU=You cannot change %1 to %2 because an open inventory pick on the %3.';
      Text070@1096 : TextConst 'DAN=Du kan ikke ‘ndre %1 til %2, fordi der findes en †ben lagerleverance for %3.;ENU=You cannot change %1  to %2 because an open warehouse shipment exists for the %3.';
      BilltoCustomerNoChanged@1121 : Boolean;
      Text071@1011 : TextConst 'DAN=Der er ubetalte forudbetalingsfakturaer, der er knyttet til dokumentet af typen %1 med nummer %2.;ENU=There are unpaid prepayment invoices that are related to the document of type %1 with the number %2.';
      Text072@1013 : TextConst 'DAN=Der er ubetalte forudbetalingsfakturaer, der er knyttet til dokumentet af typen %1 med nummer %2.;ENU=There are unpaid prepayment invoices related to the document of type %1 with the number %2.';
      OIOXMLDocumentEncode@1101100000 : Codeunit 13600;
      Text13606@1101100002 : TextConst 'DAN=indeholder ikke et gyldigt 13-cifret EAN-nr.;ENU=does not contain a valid, 13-digit EAN No.';
      Text13607@1101100003 : TextConst 'DAN=%1 %2 underst›ttes ikke i denne version af OIOXML.;ENU=%1 %2 is not supported in this version of OIOXML.';
      SynchronizingMsg@1026 : TextConst 'DAN=Synkroniserer ...\ fra: Salgshoved med %1\ til: Montagehoved med %2.;ENU=Synchronizing ...\ from: Sales Header with %1\ to: Assembly Header with %2.';
      _Sag@1000000009 : Record 167;
      D›rskemaHoved@1000000007 : Record 50015;
      D›rskemalinie@1000000006 : Record 50016;
      UserSetup@1000000005 : Record 91;
      Glasskemahoved@1000000004 : Record 83003;
      CommentLine@1000000003 : Record 97;
      AdressCust@1000000002 : Record 18;
      MaletProfilSkemahoved@1000000001 : Record 50022;
      MaletProfilSkemalinie@1000000000 : Record 50023;
      PurchaseHeader@1000000008 : Record 38;
      PurchaseLine@1000000010 : Record 39;
      DimValue@1000000011 : Record 349;
      ShippingAdviceErr@1029 : TextConst 'DAN=Denne ordre skal v‘re en fuld leverance.;ENU=This order must be a complete shipment.';
      Cust2@1000000012 : Record 18;
      DEKO@1000000013 : Codeunit 83005;
      MySalesOrders@1000000014 : Record 50065;
      UserSetup2@1000000015 : Record 91;
      SagstypeRec@1000000016 : Record 50067;
      Job@1000000017 : Record 167;
      WarehouseActivityHeader@1000000018 : Record 5766;
      WarehouseShipmentHeader@1000000020 : Record 7320;
      ShippingAgent@1000000019 : Record 291;
      OrderCommentLine@1000000021 : Record 50085;
      Customer2@1000000022 : Record 18;

    LOCAL PROCEDURE InitInsert@61();
    BEGIN
      IF "No." = '' THEN BEGIN
        TestNoSeries;
        NoSeriesMgt.InitSeries(GetNoSeriesCode,xRec."No. Series","Posting Date","No.","No. Series");
      END;

      InitRecord;
    END;

    PROCEDURE InitRecord@10();
    BEGIN
      SalesSetup.GET;

      CASE "Document Type" OF
        "Document Type"::Quote,"Document Type"::Order:
          BEGIN
            NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Invoice Nos.");
            NoSeriesMgt.SetDefaultSeries("Shipping No. Series",SalesSetup."Posted Shipment Nos.");
            IF "Document Type" = "Document Type"::Order THEN BEGIN
              NoSeriesMgt.SetDefaultSeries("Prepayment No. Series",SalesSetup."Posted Prepmt. Inv. Nos.");
              NoSeriesMgt.SetDefaultSeries("Prepmt. Cr. Memo No. Series",SalesSetup."Posted Prepmt. Cr. Memo Nos.");
            END;
          END;
        "Document Type"::Invoice:
          BEGIN
            IF ("No. Series" <> '') AND
               (SalesSetup."Invoice Nos." = SalesSetup."Posted Invoice Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Invoice Nos.");
            IF SalesSetup."Shipment on Invoice" THEN
              NoSeriesMgt.SetDefaultSeries("Shipping No. Series",SalesSetup."Posted Shipment Nos.");
          END;
        "Document Type"::"Return Order":
          BEGIN
            NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Credit Memo Nos.");
            NoSeriesMgt.SetDefaultSeries("Return Receipt No. Series",SalesSetup."Posted Return Receipt Nos.");
          END;
        "Document Type"::"Credit Memo":
          BEGIN
            IF ("No. Series" <> '') AND
               (SalesSetup."Credit Memo Nos." = SalesSetup."Posted Credit Memo Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Credit Memo Nos.");
            IF SalesSetup."Return Receipt on Credit Memo" THEN
              NoSeriesMgt.SetDefaultSeries("Return Receipt No. Series",SalesSetup."Posted Return Receipt Nos.");
          END;
      END;

      IF "Document Type" IN ["Document Type"::Order,"Document Type"::Invoice,"Document Type"::Quote] THEN
        BEGIN
        "Shipment Date" := WORKDATE;
        "Order Date" := WORKDATE;
      END;
      IF "Document Type" = "Document Type"::"Return Order" THEN
        "Order Date" := WORKDATE;

      IF NOT ("Document Type" IN ["Document Type"::"Blanket Order","Document Type"::Quote]) AND
         ("Posting Date" = 0D)
      THEN
        "Posting Date" := WORKDATE;

      IF SalesSetup."Default Posting Date" = SalesSetup."Default Posting Date"::"No Date" THEN
        "Posting Date" := 0D;

      "Document Date" := WORKDATE;

      VALIDATE("Location Code",UserSetupMgt.GetLocation(0,Cust."Location Code","Responsibility Center"));

      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN BEGIN
        GLSetup.GET;
        Correction := GLSetup."Mark Cr. Memos as Corrections";
      END;

      "Posting Description" := FORMAT("Document Type") + ' ' + "No.";

      Reserve := Reserve::Optional;

      IF InvtSetup.GET THEN
        VALIDATE("Outbound Whse. Handling Time",InvtSetup."Outbound Whse. Handling Time");

      "Responsibility Center" := UserSetupMgt.GetRespCenter(0,"Responsibility Center");
    END;

    PROCEDURE AssistEdit@1(OldSalesHeader@1000 : Record 36) : Boolean;
    VAR
      SalesHeader2@1001 : Record 36;
    BEGIN
      WITH SalesHeader DO BEGIN
        COPY(Rec);
        SalesSetup.GET;
        TestNoSeries;
        IF NoSeriesMgt.SelectSeries(GetNoSeriesCode,OldSalesHeader."No. Series","No. Series") THEN BEGIN
          IF ("Sell-to Customer No." = '') AND ("Sell-to Contact No." = '') THEN BEGIN
            HideCreditCheckDialogue := FALSE;
            CheckCreditMaxBeforeInsert;
            HideCreditCheckDialogue := TRUE;
          END;
          NoSeriesMgt.SetSeries("No.");
          IF SalesHeader2.GET("Document Type","No.") THEN
            ERROR(Text051,LOWERCASE(FORMAT("Document Type")),"No.");
          Rec := SalesHeader;
          EXIT(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE TestNoSeries@6() : Boolean;
    BEGIN
      SalesSetup.GET;

      CASE "Document Type" OF
        "Document Type"::Quote:
          SalesSetup.TESTFIELD("Quote Nos.");
        "Document Type"::Order:
          SalesSetup.TESTFIELD("Order Nos.");
        "Document Type"::Invoice:
          BEGIN
            SalesSetup.TESTFIELD("Invoice Nos.");
            SalesSetup.TESTFIELD("Posted Invoice Nos.");
          END;
        "Document Type"::"Return Order":
          SalesSetup.TESTFIELD("Return Order Nos.");
        "Document Type"::"Credit Memo":
          BEGIN
            SalesSetup.TESTFIELD("Credit Memo Nos.");
            SalesSetup.TESTFIELD("Posted Credit Memo Nos.");
          END;
        "Document Type"::"Blanket Order":
          SalesSetup.TESTFIELD("Blanket Order Nos.");
      END;
    END;

    LOCAL PROCEDURE GetNoSeriesCode@9() : Code[10];
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          EXIT(SalesSetup."Quote Nos.");
        "Document Type"::Order:
          EXIT(SalesSetup."Order Nos.");
        "Document Type"::Invoice:
          EXIT(SalesSetup."Invoice Nos.");
        "Document Type"::"Return Order":
          EXIT(SalesSetup."Return Order Nos.");
        "Document Type"::"Credit Memo":
          EXIT(SalesSetup."Credit Memo Nos.");
        "Document Type"::"Blanket Order":
          EXIT(SalesSetup."Blanket Order Nos.");
      END;
    END;

    LOCAL PROCEDURE GetPostingNoSeriesCode@8() : Code[10];
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        EXIT(SalesSetup."Posted Credit Memo Nos.");
      EXIT(SalesSetup."Posted Invoice Nos.");
    END;

    LOCAL PROCEDURE GetPostingPrepaymentNoSeriesCode@59() : Code[10];
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        EXIT(SalesSetup."Posted Prepmt. Cr. Memo Nos.");
      EXIT(SalesSetup."Posted Prepmt. Inv. Nos.");
    END;

    LOCAL PROCEDURE TestNoSeriesDate@40(No@1000 : Code[20];NoSeriesCode@1001 : Code[10];NoCapt@1002 : Text[1024];NoSeriesCapt@1004 : Text[1024]);
    VAR
      NoSeries@1005 : Record 308;
    BEGIN
      IF (No <> '') AND (NoSeriesCode <> '') THEN BEGIN
        NoSeries.GET(NoSeriesCode);
        IF NoSeries."Date Order" THEN
          ERROR(
            Text045,
            FIELDCAPTION("Posting Date"),NoSeriesCapt,NoSeriesCode,
            NoSeries.FIELDCAPTION("Date Order"),NoSeries."Date Order","Document Type",
            NoCapt,No);
      END;
    END;

    PROCEDURE ConfirmDeletion@11() : Boolean;
    BEGIN
      SalesPost.TestDeleteHeader(
        Rec,SalesShptHeader,SalesInvHeader,SalesCrMemoHeader,ReturnRcptHeader,
        SalesInvHeaderPrepmt,SalesCrMemoHeaderPrepmt);
      IF SalesShptHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text009,TRUE,
             SalesShptHeader."No.")
        THEN
          EXIT;
      IF SalesInvHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text012,TRUE,
             SalesInvHeader."No.")
        THEN
          EXIT;
      IF SalesCrMemoHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text014,TRUE,
             SalesCrMemoHeader."No.")
        THEN
          EXIT;
      IF ReturnRcptHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text030,TRUE,
             ReturnRcptHeader."No.")
        THEN
          EXIT;
      IF "Prepayment No." <> '' THEN
        IF NOT CONFIRM(
             Text056,TRUE,
             SalesInvHeaderPrepmt."No.")
        THEN
          EXIT;
      IF "Prepmt. Cr. Memo No." <> '' THEN
        IF NOT CONFIRM(
             Text057,TRUE,
             SalesCrMemoHeaderPrepmt."No.")
        THEN
          EXIT;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE GetCust@2(CustNo@1000 : Code[20]);
    BEGIN
      IF NOT (("Document Type" = "Document Type"::Quote) AND (CustNo = '')) THEN BEGIN
        IF CustNo <> Cust."No." THEN
          Cust.GET(CustNo);
      END ELSE
        CLEAR(Cust);
    END;

    PROCEDURE SalesLinesExist@3() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      EXIT(SalesLine.FINDFIRST);
    END;

    PROCEDURE RecreateSalesLines@4(ChangedFieldName@1000 : Text[100]);
    VAR
      SalesLineTmp@1001 : TEMPORARY Record 37;
      ItemChargeAssgntSales@1004 : Record 5809;
      TempItemChargeAssgntSales@1003 : TEMPORARY Record 5809;
      TempInteger@1006 : TEMPORARY Record 2000000026;
      TempATOLink@1009 : TEMPORARY Record 904;
      ATOLink@1010 : Record 904;
      ExtendedTextAdded@1002 : Boolean;
    BEGIN
      IF SalesLinesExist THEN BEGIN
        IF HideValidationDialog OR NOT GUIALLOWED THEN
          Confirmed := TRUE
        ELSE
          Confirmed :=
            CONFIRM(
              Text015,FALSE,ChangedFieldName);
        IF Confirmed THEN BEGIN
          SalesLine.LOCKTABLE;
          ItemChargeAssgntSales.LOCKTABLE;
          ReservEntry.LOCKTABLE;
          MODIFY;

          SalesLine.RESET;
          SalesLine.SETRANGE("Document Type","Document Type");
          SalesLine.SETRANGE("Document No.","No.");
          IF SalesLine.FINDSET THEN BEGIN
            TempReservEntry.DELETEALL;
            REPEAT
              SalesLine.TESTFIELD("Job No.",'');
              SalesLine.TESTFIELD("Job Contract Entry No.",0);
              SalesLine.TESTFIELD("Quantity Shipped",0);
              SalesLine.TESTFIELD("Quantity Invoiced",0);
              SalesLine.TESTFIELD("Return Qty. Received",0);
              SalesLine.TESTFIELD("Shipment No.",'');
              SalesLine.TESTFIELD("Return Receipt No.",'');
              SalesLine.TESTFIELD("Blanket Order No.",'');
              SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
              IF (SalesLine."Location Code" <> "Location Code") AND NOT SalesLine.IsServiceItem THEN
                SalesLine.VALIDATE("Location Code","Location Code");
              SalesLineTmp := SalesLine;
              IF SalesLine.Nonstock THEN BEGIN
                SalesLine.Nonstock := FALSE;
                SalesLine.MODIFY;
              END;

              IF ATOLink.AsmExistsForSalesLine(SalesLineTmp) THEN BEGIN
                TempATOLink := ATOLink;
                TempATOLink.INSERT;
                ATOLink.DELETE;
              END;

              SalesLineTmp.INSERT;
              RecreateReservEntry(SalesLine,0,TRUE);
              RecreateReqLine(SalesLine,0,TRUE);
            UNTIL SalesLine.NEXT = 0;

            ItemChargeAssgntSales.SETRANGE("Document Type","Document Type");
            ItemChargeAssgntSales.SETRANGE("Document No.","No.");
            IF ItemChargeAssgntSales.FINDSET THEN BEGIN
              REPEAT
                TempItemChargeAssgntSales.INIT;
                TempItemChargeAssgntSales := ItemChargeAssgntSales;
                TempItemChargeAssgntSales.INSERT;
              UNTIL ItemChargeAssgntSales.NEXT = 0;
              ItemChargeAssgntSales.DELETEALL;
            END;

            SalesLine.DELETEALL(TRUE);
            SalesLine.INIT;
            SalesLine."Line No." := 0;
            SalesLineTmp.FINDSET;
            ExtendedTextAdded := FALSE;
            SalesLine.BlockDynamicTracking(TRUE);
            REPEAT
              IF SalesLineTmp."Attached to Line No." = 0 THEN BEGIN
                SalesLine.INIT;
                SalesLine."Line No." := SalesLine."Line No." + 10000;
                SalesLine.VALIDATE(Type,SalesLineTmp.Type);
                IF SalesLineTmp."No." = '' THEN BEGIN
                  SalesLine.VALIDATE(Description,SalesLineTmp.Description);
                  SalesLine.VALIDATE("Description 2",SalesLineTmp."Description 2");
                END ELSE BEGIN
                  SalesLine.VALIDATE("No.",SalesLineTmp."No.");
                  IF SalesLine.Type <> SalesLine.Type::" " THEN BEGIN
                    SalesLine.VALIDATE("Unit of Measure Code",SalesLineTmp."Unit of Measure Code");
                    SalesLine.VALIDATE("Variant Code",SalesLineTmp."Variant Code");
                    IF SalesLineTmp.Quantity <> 0 THEN BEGIN
                      SalesLine.VALIDATE(Quantity,SalesLineTmp.Quantity);
                      SalesLine.VALIDATE("Qty. to Assemble to Order",SalesLineTmp."Qty. to Assemble to Order");
                    END;
                    SalesLine."Purchase Order No." := SalesLineTmp."Purchase Order No.";
                    SalesLine."Purch. Order Line No." := SalesLineTmp."Purch. Order Line No.";
                    SalesLine."Drop Shipment" := SalesLine."Purch. Order Line No." <> 0;
                  END;
                END;

                //>>SYS
                IF "Document Type" IN ["Document Type"::Order,"Document Type"::"Return Order"] THEN BEGIN
                  IF Job.GET("Job No.") THEN
                    IF Job.Sagstype = Job.Sagstype::Entreprise THEN
                      SalesLine.VALIDATE("Unit Price",0);
                  IF Customer2.GET("Bill-to Customer No.") THEN BEGIN
                    IF Customer2.Intern = TRUE THEN
                      SalesLine.VALIDATE("Unit Price",0);
                  END;
                END;
                //<<SYS

                SalesLine.INSERT;
                ExtendedTextAdded := FALSE;

                IF SalesLine.Type = SalesLine.Type::Item THEN BEGIN
                  ClearItemAssgntSalesFilter(TempItemChargeAssgntSales);
                  TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Type",SalesLineTmp."Document Type");
                  TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. No.",SalesLineTmp."Document No.");
                  TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Line No.",SalesLineTmp."Line No.");
                  IF TempItemChargeAssgntSales.FINDSET THEN
                    REPEAT
                      IF NOT TempItemChargeAssgntSales.MARK THEN BEGIN
                        TempItemChargeAssgntSales."Applies-to Doc. Line No." := SalesLine."Line No.";
                        TempItemChargeAssgntSales.Description := SalesLine.Description;
                        TempItemChargeAssgntSales.MODIFY;
                        TempItemChargeAssgntSales.MARK(TRUE);
                      END;
                    UNTIL TempItemChargeAssgntSales.NEXT = 0;
                END;
                IF SalesLine.Type = SalesLine.Type::"Charge (Item)" THEN BEGIN
                  TempInteger.INIT;
                  TempInteger.Number := SalesLine."Line No.";
                  TempInteger.INSERT;
                END;
              END ELSE
                IF NOT ExtendedTextAdded THEN BEGIN
                  TransferExtendedText.SalesCheckIfAnyExtText(SalesLine,TRUE);
                  TransferExtendedText.InsertSalesExtText(SalesLine);
                  SalesLine.FINDLAST;
                  ExtendedTextAdded := TRUE;
                END;
              RecreateReservEntry(SalesLineTmp,SalesLine."Line No.",FALSE);
              RecreateReqLine(SalesLineTmp,SalesLine."Line No.",FALSE);
              SynchronizeForReservations(SalesLine,SalesLineTmp);

              IF TempATOLink.AsmExistsForSalesLine(SalesLineTmp) THEN BEGIN
                ATOLink := TempATOLink;
                ATOLink.INSERT;
                SalesLine.AutoAsmToOrder;
                TempATOLink.DELETE;
              END;
            UNTIL SalesLineTmp.NEXT = 0;

            ClearItemAssgntSalesFilter(TempItemChargeAssgntSales);
            SalesLineTmp.SETRANGE(Type,SalesLine.Type::"Charge (Item)");
            IF SalesLineTmp.FINDSET THEN
              REPEAT
                TempItemChargeAssgntSales.SETRANGE("Document Line No.",SalesLineTmp."Line No.");
                IF TempItemChargeAssgntSales.FINDSET THEN BEGIN
                  REPEAT
                    TempInteger.FINDFIRST;
                    ItemChargeAssgntSales.INIT;
                    ItemChargeAssgntSales := TempItemChargeAssgntSales;
                    ItemChargeAssgntSales."Document Line No." := TempInteger.Number;
                    ItemChargeAssgntSales.VALIDATE("Unit Cost",0);
                    ItemChargeAssgntSales.INSERT;
                  UNTIL TempItemChargeAssgntSales.NEXT = 0;
                  TempInteger.DELETE;
                END;
              UNTIL SalesLineTmp.NEXT = 0;

            SalesLineTmp.SETRANGE(Type);
            SalesLineTmp.DELETEALL;
            ClearItemAssgntSalesFilter(TempItemChargeAssgntSales);
            TempItemChargeAssgntSales.DELETEALL;
          END;
        END ELSE
          ERROR(
            Text017,ChangedFieldName);
      END;
      SalesLine.BlockDynamicTracking(FALSE);
    END;

    PROCEDURE MessageIfSalesLinesExist@5(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF SalesLinesExist AND NOT HideValidationDialog THEN
        MESSAGE(
          Text018 +
          Text019,
          ChangedFieldName);
    END;

    PROCEDURE PriceMessageIfSalesLinesExist@7(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF SalesLinesExist AND NOT HideValidationDialog THEN
        MESSAGE(
          Text018 +
          Text020,ChangedFieldName);
    END;

    LOCAL PROCEDURE UpdateCurrencyFactor@12();
    BEGIN
      IF "Currency Code" <> '' THEN BEGIN
        IF "Posting Date" <> 0D THEN
          CurrencyDate := "Posting Date"
        ELSE
          CurrencyDate := WORKDATE;

        "Currency Factor" := CurrExchRate.ExchangeRate(CurrencyDate,"Currency Code");
      END ELSE
        "Currency Factor" := 0;
    END;

    LOCAL PROCEDURE ConfirmUpdateCurrencyFactor@13();
    BEGIN
      IF HideValidationDialog THEN
        Confirmed := TRUE
      ELSE
        Confirmed := CONFIRM(Text021,FALSE);
      IF Confirmed THEN
        VALIDATE("Currency Factor")
      ELSE
        "Currency Factor" := xRec."Currency Factor";
    END;

    PROCEDURE SetHideValidationDialog@14(NewHideValidationDialog@1000 : Boolean);
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    PROCEDURE UpdateSalesLines@15(ChangedFieldName@1000 : Text[100];AskQuestion@1001 : Boolean);
    VAR
      JobTransferLine@1004 : Codeunit 1004;
      Question@1002 : Text[250];
    BEGIN
      IF NOT SalesLinesExist THEN
        EXIT;

      IF AskQuestion THEN BEGIN
        Question := STRSUBSTNO(
            Text031 +
            Text032,ChangedFieldName);
        IF GUIALLOWED THEN
          IF DIALOG.CONFIRM(Question,TRUE) THEN
            CASE ChangedFieldName OF
              FIELDCAPTION("Shipment Date"),
              FIELDCAPTION("Shipping Agent Code"),
              FIELDCAPTION("Shipping Agent Service Code"),
              FIELDCAPTION("Shipping Time"),
              FIELDCAPTION("Requested Delivery Date"),
              FIELDCAPTION("Promised Delivery Date"),
              FIELDCAPTION("Outbound Whse. Handling Time"):
                ConfirmResvDateConflict;
            END
          ELSE
            EXIT;
      END;

      SalesLine.LOCKTABLE;
      MODIFY;

      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      IF SalesLine.FINDSET THEN
        REPEAT
          CASE ChangedFieldName OF
            FIELDCAPTION("Shipment Date"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Shipment Date","Shipment Date");
            FIELDCAPTION("Currency Factor"):
              IF SalesLine.Type <> SalesLine.Type::" " THEN BEGIN
                SalesLine.VALIDATE("Unit Price");
                SalesLine.VALIDATE("Unit Cost (LCY)");
                IF SalesLine."Job No." <> '' THEN
                  JobTransferLine.FromSalesHeaderToPlanningLine(SalesLine,"Currency Factor");
              END;
            FIELDCAPTION("Transaction Type"):
              SalesLine.VALIDATE("Transaction Type","Transaction Type");
            FIELDCAPTION("Transport Method"):
              SalesLine.VALIDATE("Transport Method","Transport Method");
            FIELDCAPTION("Exit Point"):
              SalesLine.VALIDATE("Exit Point","Exit Point");
            FIELDCAPTION(Area):
              SalesLine.VALIDATE(Area,Area);
            FIELDCAPTION("Transaction Specification"):
              SalesLine.VALIDATE("Transaction Specification","Transaction Specification");
            FIELDCAPTION("Shipping Agent Code"):
              SalesLine.VALIDATE("Shipping Agent Code","Shipping Agent Code");
            FIELDCAPTION("Shipping Agent Service Code"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Shipping Agent Service Code","Shipping Agent Service Code");
            FIELDCAPTION("Shipping Time"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Shipping Time","Shipping Time");
            FIELDCAPTION("Prepayment %"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Prepayment %","Prepayment %");
            FIELDCAPTION("Requested Delivery Date"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Requested Delivery Date","Requested Delivery Date");
            FIELDCAPTION("Promised Delivery Date"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Promised Delivery Date","Promised Delivery Date");
            FIELDCAPTION("Outbound Whse. Handling Time"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Outbound Whse. Handling Time","Outbound Whse. Handling Time");
          END;
          SalesLineReserve.AssignForPlanning(SalesLine);
          SalesLine.MODIFY(TRUE);
        UNTIL SalesLine.NEXT = 0;
    END;

    PROCEDURE ConfirmResvDateConflict@41();
    VAR
      ResvEngMgt@1000 : Codeunit 99000831;
    BEGIN
      IF ResvEngMgt.ResvExistsForSalesHeader(Rec) THEN
        IF NOT CONFIRM(Text063,FALSE) THEN
          ERROR('');
    END;

    PROCEDURE CreateDim@16(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1002 : Integer;No2@1003 : Code[20];Type3@1004 : Integer;No3@1005 : Code[20];Type4@1006 : Integer;No4@1007 : Code[20];Type5@1008 : Integer;No5@1009 : Code[20]);
    VAR
      SourceCodeSetup@1010 : Record 242;
      TableID@1011 : ARRAY [10] OF Integer;
      No@1012 : ARRAY [10] OF Code[20];
      OldDimSetID@1013 : Integer;
    BEGIN
      SourceCodeSetup.GET;
      TableID[1] := Type1;
      No[1] := No1;
      TableID[2] := Type2;
      No[2] := No2;
      TableID[3] := Type3;
      No[3] := No3;
      TableID[4] := Type4;
      No[4] := No4;
      TableID[5] := Type5;
      No[5] := No5;
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.GetDefaultDimID(TableID,No,SourceCodeSetup.Sales,"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",0,0);

      IF (OldDimSetID <> "Dimension Set ID") AND SalesLinesExist THEN BEGIN
        MODIFY;
        UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@19(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      OldDimSetID@1005 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
      IF "No." <> '' THEN
        MODIFY;

      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF SalesLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    PROCEDURE ShippedSalesLinesExist@22() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Quantity Shipped",'<>0');
      EXIT(SalesLine.FINDFIRST);
    END;

    PROCEDURE ReturnReceiptExist@5800() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Return Qty. Received",'<>0');
      EXIT(SalesLine.FINDFIRST);
    END;

    LOCAL PROCEDURE DeleteSalesLines@20();
    BEGIN
      IF SalesLine.FINDSET THEN BEGIN
        HandleItemTrackingDeletion;
        REPEAT
          SalesLine.SuspendStatusCheck(TRUE);
          SalesLine.DELETE(TRUE);
        UNTIL SalesLine.NEXT = 0;
      END;
    END;

    PROCEDURE HandleItemTrackingDeletion@36();
    VAR
      ReservEntry2@1000 : Record 337;
    BEGIN
      WITH ReservEntry DO BEGIN
        RESET;
        SETCURRENTKEY(
          "Source ID","Source Ref. No.","Source Type","Source Subtype",
          "Source Batch Name","Source Prod. Order Line","Reservation Status");
        SETRANGE("Source Type",DATABASE::"Sales Line");
        SETRANGE("Source Subtype","Document Type");
        SETRANGE("Source ID","No.");
        SETRANGE("Source Batch Name",'');
        SETRANGE("Source Prod. Order Line",0);
        SETFILTER("Item Tracking",'> %1',"Item Tracking"::None);
        IF ISEMPTY THEN
          EXIT;

        IF HideValidationDialog OR NOT GUIALLOWED THEN
          Confirmed := TRUE
        ELSE
          Confirmed := CONFIRM(Text052,FALSE,LOWERCASE(FORMAT("Document Type")),"No.");

        IF NOT Confirmed THEN
          ERROR('');

        IF FINDSET THEN
          REPEAT
            ReservEntry2 := ReservEntry;
            ReservEntry2.ClearItemTrackingFields;
            ReservEntry2.MODIFY;
          UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ClearItemAssgntSalesFilter@17(VAR TempItemChargeAssgntSales@1000 : Record 5809);
    BEGIN
      TempItemChargeAssgntSales.SETRANGE("Document Line No.");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Type");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. No.");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Line No.");
    END;

    PROCEDURE CheckCustomerCreated@18(Prompt@1000 : Boolean) : Boolean;
    VAR
      Cont@1001 : Record 5050;
    BEGIN
      IF ("Bill-to Customer No." <> '') AND ("Sell-to Customer No." <> '') THEN
        EXIT(TRUE);

      IF Prompt THEN
        IF NOT CONFIRM(Text035,TRUE) THEN
          EXIT(FALSE);

      IF "Sell-to Customer No." = '' THEN BEGIN
        TESTFIELD("Sell-to Contact No.");
        TESTFIELD("Sell-to Customer Template Code");
        Cont.GET("Sell-to Contact No.");
        Cont.CreateCustomer("Sell-to Customer Template Code");
        COMMIT;
        GET("Document Type"::Quote,"No.");
      END;

      IF "Bill-to Customer No." = '' THEN BEGIN
        TESTFIELD("Bill-to Contact No.");
        TESTFIELD("Bill-to Customer Template Code");
        Cont.GET("Bill-to Contact No.");
        Cont.CreateCustomer("Bill-to Customer Template Code");
        COMMIT;
        GET("Document Type"::Quote,"No.");
      END;

      EXIT(("Bill-to Customer No." <> '') AND ("Sell-to Customer No." <> ''));
    END;

    PROCEDURE RecreateReservEntry@21(OldSalesLine@1000 : Record 37;NewSourceRefNo@1001 : Integer;ToTemp@1002 : Boolean);
    BEGIN
      IF ToTemp THEN BEGIN
        CLEAR(ReservEntry);
        ReservEntry.SETCURRENTKEY("Source ID","Source Ref. No.","Source Type","Source Subtype");
        ReservEntry.SETRANGE("Source ID",OldSalesLine."Document No.");
        ReservEntry.SETRANGE("Source Ref. No.",OldSalesLine."Line No.");
        ReservEntry.SETRANGE("Source Type",DATABASE::"Sales Line");
        ReservEntry.SETRANGE("Source Subtype",OldSalesLine."Document Type");
        IF ReservEntry.FINDSET THEN
          REPEAT
            TempReservEntry := ReservEntry;
            TempReservEntry.INSERT;
          UNTIL ReservEntry.NEXT = 0;
        ReservEntry.DELETEALL;
      END ELSE BEGIN
        CLEAR(TempReservEntry);
        TempReservEntry.SETCURRENTKEY("Source ID","Source Ref. No.","Source Type","Source Subtype");
        TempReservEntry.SETRANGE("Source Type",DATABASE::"Sales Line");
        TempReservEntry.SETRANGE("Source Subtype",OldSalesLine."Document Type");
        TempReservEntry.SETRANGE("Source ID",OldSalesLine."Document No.");
        TempReservEntry.SETRANGE("Source Ref. No.",OldSalesLine."Line No.");
        IF TempReservEntry.FINDSET THEN
          REPEAT
            ReservEntry := TempReservEntry;
            ReservEntry."Source Ref. No." := NewSourceRefNo;
            ReservEntry.INSERT;
          UNTIL TempReservEntry.NEXT = 0;
        TempReservEntry.DELETEALL;
      END;
    END;

    PROCEDURE RecreateReqLine@33(OldSalesLine@1000 : Record 37;NewSourceRefNo@1001 : Integer;ToTemp@1002 : Boolean);
    VAR
      ReqLine@1003 : Record 246;
    BEGIN
      IF ToTemp THEN BEGIN
        ReqLine.SETCURRENTKEY("Order Promising ID","Order Promising Line ID","Order Promising Line No.");
        ReqLine.SETRANGE("Order Promising ID",OldSalesLine."Document No.");
        ReqLine.SETRANGE("Order Promising Line ID",OldSalesLine."Line No.");
        IF ReqLine.FINDSET THEN
          REPEAT
            TempReqLine := ReqLine;
            TempReqLine.INSERT;
          UNTIL ReqLine.NEXT = 0;
        ReqLine.DELETEALL;
      END ELSE BEGIN
        CLEAR(TempReqLine);
        TempReqLine.SETCURRENTKEY("Order Promising ID","Order Promising Line ID","Order Promising Line No.");
        TempReqLine.SETRANGE("Order Promising ID",OldSalesLine."Document No.");
        TempReqLine.SETRANGE("Order Promising Line ID",OldSalesLine."Line No.");
        IF TempReqLine.FINDSET THEN
          REPEAT
            ReqLine := TempReqLine;
            ReqLine."Order Promising Line ID" := NewSourceRefNo;
            ReqLine.INSERT;
          UNTIL TempReqLine.NEXT = 0;
        TempReqLine.DELETEALL;
      END;
    END;

    PROCEDURE UpdateSellToCont@24(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cust@1004 : Record 18;
    BEGIN
      IF Cust.GET(CustomerNo) THEN BEGIN
        IF Cust."Primary Contact No." <> '' THEN BEGIN
          // "Sell-to Contact No." := Cust."Primary Contact No."
          VALIDATE("Sell-to Contact No.",Cust."Primary Contact No.");
          EXIT;
        END;
        ContBusRel.RESET;
        ContBusRel.SETCURRENTKEY("Link to Table","No.");
        ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
        ContBusRel.SETRANGE("No.","Sell-to Customer No.");
        IF ContBusRel.FINDFIRST THEN BEGIN
          // "Sell-to Contact No." := ContBusRel."Contact No.";
          VALIDATE("Sell-to Contact No.",ContBusRel."Contact No.");
          EXIT;
        END;
        VALIDATE("Sell-to Contact No.",'');

        "Sell-to Contact" := Cust.Contact;
        "Sell-to Contact Phone No." := Cust."Phone No.";
        "Sell-to Contact Fax No." := Cust."Fax No.";
        "Sell-to Contact E-Mail" := Cust."E-Mail";
        "Sell-to Contact Role" := "Sell-to Contact Role"::" ";
      END;
    END;

    PROCEDURE UpdateBillToCont@27(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cust@1001 : Record 18;
    BEGIN
      IF Cust.GET(CustomerNo) THEN BEGIN
        IF Cust."Primary Contact No." <> '' THEN
          "Bill-to Contact No." := Cust."Primary Contact No."
        ELSE BEGIN
          ContBusRel.RESET;
          ContBusRel.SETCURRENTKEY("Link to Table","No.");
          ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
          ContBusRel.SETRANGE("No.","Bill-to Customer No.");
          IF ContBusRel.FINDFIRST THEN
            "Bill-to Contact No." := ContBusRel."Contact No."
          ELSE
            "Bill-to Contact No." := '';
        END;
        "Bill-to Contact" := Cust.Contact;
      END;
    END;

    PROCEDURE UpdateSellToCust@25(ContactNo@1002 : Code[20]);
    VAR
      ContBusinessRelation@1007 : Record 5054;
      Customer@1006 : Record 18;
      Cont@1005 : Record 5050;
      CustTemplate@1004 : Record 5105;
      ContComp@1003 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Sell-to Contact No." := Cont."No.";
        IF Cont.Type = Cont.Type::Person THEN
          GetselltoCust(Cont.Name,Cont."Phone No.",Cont."Fax No.",Cont."E-Mail")
        ELSE
          IF Customer.GET("Sell-to Customer No.") THEN
            GetselltoCust(Customer.Name,Customer."Phone No.",Customer."Fax No.",Customer."E-Mail")
          ELSE
            ClearSellToCust;
      END ELSE BEGIN
        ClearSellToCust;
        EXIT;
      END;

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF ("Sell-to Customer No." <> '') AND
           ("Sell-to Customer No." <> ContBusinessRelation."No.")
        THEN
          ERROR(Text037,Cont."No.",Cont.Name,"Sell-to Customer No.");
        IF "Sell-to Customer No." = '' THEN BEGIN
          SkipSellToContact := TRUE;
          VALIDATE("Sell-to Customer No.",ContBusinessRelation."No.");
          SkipSellToContact := FALSE;
        END;
      END ELSE BEGIN
        IF "Document Type" = "Document Type"::Quote THEN BEGIN
          Cont.TESTFIELD("Company No.");
          ContComp.GET(Cont."Company No.");
          "Sell-to Customer Name" := ContComp."Company Name";
          "Sell-to Customer Name 2" := ContComp."Name 2";
          "Ship-to Name" := ContComp."Company Name";
          "Ship-to Name 2" := ContComp."Name 2";
          "Ship-to Address" := ContComp.Address;
          "Ship-to Address 2" := ContComp."Address 2";
          "Ship-to City" := ContComp.City;
          "Ship-to Post Code" := ContComp."Post Code";
          "Ship-to County" := ContComp.County;
          VALIDATE("Ship-to Country/Region Code",ContComp."Country/Region Code");
          IF ("Sell-to Customer Template Code" = '') AND (NOT CustTemplate.ISEMPTY) THEN
            VALIDATE("Sell-to Customer Template Code",Cont.FindCustomerTemplate);
        END ELSE
          ERROR(Text039,Cont."No.",Cont.Name);
      END;

      IF Cont.Type = Cont.Type::Person THEN
        "Sell-to Contact" := Cont.Name
      ELSE
        IF Customer.GET("Sell-to Customer No.") THEN
          "Sell-to Contact" := Customer.Contact
        ELSE
          "Sell-to Contact" := '';

      IF "Document Type" = "Document Type"::Quote THEN BEGIN
        IF Customer.GET("Sell-to Customer No.") OR Customer.GET(ContBusinessRelation."No.") THEN BEGIN
          IF Customer."Copy Sell-to Addr. to Qte From" = Customer."Copy Sell-to Addr. to Qte From"::Company THEN BEGIN
            Cont.TESTFIELD("Company No.");
            Cont.GET(Cont."Company No.");
          END;
        END ELSE BEGIN
          Cont.TESTFIELD("Company No.");
          Cont.GET(Cont."Company No.");
        END;
        "Sell-to Address" := Cont.Address;
        "Sell-to Address 2" := Cont."Address 2";
        "Sell-to City" := Cont.City;
        "Sell-to Post Code" := Cont."Post Code";
        "Sell-to County" := Cont.County;
        "Sell-to Country/Region Code" := Cont."Country/Region Code";
      END;
      IF ("Sell-to Customer No." = "Bill-to Customer No.") OR
         ("Bill-to Customer No." = '')
      THEN
        VALIDATE("Bill-to Contact No.","Sell-to Contact No.");
    END;

    PROCEDURE UpdateBillToCust@26(ContactNo@1000 : Code[20]);
    VAR
      ContBusinessRelation@1005 : Record 5054;
      Cust@1004 : Record 18;
      Cont@1003 : Record 5050;
      CustTemplate@1002 : Record 5105;
      ContComp@1001 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Bill-to Contact No." := Cont."No.";
        IF Cont.Type = Cont.Type::Person THEN
          "Bill-to Contact" := Cont.Name
        ELSE
          IF Cust.GET("Bill-to Customer No.") THEN
            "Bill-to Contact" := Cust.Contact
          ELSE
            "Bill-to Contact" := '';
      END ELSE BEGIN
        "Bill-to Contact" := '';
        EXIT;
      END;

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF "Bill-to Customer No." = '' THEN BEGIN
          SkipBillToContact := TRUE;
          VALIDATE("Bill-to Customer No.",ContBusinessRelation."No.");
          SkipBillToContact := FALSE;
          "Bill-to Customer Template Code" := '';
        END ELSE
          IF "Bill-to Customer No." <> ContBusinessRelation."No." THEN
            ERROR(Text037,Cont."No.",Cont.Name,"Bill-to Customer No.");
      END ELSE BEGIN
        IF "Document Type" = "Document Type"::Quote THEN BEGIN
          Cont.TESTFIELD("Company No.");
          ContComp.GET(Cont."Company No.");
          "Bill-to Name" := ContComp."Company Name";
          "Bill-to Name 2" := ContComp."Name 2";
          "Bill-to Address" := ContComp.Address;
          "Bill-to Address 2" := ContComp."Address 2";
          "Bill-to City" := ContComp.City;
          "Bill-to Post Code" := ContComp."Post Code";
          "Bill-to County" := ContComp.County;
          "Bill-to Country/Region Code" := ContComp."Country/Region Code";
          "VAT Registration No." := ContComp."VAT Registration No.";
          VALIDATE("Currency Code",ContComp."Currency Code");
          "Language Code" := ContComp."Language Code";
          IF ("Bill-to Customer Template Code" = '') AND (NOT CustTemplate.ISEMPTY) THEN
            VALIDATE("Bill-to Customer Template Code",Cont.FindCustomerTemplate);
        END ELSE
          ERROR(Text039,Cont."No.",Cont.Name);
      END;
    END;

    PROCEDURE GetShippingTime@23(CalledByFieldNo@1000 : Integer);
    BEGIN
      IF (CalledByFieldNo <> CurrFieldNo) AND (CurrFieldNo <> 0) THEN
        EXIT;

      IF ShippingAgentService.GET("Shipping Agent Code","Shipping Agent Service Code") THEN
        "Shipping Time" := ShippingAgentService."Shipping Time"
      ELSE BEGIN
        GetCust("Sell-to Customer No.");
        "Shipping Time" := Cust."Shipping Time"
      END;
      IF NOT (CalledByFieldNo IN [FIELDNO("Shipping Agent Code"),FIELDNO("Shipping Agent Service Code")]) THEN
        VALIDATE("Shipping Time");
    END;

    PROCEDURE CheckCreditMaxBeforeInsert@28();
    VAR
      SalesHeader@1001 : Record 36;
      ContBusinessRelation@1002 : Record 5054;
      Cont@1003 : Record 5050;
      CustCheckCreditLimit@1000 : Codeunit 312;
    BEGIN
      IF HideCreditCheckDialogue THEN
        EXIT;
      IF (GetFilterCustNo <> '') OR ("Sell-to Customer No." <> '') THEN BEGIN
        IF "Sell-to Customer No." <> '' THEN
          Cust.GET("Sell-to Customer No.")
        ELSE
          Cust.GET(GetFilterCustNo);
        IF Cust."Bill-to Customer No." <> '' THEN
          SalesHeader."Bill-to Customer No." := Cust."Bill-to Customer No."
        ELSE
          SalesHeader."Bill-to Customer No." := Cust."No.";
        CustCheckCreditLimit.SalesHeaderCheck(SalesHeader);
      END ELSE
        IF GetFilterContNo <> '' THEN BEGIN
          Cont.GET(GetFilterContNo);
          ContBusinessRelation.RESET;
          ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
          ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
          ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
          IF ContBusinessRelation.FINDFIRST THEN BEGIN
            Cust.GET(ContBusinessRelation."No.");
            IF Cust."Bill-to Customer No." <> '' THEN
              SalesHeader."Bill-to Customer No." := Cust."Bill-to Customer No."
            ELSE
              SalesHeader."Bill-to Customer No." := Cust."No.";
            CustCheckCreditLimit.SalesHeaderCheck(SalesHeader);
          END;
        END;
    END;

    PROCEDURE CreateInvtPutAwayPick@29();
    VAR
      WhseRequest@1000 : Record 5765;
    BEGIN
      TESTFIELD(Status,Status::Released);

      WhseRequest.RESET;
      WhseRequest.SETCURRENTKEY("Source Document","Source No.");
      CASE "Document Type" OF
        "Document Type"::Order:
          BEGIN
            IF "Shipping Advice" = "Shipping Advice"::Complete THEN
              CheckShippingAdvice;
            WhseRequest.SETRANGE("Source Document",WhseRequest."Source Document"::"Sales Order");
          END;
        "Document Type"::"Return Order":
          WhseRequest.SETRANGE("Source Document",WhseRequest."Source Document"::"Sales Return Order");
      END;
      WhseRequest.SETRANGE("Source No.","No.");
      REPORT.RUNMODAL(REPORT::"Create Invt Put-away/Pick/Mvmt",TRUE,FALSE,WhseRequest);
    END;

    PROCEDURE CreateTodo@30();
    VAR
      TempTodo@1000 : TEMPORARY Record 5080;
    BEGIN
      TESTFIELD("Sell-to Contact No.");
      TempTodo.CreateToDoFromSalesHeader(Rec);
    END;

    LOCAL PROCEDURE UpdateShipToAddress@31();
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN BEGIN
        IF "Location Code" <> '' THEN BEGIN
          Location.GET("Location Code");
          "Ship-to Name" := Location.Name;
          "Ship-to Name 2" := Location."Name 2";
          "Ship-to Address" := Location.Address;
          "Ship-to Address 2" := Location."Address 2";
          "Ship-to City" := Location.City;
          "Ship-to Post Code" := Location."Post Code";
          "Ship-to County" := Location.County;
          "Ship-to Country/Region Code" := Location."Country/Region Code";
          "Ship-to Contact" := Location.Contact;
        END ELSE BEGIN
          CompanyInfo.GET;
          "Ship-to Code" := '';
          "Ship-to Name" := CompanyInfo."Ship-to Name";
          "Ship-to Name 2" := CompanyInfo."Ship-to Name 2";
          "Ship-to Address" := CompanyInfo."Ship-to Address";
          "Ship-to Address 2" := CompanyInfo."Ship-to Address 2";
          "Ship-to City" := CompanyInfo."Ship-to City";
          "Ship-to Post Code" := CompanyInfo."Ship-to Post Code";
          "Ship-to County" := CompanyInfo."Ship-to County";
          "Ship-to Country/Region Code" := CompanyInfo."Ship-to Country/Region Code";
          "Ship-to Contact" := CompanyInfo."Ship-to Contact";
        END;
      END;
    END;

    PROCEDURE ShowDocDim@32();
    VAR
      OldDimSetID@1000 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2',"Document Type","No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF SalesLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE UpdateAllLineDim@34(NewParentDimSetID@1000 : Integer;OldParentDimSetID@1001 : Integer);
    VAR
      ATOLink@1003 : Record 904;
      NewDimSetID@1002 : Integer;
    BEGIN
      // Update all lines with changed dimensions.

      IF NewParentDimSetID = OldParentDimSetID THEN
        EXIT;
      IF NOT HideValidationDialog AND GUIALLOWED THEN
        IF NOT CONFIRM(Text064) THEN
          EXIT;

      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.LOCKTABLE;
      IF SalesLine.FIND('-') THEN
        REPEAT
          NewDimSetID := DimMgt.GetDeltaDimSetID(SalesLine."Dimension Set ID",NewParentDimSetID,OldParentDimSetID);
          IF SalesLine."Dimension Set ID" <> NewDimSetID THEN BEGIN
            SalesLine."Dimension Set ID" := NewDimSetID;
            DimMgt.UpdateGlobalDimFromDimSetID(
              SalesLine."Dimension Set ID",SalesLine."Shortcut Dimension 1 Code",SalesLine."Shortcut Dimension 2 Code");
            SalesLine.MODIFY;
            ATOLink.UpdateAsmDimFromSalesLine(SalesLine);
          END;
        UNTIL SalesLine.NEXT = 0;
    END;

    PROCEDURE SetAmountToApply@35(AppliesToDocNo@1000 : Code[20];CustomerNo@1001 : Code[20]);
    VAR
      CustLedgEntry@1002 : Record 21;
    BEGIN
      CustLedgEntry.SETCURRENTKEY("Document No.");
      CustLedgEntry.SETRANGE("Document No.",AppliesToDocNo);
      CustLedgEntry.SETRANGE("Customer No.",CustomerNo);
      CustLedgEntry.SETRANGE(Open,TRUE);
      IF CustLedgEntry.FINDFIRST THEN BEGIN
        IF CustLedgEntry."Amount to Apply" = 0 THEN  BEGIN
          CustLedgEntry.CALCFIELDS("Remaining Amount");
          CustLedgEntry."Amount to Apply" := CustLedgEntry."Remaining Amount";
        END ELSE
          CustLedgEntry."Amount to Apply" := 0;
        CustLedgEntry."Accepted Payment Tolerance" := 0;
        CustLedgEntry."Accepted Pmt. Disc. Tolerance" := FALSE;
        CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",CustLedgEntry);
      END;
    END;

    PROCEDURE LookupAdjmtValueEntries@37(QtyType@1000 : 'General,Invoicing');
    VAR
      ItemLedgEntry@1004 : Record 32;
      SalesLine@1001 : Record 37;
      SalesShptLine@1005 : Record 111;
      ReturnRcptLine@1002 : Record 6661;
      TempValueEntry@1003 : TEMPORARY Record 5802;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      TempValueEntry.RESET;
      TempValueEntry.DELETEALL;

      CASE "Document Type" OF
        "Document Type"::Order,"Document Type"::Invoice:
          BEGIN
            IF SalesLine.FINDSET THEN
              REPEAT
                IF (SalesLine.Type = SalesLine.Type::Item) AND (SalesLine.Quantity <> 0) THEN
                  WITH SalesShptLine DO BEGIN
                    IF SalesLine."Shipment No." <> '' THEN BEGIN
                      SETRANGE("Document No.",SalesLine."Shipment No.");
                      SETRANGE("Line No.",SalesLine."Shipment Line No.");
                    END ELSE BEGIN
                      SETCURRENTKEY("Order No.","Order Line No.");
                      SETRANGE("Order No.",SalesLine."Document No.");
                      SETRANGE("Order Line No.",SalesLine."Line No.");
                    END;
                    SETRANGE(Correction,FALSE);
                    IF QtyType = QtyType::Invoicing THEN
                      SETFILTER("Qty. Shipped Not Invoiced",'<>0');

                    IF FINDSET THEN
                      REPEAT
                        FilterPstdDocLnItemLedgEntries(ItemLedgEntry);
                        IF ItemLedgEntry.FINDSET THEN
                          REPEAT
                            CreateTempAdjmtValueEntries(TempValueEntry,ItemLedgEntry."Entry No.");
                          UNTIL ItemLedgEntry.NEXT = 0;
                      UNTIL NEXT = 0;
                  END;
              UNTIL SalesLine.NEXT = 0;
          END;
        "Document Type"::"Return Order","Document Type"::"Credit Memo":
          BEGIN
            IF SalesLine.FINDSET THEN
              REPEAT
                IF (SalesLine.Type = SalesLine.Type::Item) AND (SalesLine.Quantity <> 0) THEN
                  WITH ReturnRcptLine DO BEGIN
                    IF SalesLine."Return Receipt No." <> '' THEN BEGIN
                      SETRANGE("Document No.",SalesLine."Return Receipt No.");
                      SETRANGE("Line No.",SalesLine."Return Receipt Line No.");
                    END ELSE BEGIN
                      SETCURRENTKEY("Return Order No.","Return Order Line No.");
                      SETRANGE("Return Order No.",SalesLine."Document No.");
                      SETRANGE("Return Order Line No.",SalesLine."Line No.");
                    END;
                    SETRANGE(Correction,FALSE);
                    IF QtyType = QtyType::Invoicing THEN
                      SETFILTER("Return Qty. Rcd. Not Invd.",'<>0');

                    IF FINDSET THEN
                      REPEAT
                        FilterPstdDocLnItemLedgEntries(ItemLedgEntry);
                        IF ItemLedgEntry.FINDSET THEN
                          REPEAT
                            CreateTempAdjmtValueEntries(TempValueEntry,ItemLedgEntry."Entry No.");
                          UNTIL ItemLedgEntry.NEXT = 0;
                      UNTIL NEXT = 0;
                  END;
              UNTIL SalesLine.NEXT = 0;
          END;
      END;
      PAGE.RUNMODAL(0,TempValueEntry);
    END;

    PROCEDURE GetCustomerVATRegistrationNumber@63() : Text;
    BEGIN
      EXIT("VAT Registration No.");
    END;

    PROCEDURE GetCustomerVATRegistrationNumberLbl@62() : Text;
    BEGIN
      EXIT(FIELDCAPTION("VAT Registration No."));
    END;

    PROCEDURE GetCustomerGlobalLocationNumber@164() : Text;
    BEGIN
      EXIT('');
    END;

    PROCEDURE GetCustomerGlobalLocationNumberLbl@161() : Text;
    BEGIN
      EXIT('');
    END;

    PROCEDURE CreateTempAdjmtValueEntries@38(VAR TempValueEntry@1001 : TEMPORARY Record 5802;ItemLedgEntryNo@1000 : Integer);
    VAR
      ValueEntry@1002 : Record 5802;
    BEGIN
      WITH ValueEntry DO BEGIN
        SETCURRENTKEY("Item Ledger Entry No.");
        SETRANGE("Item Ledger Entry No.",ItemLedgEntryNo);
        IF FINDSET THEN
          REPEAT
            IF Adjustment THEN BEGIN
              TempValueEntry := ValueEntry;
              IF TempValueEntry.INSERT THEN;
            END;
          UNTIL NEXT = 0;
      END;
    END;

    PROCEDURE GetPstdDocLinesToRevere@39();
    VAR
      SalesPostedDocLines@1000 : Page 5850;
    BEGIN
      GetCust("Sell-to Customer No.");
      SalesPostedDocLines.SetToSalesHeader(Rec);
      SalesPostedDocLines.SETRECORD(Cust);
      SalesPostedDocLines.LOOKUPMODE := TRUE;
      IF SalesPostedDocLines.RUNMODAL = ACTION::LookupOK THEN
        SalesPostedDocLines.CopyLineToDoc;

      CLEAR(SalesPostedDocLines);
    END;

    PROCEDURE CalcInvDiscForHeader@45();
    VAR
      SalesInvDisc@1000 : Codeunit 60;
    BEGIN
      SalesSetup.GET;
      IF SalesSetup."Calc. Inv. Discount" THEN
        SalesInvDisc.CalculateIncDiscForHeader(Rec);
    END;

    PROCEDURE SetSecurityFilterOnRespCenter@43();
    BEGIN
      IF UserSetupMgt.GetSalesFilter <> '' THEN BEGIN
        FILTERGROUP(2);
        SETRANGE("Responsibility Center",UserSetupMgt.GetSalesFilter);
        FILTERGROUP(0);
      END;

      SETRANGE("Date Filter",0D,WORKDATE - 1);
    END;

    PROCEDURE Authorize@50();
    VAR
      DOPaymentTransLogEntry@1001 : Record 829;
    BEGIN
      IF NOT DOPaymentMgt.IsValidPaymentMethod("Payment Method Code") THEN
        ERROR(Text069,FIELDCAPTION("Payment Method Code"));
      DOPaymentTransLogMgt.FindValidAuthorizationEntry("Document Type","No.",DOPaymentTransLogEntry);
      IF DOPaymentTransLogEntry."Entry No." = DOPaymentMgt.AuthorizeSalesDoc(Rec,0,TRUE) THEN
        ERROR(Text067,
          DOPaymentTransLogEntry."Document Type",
          DOPaymentTransLogEntry.Amount,
          DOPaymentTransLogEntry."Transaction Date-Time",
          DOPaymentTransLogEntry."Document No.");
      "Authorization Required" := TRUE;
      MODIFY;
    END;

    PROCEDURE Void@51();
    VAR
      DOPaymentTransLogEntry@1001 : Record 829;
      DOPaymentTransLogMgt@1002 : Codeunit 829;
    BEGIN
      IF NOT DOPaymentMgt.IsValidPaymentMethod("Payment Method Code") THEN
        ERROR(Text069,FIELDCAPTION("Payment Method Code"));
      CLEAR(DOPaymentMgt);
      DOPaymentMgt.CheckSalesDoc(Rec);
      IF DOPaymentTransLogMgt.FindValidAuthorizationEntry("Document Type","No.",DOPaymentTransLogEntry) THEN
        DOPaymentMgt.VoidSalesDoc(Rec,DOPaymentTransLogEntry)
      ELSE
        MESSAGE(Text068);
      "Authorization Required" := FALSE;
      MODIFY;
    END;

    PROCEDURE GetCreditcardNumber@44() : Text[20];
    VAR
      DOPaymentCreditCard@1001 : Record 827;
    BEGIN
      IF "Credit Card No." = '' THEN
        EXIT('');
      EXIT(DOPaymentCreditCard.GetCreditCardNumber("Credit Card No."));
    END;

    PROCEDURE SynchronizeForReservations@42(VAR NewSalesLine@1000 : Record 37;OldSalesLine@1001 : Record 37);
    BEGIN
      NewSalesLine.CALCFIELDS("Reserved Quantity");
      IF NewSalesLine."Reserved Quantity" = 0 THEN
        EXIT;
      IF NewSalesLine."Location Code" <> OldSalesLine."Location Code" THEN
        NewSalesLine.VALIDATE("Location Code",OldSalesLine."Location Code");
      IF NewSalesLine."Bin Code" <> OldSalesLine."Bin Code" THEN
        NewSalesLine.VALIDATE("Bin Code",OldSalesLine."Bin Code");
      IF NewSalesLine.MODIFY THEN;
    END;

    PROCEDURE InventoryPickConflict@46(DocType@1002 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';DocNo@1003 : Code[20];ShippingAdvice@1004 : 'Partial,Complete') : Boolean;
    VAR
      WarehouseActivityLine@1000 : Record 5767;
      SalesLine@1001 : Record 37;
    BEGIN
      IF ShippingAdvice <> ShippingAdvice::Complete THEN
        EXIT(FALSE);
      WarehouseActivityLine.SETCURRENTKEY("Source Type","Source Subtype","Source No.");
      WarehouseActivityLine.SETRANGE("Source Type",DATABASE::"Sales Line");
      WarehouseActivityLine.SETRANGE("Source Subtype",DocType);
      WarehouseActivityLine.SETRANGE("Source No.",DocNo);
      IF WarehouseActivityLine.ISEMPTY THEN
        EXIT(FALSE);
      SalesLine.SETRANGE("Document Type",DocType);
      SalesLine.SETRANGE("Document No.",DocNo);
      SalesLine.SETRANGE(Type,SalesLine.Type::Item);
      IF SalesLine.ISEMPTY THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    PROCEDURE WhseShpmntConflict@52(DocType@1002 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';DocNo@1001 : Code[20];ShippingAdvice@1000 : 'Partial,Complete') : Boolean;
    VAR
      WarehouseShipmentLine@1003 : Record 7321;
    BEGIN
      IF ShippingAdvice <> ShippingAdvice::Complete THEN
        EXIT(FALSE);
      WarehouseShipmentLine.SETCURRENTKEY("Source Type","Source Subtype","Source No.","Source Line No.");
      WarehouseShipmentLine.SETRANGE("Source Type",DATABASE::"Sales Line");
      WarehouseShipmentLine.SETRANGE("Source Subtype",DocType);
      WarehouseShipmentLine.SETRANGE("Source No.",DocNo);
      IF WarehouseShipmentLine.ISEMPTY THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    PROCEDURE CheckCrLimit@47();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      SalesHeader := Rec;
      IF GUIALLOWED AND
         (CurrFieldNo <> 0) AND
         ("Document Type" <= "Document Type"::Invoice) AND
         SalesHeader.FIND
      THEN BEGIN
        "Amount Including VAT" := 0;
        IF "Document Type" = "Document Type"::Order THEN
          IF BilltoCustomerNoChanged THEN BEGIN
            SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
            SalesLine.SETRANGE("Document No.","No.");
            SalesLine.CALCSUMS("Outstanding Amount","Shipped Not Invoiced");
            "Amount Including VAT" := SalesLine."Outstanding Amount" + SalesLine."Shipped Not Invoiced";
          END;
        CustCheckCreditLimit.SalesHeaderCheck(Rec);
        CALCFIELDS("Amount Including VAT");
      END;
    END;

    PROCEDURE QtyToShipIsZero@49() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Qty. to Ship",'<>0');
      EXIT(SalesLine.ISEMPTY);
    END;

    PROCEDURE IsApprovedForPosting@53() : Boolean;
    VAR
      PurchaseHeader@1000 : Record 38;
    BEGIN
      PurchaseHeader.INIT;
      IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN BEGIN
        IF ApprovalMgt.TestSalesPrepayment(Rec) THEN
          ERROR(STRSUBSTNO(Text071,"Document Type","No."));
        IF ApprovalMgt.TestSalesPayment(Rec) THEN
          ERROR(STRSUBSTNO(Text072,"Document Type","No."));
        EXIT(TRUE);
      END;
    END;

    PROCEDURE IsApprovedForPostingBatch@54() : Boolean;
    VAR
      PurchaseHeader@1000 : Record 38;
    BEGIN
      PurchaseHeader.INIT;
      IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN BEGIN
        IF ApprovalMgt.TestSalesPrepayment(Rec) THEN
          EXIT(FALSE);
        IF ApprovalMgt.TestSalesPayment(Rec) THEN
          EXIT(FALSE);
        EXIT(TRUE);
      END;
    END;

    PROCEDURE ClearSellToCust@1060000();
    BEGIN
      "Sell-to Contact" := '';
      "Sell-to Contact Phone No." := '';
      "Sell-to Contact Fax No." := '';
      "Sell-to Contact E-Mail" := '';
      "Sell-to Contact Role" := "Sell-to Contact Role"::" ";
    END;

    PROCEDURE GetselltoCust@1060002(Name@1102601004 : Text[50];PhoneNo@1060003 : Text[30];FaxNo@1060004 : Text[30];Email@1060005 : Text[80]);
    BEGIN
      "Sell-to Contact" := Name;
      "Sell-to Contact Phone No." := PhoneNo;
      "Sell-to Contact Fax No." := FaxNo;
      "Sell-to Contact E-Mail" := Email;
      "Sell-to Contact Role" := "Sell-to Contact Role"::" ";
    END;

    PROCEDURE GetLegalStatement@60() : Text;
    BEGIN
      SalesSetup.GET;
      EXIT(SalesSetup.GetLegalStatement);
    END;

    PROCEDURE SendToPosting@57(PostingCodeunitID@1000 : Integer);
    BEGIN
      IF NOT IsApprovedForPosting THEN
        EXIT;
      CODEUNIT.RUN(PostingCodeunitID,Rec);
    END;

    PROCEDURE CancelBackgroundPosting@48();
    VAR
      SalesPostViaJobQueue@1000 : Codeunit 88;
    BEGIN
      SalesPostViaJobQueue.CancelQueueEntry(Rec);
    END;

    PROCEDURE LinkSalesDocWithOpportunity@79(OldOpportunityNo@1000 : Code[20]);
    VAR
      SalesHeader@1001 : Record 36;
      Opportunity@1002 : Record 5092;
    BEGIN
      IF "Opportunity No." <> OldOpportunityNo THEN BEGIN
        IF "Opportunity No." <> '' THEN
          IF Opportunity.GET("Opportunity No.") THEN BEGIN
            Opportunity.TESTFIELD(Status,Opportunity.Status::"In Progress");
            IF Opportunity."Sales Document No." <> '' THEN BEGIN
              IF CONFIRM(Text048,FALSE,Opportunity."Sales Document No.",Opportunity."No.") THEN BEGIN
                IF SalesHeader.GET("Document Type"::Quote,Opportunity."Sales Document No.") THEN BEGIN
                  SalesHeader."Opportunity No." := '';
                  SalesHeader.MODIFY;
                END;
                UpdateOpportunityLink(Opportunity,Opportunity."Sales Document Type"::Quote,"No.");
              END ELSE
                "Opportunity No." := OldOpportunityNo;
            END ELSE
              UpdateOpportunityLink(Opportunity,Opportunity."Sales Document Type"::Quote,"No.");
          END;
        IF (OldOpportunityNo <> '') AND Opportunity.GET(OldOpportunityNo) THEN
          UpdateOpportunityLink(Opportunity,Opportunity."Sales Document Type"::" ",'');
      END;
    END;

    LOCAL PROCEDURE UpdateOpportunityLink@80(Opportunity@1000 : Record 5092;SalesDocumentType@1001 : Option;SalesHeaderNo@1002 : Code[20]);
    BEGIN
      Opportunity."Sales Document Type" := SalesDocumentType;
      Opportunity."Sales Document No." := SalesHeaderNo;
      Opportunity.MODIFY;
    END;

    PROCEDURE SynchronizeAsmHeader@56();
    VAR
      AsmHeader@1003 : Record 900;
      ATOLink@1002 : Record 904;
      Window@1000 : Dialog;
    BEGIN
      ATOLink.SETCURRENTKEY(Type,"Document Type","Document No.");
      ATOLink.SETRANGE(Type,ATOLink.Type::Sale);
      ATOLink.SETRANGE("Document Type","Document Type");
      ATOLink.SETRANGE("Document No.","No.");
      IF ATOLink.FINDSET THEN
        REPEAT
          IF AsmHeader.GET(ATOLink."Assembly Document Type",ATOLink."Assembly Document No.") THEN
            IF "Posting Date" <> AsmHeader."Posting Date" THEN BEGIN
              Window.OPEN(STRSUBSTNO(SynchronizingMsg,"No.",AsmHeader."No."));
              AsmHeader.VALIDATE("Posting Date","Posting Date");
              AsmHeader.MODIFY;
              Window.CLOSE;
            END;
        UNTIL ATOLink.NEXT = 0;
    END;

    PROCEDURE "// DKO Func"@1000000000();
    BEGIN
    END;

    PROCEDURE _Sammenl‘gSalgslinier@1000000003(_Salgshoved@1000000000 : Record 36);
    VAR
      _Salgslinie@1000000001 : Record 37;
      _Salgslinie2@1000000002 : Record 37;
      _Tekstlinier@1000000003 : Record 37;
    BEGIN
      WITH _Salgslinie DO BEGIN
         SETRANGE("Document Type",_Salgshoved."Document Type");
         SETRANGE("Document No.",_Salgshoved."No.");
         SETFILTER("Quantity Shipped",'=0');
         SETRANGE(Type,Type::Item);
         SETRANGE(Skaffevare,FALSE);
         SETRANGE("Purchasing Code",'');
         SETRANGE(Produktionstype,'');
         IF FIND('-') THEN
            REPEAT
               _Salgslinie2.SETRANGE("Document Type","Document Type");
               _Salgslinie2.SETRANGE("Document No.","Document No.");
               _Salgslinie2.SETRANGE(Type,Type);
               _Salgslinie2.SETRANGE("No.","No.");
               _Salgslinie2.SETRANGE("Location Code","Location Code");
               _Salgslinie2.SETRANGE("Shipment Date","Shipment Date");
               _Salgslinie2.SETRANGE("Job No.","Job No.");
               _Salgslinie2.SETRANGE("Shortcut Dimension 1 Code","Shortcut Dimension 1 Code");
               _Salgslinie2.SETRANGE("Shortcut Dimension 2 Code","Shortcut Dimension 2 Code");
               _Salgslinie2.SETRANGE("Unit Price","Unit Price");
               _Salgslinie2.SETFILTER("Line No.",'<>%1',"Line No.");
               IF _Salgslinie2.FIND('-') THEN
                  REPEAT
                     _Salgslinie.VALIDATE(Quantity,(_Salgslinie.Quantity + _Salgslinie2.Quantity));
                     _Salgslinie.MODIFY;
                     _Tekstlinier.SETRANGE("Document Type","Document Type");
                     _Tekstlinier.SETRANGE("Document No.","Document No.");
                     _Tekstlinier.SETRANGE(Type,0);
                     _Tekstlinier.SETFILTER("Attached to Line No.",'=%1',_Salgslinie2."Line No.");
                     _Tekstlinier.MODIFYALL("Attached to Line No.","Line No.");
                     _Salgslinie2.DELETE;
                  UNTIL _Salgslinie2.NEXT = 0;
            UNTIL NEXT = 0;
      END;
    END;

    PROCEDURE _SorterSalgslinier@1000000002(_SalgsHoved@1000000000 : Record 36);
    VAR
      _Salgslinie@1000000001 : Record 37;
      _Salgslinie2@1000000002 : TEMPORARY Record 37;
      _Tekstlinier@1000000003 : Record 37;
      "_Linienr."@1000000004 : Integer;
      D›rskemalinie@1000000005 : Record 50016;
      Glasskemalinie@1000000006 : Record 83004;
    BEGIN
      WITH _Salgslinie DO BEGIN
         SETCURRENTKEY("Document Type",Type,"No.","Variant Code","Drop Shipment","Shipment Date");
         SETRANGE("Document Type",_SalgsHoved."Document Type");
         SETRANGE("Document No.",_SalgsHoved."No.");
         SETFILTER("Quantity Shipped",'<>0');
         IF FIND('-') THEN
            ERROR('Sortering kan ikke foretages da der er leverede linier');
         SETFILTER("Quantity Shipped",'=0');
         SETRANGE(Type,Type::Item);
         _Salgslinie2.DELETEALL;
         "_Linienr." := 0;

      // >> 25:
         Glasskemalinie.SETRANGE("Document Type",_SalgsHoved."Document Type");
         Glasskemalinie.SETRANGE("Dokument No",_SalgsHoved."No.");
      // << 25

         IF FIND('-') THEN
            REPEAT
               _Salgslinie2 := _Salgslinie;
               "_Linienr." := "_Linienr." + 10000;

      // >> 22
               D›rskemalinie.RESET;
               D›rskemalinie.SETRANGE("Document Type",_SalgsHoved."Document Type");
               D›rskemalinie.SETRANGE("Dokument No",_SalgsHoved."No.");
               D›rskemalinie.SETRANGE("D›r Linienr.","Line No.");
               D›rskemalinie.MODIFYALL("Nyt D›rlinienr.","_Linienr.");

               D›rskemalinie.RESET;
               D›rskemalinie.SETRANGE("Document Type",_SalgsHoved."Document Type");
               D›rskemalinie.SETRANGE("Dokument No",_SalgsHoved."No.");
               D›rskemalinie.SETRANGE("Karm Linienr.","Line No.");
               D›rskemalinie.MODIFYALL("Nyt Karmlinienr.","_Linienr.");
      // << 22
      // >> 25:
               Glasskemalinie.SETRANGE("Glas Linienr.","Line No.");
               Glasskemalinie.MODIFYALL("Glas Linienr.","_Linienr.");
      // << 25

               _Salgslinie2."Line No." := "_Linienr.";
               _Salgslinie2.INSERT;
            UNTIL NEXT = 0;
         DELETEALL;

      // >> 22
         D›rskemalinie.RESET;
         D›rskemalinie.SETRANGE("Document Type",_SalgsHoved."Document Type");
         D›rskemalinie.SETRANGE("Dokument No",_SalgsHoved."No.");
         IF D›rskemalinie.FIND('-') THEN REPEAT
           D›rskemalinie."D›r Linienr." := D›rskemalinie."Nyt D›rlinienr.";
           D›rskemalinie."Nyt D›rlinienr." := 0;
           D›rskemalinie."Karm Linienr." := D›rskemalinie."Nyt Karmlinienr.";
           D›rskemalinie."Nyt Karmlinienr." := 0;
           D›rskemalinie.MODIFY;
         UNTIL D›rskemalinie.NEXT = 0;
      // << 22

         SETRANGE(Type,0);
         IF FIND('-') THEN
            REPEAT
               _Salgslinie2 := _Salgslinie;
               "_Linienr." := "_Linienr." + 10000;
               _Salgslinie2."Line No." := "_Linienr.";
               _Salgslinie2.INSERT;
            UNTIL NEXT = 0;
         DELETEALL;
         SETRANGE(Type,Type::Resource);
         IF FIND('-') THEN
            REPEAT
               _Salgslinie2 := _Salgslinie;
               "_Linienr." := "_Linienr." + 10000;
               _Salgslinie2."Line No." := "_Linienr.";
               _Salgslinie2.INSERT;
            UNTIL NEXT = 0;
         SETRANGE(Type,Type::"G/L Account");
         IF FIND('-') THEN
            REPEAT
               _Salgslinie2 := _Salgslinie;
               "_Linienr." := "_Linienr." + 10000;
               _Salgslinie2."Line No." := "_Linienr.";
               _Salgslinie2.INSERT;
            UNTIL NEXT = 0;
         SETRANGE(Type);
         IF _Salgslinie2.FIND('-') THEN
            REPEAT
               _Salgslinie := _Salgslinie2;
               INSERT;
            UNTIL _Salgslinie2.NEXT = 0;
      END;
    END;

    PROCEDURE GetSalesLinesPurchaseOrderNo@1000000001(SalesOrderNo@1060001 : Code[20]) PurchOrderNo : Code[250];
    VAR
      lPurchHeader@1060000 : Record 38;
    BEGIN
      {
      lPurchHeader.SETRANGE("Document Type","Document Type"::Order);
      lPurchHeader.SETRANGE(lPurchHeader."Salgsordrenr.", SalesOrderNo);
      IF lPurchHeader.FINDSET THEN REPEAT
        PurchOrderNo := PurchOrderNo+lPurchHeader."No."+';';
      UNTIL lPurchHeader.NEXT = 0;
      }
    END;

    PROCEDURE CheckShippingAdvice@55();
    VAR
      SalesLine@1000 : Record 37;
      QtyToShipBaseTotal@1002 : Decimal;
      Result@1001 : Boolean;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETRANGE("Drop Shipment",FALSE);
      Result := TRUE;
      IF SalesLine.FINDSET THEN
        REPEAT
          IF SalesLine.IsShipment THEN BEGIN
            QtyToShipBaseTotal += SalesLine."Qty. to Ship (Base)";
            IF SalesLine."Quantity (Base)" <>
               SalesLine."Qty. to Ship (Base)" + SalesLine."Qty. Shipped (Base)"
            THEN
              Result := FALSE;
          END;
        UNTIL SalesLine.NEXT = 0;
      IF QtyToShipBaseTotal = 0 THEN
        Result := TRUE;
      IF NOT Result THEN
        ERROR(ShippingAdviceErr);
    END;

    LOCAL PROCEDURE GetFilterCustNo@64() : Code[20];
    BEGIN
      IF GETFILTER("Sell-to Customer No.") <> '' THEN
        IF GETRANGEMIN("Sell-to Customer No.") = GETRANGEMAX("Sell-to Customer No.") THEN
          EXIT(GETRANGEMAX("Sell-to Customer No."));
    END;

    LOCAL PROCEDURE GetFilterContNo@65() : Code[20];
    BEGIN
      IF GETFILTER("Sell-to Contact No.") <> '' THEN
        IF GETRANGEMIN("Sell-to Contact No.") = GETRANGEMAX("Sell-to Contact No.") THEN
          EXIT(GETRANGEMAX("Sell-to Contact No."));
    END;

    LOCAL PROCEDURE CheckCreditLimitIfLineNotInsertedYet@66();
    BEGIN
      IF "No." = '' THEN BEGIN
        HideCreditCheckDialogue := FALSE;
        CheckCreditMaxBeforeInsert;
        HideCreditCheckDialogue := TRUE;
        InitInsert;
      END;
    END;

    PROCEDURE InvoicedLineExists@156() : Boolean;
    VAR
      SalesLine@1000 : Record 37;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER(Type,'<>%1',SalesLine.Type::" ");
      SalesLine.SETFILTER("Quantity Invoiced",'<>%1',0);
      EXIT(NOT SalesLine.ISEMPTY);
    END;

    BEGIN
    {
      Jan Lykke S›rensen  -  Sintas a/s
      [01] 16-10-1998 Henter bonusmarkering fra debitoren.
      [02] 12-03-1999 Birger Boldrup
                      Nyt felt  50011 flowfield Kreditv‘rdighed relatere til debitortabellen
      [03] 18.03.1999 Birger Boldrup
                      Nye felter
                      50012 Intern(Debitor)      Boolean
                      50013 Sagstype             Option
                      50014 Indk›bes til Sagsnr. Code 20
      [04] 18.03.1999 Birger Boldrup
                      Ny Funktion _Sammenl‘gSalgslinier
      [05] 26.03.1999 Birger Boldrup
                      Leverings adresser hentes fra sag
      [06] 30.03.1999 Birger Boldrup
                      Nye felter
                      50015 Nettov‘gt i kg  Decimal
                      50016 Bruttov‘gt i kg Decimal
                      50017 Mü              Decimal
      [07] 12.04.1999 Birger Boldrup
                      50018 Kolliantal      Integer
      [08] 15.04.1999 Birger Boldrup
                      50019 Leveringstidspunkt     Time
                      50020 Plukkeliste(udskrevet) Integer
      [10] 04.05.1999 Nyt felt
                      50021 Eksporterkl‘ringskode Code 20
      [11] 05.05.1999 Birger Boldrup
                      //IF Bilagstype IN [Bilagstype::Ordre,Bilagstype::Faktura] THEN BEGIN

      [12] 11.05.1999 Birger Boldrup
                      Ved sagstype enteprise hentes betalingsbetingelser fra sag,

      [13] 28.05.1999 Birger Boldrup
                      Transaktionsart Initial v‘rdi (11);
                      Udf›rselssted   Initial v‘rdi (DKK);
      [14] 08.06.1999 Birger Boldrup
                      Nyt felt (Anvendes ved intern overf›rsel til K›bslinier
                      50022 Indk›bes til Hovedaktivitet Code 10
      [15] 15.06.1999 Birger Boldrup
                      Nyt felt
                      50023  SagsBeskrivelse
      [16] 16.08.1999 Birger boldrup
                      Afdelingskode hentes fra sag  (Kun ved sagsnr).
      [17] 16.08.1999 Birger boldrup
                      Salgslinie gennel›bes kun hvis der er ‘ndret i grundlaget
      [18] 20.09.1999 Birger Boldrup
                      Ny N›gle P† Indk›bes til sagsnr
      [19] 28.10.1999 Birger Boldrup
                      Kundenr og faktures til kundenr m† ikke kunne ‘ndres

      // >> NaviCom:
            - Check om sagen er sp‘rret.
            - Afdelingskode udfyldes ligledes n†r der indk›bes til interne sager.
            - Afdelingskode (onValidate) opdaterer samtlige salgslinier.
            - Opdater:  Ordredato samt bilagsdato.
            - Skujl orientering ved ‘ndring af ordredato
      // <<
      01 NC.BBO 03.03.2003 Hvis sagsnr er udfyldt hentes s‘lgerkode fra Kondukt›r i stedet for Ordremodtager

      >> 20: RCG 030806 bner for muligheden at ‘ndre sagsnr. Dog ‘ndres ikke p† linier
      >> 21: RCG 060906 Opdaterer Sagsnr p† alle linier n†r det ‘ndres p† hovedet.
      >> 22: RCG 121106 D›rskemalinier skal m†ske opdateres med linienr. i ved sortering
      >> 23: RCG 121106 D›rskemafunktioner
      >> 24: RCG 070207 Der skal v‘re mindst 19 timer til levering.
      >> 25: RCG 231107 Glasfunktioner som D›rfunktioner
      >> 26: RCG 180208 Ship-to Contact skal ikke tages fra sagen - men den skal blankes
      >> 27: RCG 220409 Forskellige tjek p† sagen n†r den indtastes.
      >> 28: RCG 080310 Viser bem‘rkninger hvis der er faktureringskrav
      >> 29: RCG 300610 Flere nye felter til pluk. Kun lagerbrugere m† ‘ndre i I Pluk.
      >> 30: RCG 270111 Oprettet af gemmes.
      >> 31: RCG 090511 Nyt felt til Deres M‘rke - som overf›res til Eksternt Bilagsnr.
      >> 32: RCG 200911 Der skal ikke ‘ndres dimension, n†r s‘lger ‘ndres/indtastes.
      >> 33: RCG 311012 Ny N›gle til sk‘rmbillede med udest†ende ordrer.
      >> 34: RCG 251112 Hvis D›rordre, s† skal D›rLinienr slettes.
      >> 35: RCG 120213 H†ndtering af MaletProfilskema
      >> 36: RCG 150213 P† kunde til Malerskema (99992) skal det v‘re muligt at angive sag.
      >> SYS1.02 DAB 04062013 Tilf›jet felt 50031 Own Brand
      >> SYS1.05: RCG 011113 T›mrerformand p† sagen overf›res til Leveres Attention
      >> 37: RCG NAV2013 ’ndrer ogs† sagen p† tilh›rende k›b.
    }
    END.
  }
}

OBJECT Table 50015 D›rskemahoved
{
  OBJECT-PROPERTIES
  {
    Date=23-11-16;
    Time=15:03:48;
    Modified=Yes;
    Version List=SYS1.05;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               SalesHeader.GET("Document Type","Dokument No");
               IF SalesHeader."Job No." <> '' THEN
                 "Sagsnr." := SalesHeader."Job No."
               ELSE
                 "Sagsnr." := SalesHeader."Indk›bes til Sagsnr.";

               // >> 8:
               DateRec.SETRANGE("Period Type",DateRec."Period Type"::Date);
               DateRec.SETRANGE("Period Start",TODAY,TODAY+100);
               DateRec.SETRANGE("Period No.",1,5);
               DateRec.FINDFIRST;
               DateRec.NEXT(10);
               //SYS1.03 >>
               //"nsket Dato" := DateRec."Period Start";
               // SYS1.03
               // >> 8

               IF KarmLevTid = 0 THEN BEGIN
                 JobsSetup.GET;
                 VALIDATE(KarmLevTid,JobsSetup."Default Karm Lev. Tid");
               END;

               Kalenderdagedage := KarmLevTid;
               FOR i := 1 TO KarmLevTid DO BEGIN
                 IF (DATE2DWY(CALCDATE(STRSUBSTNO('%1D',i),TODAY),1) = 6) OR (DATE2DWY(CALCDATE(STRSUBSTNO('%1D',i),TODAY),1) = 7) THEN
                   Kalenderdagedage := Kalenderdagedage + 1;
               END;
               "nsket Dato" := CALCDATE(STRSUBSTNO('%1D',Kalenderdagedage),TODAY);

               CompanyInfo.GET;
               "Ship-to Name" := CompanyInfo."Ship-to Name";
               "Ship-to Name 2" := CompanyInfo."Ship-to Name 2";
               "Ship-to Address" := CompanyInfo."Ship-to Address";
               "Ship-to Address 2" := CompanyInfo."Ship-to Address 2";
               "Ship-to Post Code" := CompanyInfo."Ship-to Post Code";
               "Ship-to City" := CompanyInfo."Ship-to City";
               "Ship-to Country" := CompanyInfo."Ship-to Country/Region Code";
             END;

    OnModify=BEGIN
               // Check om noget er igangsat
               Linie.SETRANGE("Document Type","Document Type");
               Linie.SETRANGE("Dokument No","Dokument No");
               Linie.SETFILTER(Status,'<>%1',0);
               IF Linie.FINDFIRST THEN BEGIN
                 UserSetup.GET(USERID);
                 UserSetup.TESTFIELD("D›rskema Ansvarlig");
               END;

               // >> 1:
               IF ("D›r Planlagt Leveringsuge" <> 0) OR
                  ("Karm Planlagt Leveringsuge" <> 0) THEN BEGIN
                 UserSetup.GET(USERID);
                 UserSetup.TESTFIELD("D›rskema Ansvarlig");
               END;
               // << 1
             END;

    OnDelete=BEGIN
               Linie.SETRANGE("Document Type","Document Type");
               Linie.SETRANGE("Dokument No","Dokument No");
               Linie.DELETEALL;
             END;

    LookupPageID=Page50080;
    DrillDownPageID=Page50080;
  }
  FIELDS
  {
    { 1   ;   ;Document Type       ;Option        ;OptionCaptionML=[DAN=Tilbud,Ordre,Faktura,Kreditnota,Rammeordre,Returv.ordre;
                                                                    ENU=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order];
                                                   OptionString=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order }
    { 2   ;   ;Dokument No         ;Code20        ;TableRelation="Sales Header".No. WHERE (Document Type=FIELD(Document Type));
                                                   CaptionML=[DAN=Ordrenr.;
                                                              ENU=Dokument No];
                                                   Editable=No }
    { 5   ;   ;D›r Ordrenr.        ;Code20        ;TableRelation="Sales Header".No. WHERE (Document Type=FIELD(Document Type));
                                                   Editable=No }
    { 10  ;   ;Rev.Dato            ;Date           }
    { 11  ;   ;D›r nsket Leveringsuge;Integer    ;OnValidate=BEGIN
                                                                IF "D›r nsket Leveringsuge" <> 0 THEN BEGIN
                                                                  IF "D›r nsket Leveringsuge" < DATE2DWY(TODAY,2) THEN
                                                                    "D›r nsket Leveringsdato" := DWY2DATE(5,"D›r nsket Leveringsuge",DATE2DMY(TODAY,3)+1)
                                                                  ELSE // Dette †r
                                                                    "D›r nsket Leveringsdato" := DWY2DATE(5,"D›r nsket Leveringsuge",DATE2DMY(TODAY,3));
                                                                END ELSE
                                                                  "D›r nsket Leveringsdato" := 0D;

                                                                Linie.SETRANGE("Document Type","Document Type");
                                                                Linie.SETRANGE("Dokument No","Dokument No");
                                                                Linie.MODIFYALL("D›r nsket Leveringsuge","D›r nsket Leveringsuge");
                                                              END;

                                                   BlankZero=Yes }
    { 12  ;   ;D›r Planlagt Leveringsuge;Integer  ;OnValidate=BEGIN
                                                                // >> 1:
                                                                UserSetup.GET(USERID);
                                                                UserSetup.TESTFIELD("D›rskema Ansvarlig");
                                                                // << 1

                                                                Linie.SETRANGE("Document Type","Document Type");
                                                                Linie.SETRANGE("Dokument No","Dokument No");
                                                                Linie.MODIFYALL("D›r Planlagt Leveringsuge","D›r Planlagt Leveringsuge");
                                                              END;

                                                   BlankZero=Yes }
    { 13  ;   ;Karm nsket Leveringsuge;Integer   ;OnValidate=BEGIN
                                                                //SYS1.03 >>
                                                                {
                                                                IF "Karm nsket Leveringsuge" <> 0 THEN BEGIN
                                                                  IF "Karm nsket Leveringsuge" < DATE2DWY(TODAY,2) THEN
                                                                    "nsket Dato" := DWY2DATE(5,"Karm nsket Leveringsuge",DATE2DMY(TODAY,3)+1)
                                                                  ELSE // Dette †r
                                                                    "nsket Dato" := DWY2DATE(5,"Karm nsket Leveringsuge",DATE2DMY(TODAY,3));
                                                                END ELSE
                                                                  "nsket Dato" := 0D;
                                                                }
                                                                //SYS1.03 <<
                                                                Linie.SETRANGE("Document Type","Document Type");
                                                                Linie.SETRANGE("Dokument No","Dokument No");
                                                                Linie.MODIFYALL("Karm nsket Leveringsuge","Karm nsket Leveringsuge");
                                                              END;

                                                   BlankZero=Yes }
    { 14  ;   ;Karm Planlagt Leveringsuge;Integer ;OnValidate=BEGIN
                                                                // >> 1:
                                                                UserSetup.GET(USERID);
                                                                UserSetup.TESTFIELD("D›rskema Ansvarlig");
                                                                // << 1

                                                                Linie.SETRANGE("Document Type","Document Type");
                                                                Linie.SETRANGE("Dokument No","Dokument No");
                                                                Linie.MODIFYALL("Karm Planlagt Leveringsuge","Karm Planlagt Leveringsuge");
                                                              END;

                                                   BlankZero=Yes }
    { 15  ;   ;D›r nsket Leveringsdato;Date      ;OnValidate=BEGIN
                                                                IF "D›r nsket Leveringsdato" <> 0D THEN BEGIN
                                                                  "D›r nsket Leveringsuge" := DATE2DWY("D›r nsket Leveringsdato",2);
                                                                  Linie.SETRANGE("Document Type","Document Type");
                                                                  Linie.SETRANGE("Dokument No","Dokument No");
                                                                  Linie.MODIFYALL("D›r nsket Leveringsuge","D›r nsket Leveringsuge");
                                                                END;
                                                              END;
                                                               }
    { 16  ;   ;nsket Dato         ;Date          ;OnValidate=BEGIN
                                                                IF "nsket Dato" <> 0D THEN BEGIN
                                                                  "Karm nsket Leveringsuge" := DATE2DWY("nsket Dato",2);
                                                                  Linie.SETRANGE("Document Type","Document Type");
                                                                  Linie.SETRANGE("Dokument No","Dokument No");
                                                                  Linie.MODIFYALL("Karm nsket Leveringsuge","Karm nsket Leveringsuge");
                                                                END;
                                                              END;

                                                   CaptionML=DAN=Karm nsket Dato }
    { 17  ;   ;Bekr‘ftet Dato      ;Date          ;OnValidate=VAR
                                                                DatoTekst@1060000 : Text[150];
                                                              BEGIN
                                                                //>>SYS
                                                                IF "Bekr‘ftet Dato" <> 0D THEN BEGIN
                                                                  CLEAR(Mail);
                                                                  SalesHeader.GET("Document Type","Dokument No");
                                                                  Salesperson.GET(SalesHeader."Salesperson Code");
                                                                  IF Salesperson."E-Mail" <> '' THEN BEGIN
                                                                    Subject := STRSUBSTNO('Din ordre %1 er bekr‘ftet til dato %2',"Dokument No","Bekr‘ftet Dato");
                                                                    Mail.NewMessage(Salesperson."E-Mail",'','',Subject,'','',TRUE);
                                                                  END;
                                                                END;

                                                                {
                                                                // >> 10:
                                                                IF "Bekr‘ftet Dato" <> "nsket Dato" THEN
                                                                  DatoTekst := 'Bekr‘ftet Dato. Ordre: ' + "Dokument No" + ', Sag: ' + "Sagsnr." + ', Dato: ' + FORMAT("Bekr‘ftet Dato")
                                                                ELSE
                                                                  DatoTekst := 'Bekr‘ftet Dato. Ordre: ' + "Dokument No" + ', Sag: ' + "Sagsnr." + ', Dato: ' + FORMAT("Bekr‘ftet Dato") + ' er OK';

                                                                CLEAR(Mail);
                                                                SalesHeader.GET("Document Type","Dokument No");
                                                                Salesperson.GET(SalesHeader."Salesperson Code");
                                                                IF Salesperson."E-Mail" <> '' THEN BEGIN
                                                                  DimensionValue.GET('AFDELING',SalesHeader."Shortcut Dimension 1 Code");
                                                                  Mail.NewMessage(
                                                                    Salesperson."E-Mail",
                                                                    DimensionValue."Mail ved D›rskema Datoer",
                                                                    DatoTekst,
                                                                    'nsket dato: ' + FORMAT("nsket Dato") + '. Bekr‘ftet Dato: ' + FORMAT("Bekr‘ftet Dato"),
                                                                    '',
                                                                    '', //NAV2015
                                                                    TRUE);
                                                                END;
                                                                // << 9
                                                                }
                                                              END;
                                                               }
    { 18  ;   ;Klarmeldt Dato      ;Date          ;OnValidate=BEGIN
                                                                //>>SYS
                                                                IF "Klarmeldt Dato" <> 0D THEN BEGIN
                                                                  CLEAR(Mail);
                                                                  SalesHeader.GET("Document Type","Dokument No");
                                                                  Salesperson.GET(SalesHeader."Salesperson Code");
                                                                  IF Salesperson."E-Mail" <> '' THEN BEGIN
                                                                    Subject := STRSUBSTNO('Din ordre %1 er klarmeldt p† dato %2',"Dokument No","Klarmeldt Dato");
                                                                    Mail.NewMessage(Salesperson."E-Mail",'','',Subject,'','',TRUE);
                                                                  END;
                                                                END;
                                                                //<<SYS
                                                              END;
                                                               }
    { 20  ;   ;D›r Bem‘rkning      ;Text80         }
    { 21  ;   ;Karm Bem‘rkning     ;Text80         }
    { 22  ;   ;Bes‘tning Bem‘rkning;Text80         }
    { 25  ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                // Kun enkelte kan rette igangv‘rende
                                                                UserSetup.GET(USERID);
                                                                UserSetup.TESTFIELD("D›rskema Ansvarlig");

                                                                Linie.SETRANGE("Document Type","Document Type");
                                                                Linie.SETRANGE("Dokument No","Dokument No");
                                                                Linie.MODIFYALL(Status,Status);
                                                              END;

                                                   OptionString=[ ,Planlagt,Igang,Venter,Afsluttet] }
    { 26  ;   ;D›r Bem‘rkning 2    ;Text80         }
    { 27  ;   ;Karm Bem‘rkning 2   ;Text80         }
    { 28  ;   ;Bes‘tning Bem‘rkning 2;Text80       }
    { 30  ;   ;D›rgreb type        ;Text50         }
    { 31  ;   ;D›rstop type        ;Text50         }
    { 32  ;   ;Toiletbes‘tning type;Text50         }
    { 35  ;   ;Evt.Leveringslokation;Code10       ;TableRelation=Location }
    { 40  ;   ;Karm Farve          ;Text50        ;TableRelation="Karm/Gummi Farve".Kode WHERE (Karm=CONST(Yes));
                                                   OnValidate=BEGIN
                                                                IF KarmFarve.GET(TRUE,"Karm Farve") THEN
                                                                  "Gummi Farve" := KarmFarve."Gummi Farve";
                                                              END;

                                                   ValidateTableRelation=No }
    { 41  ;   ;Gummi Farve         ;Text50        ;TableRelation="Karm/Gummi Farve".Kode WHERE (Karm=CONST(No)) }
    { 50  ;   ;Sagsnr.             ;Code20        ;TableRelation=Job }
    { 60  ;   ;Udskrevet Dato      ;Date          ;Editable=No }
    { 61  ;   ;Udskrevet Tid       ;Time          ;Editable=No }
    { 62  ;   ;Udskrevet Korrektion;Integer       ;Editable=No }
    { 63  ;   ;Udskrevet           ;Integer       ;Editable=No }
    { 200 ;   ;Oprettet K›bsordrenr.;Code20       ;TableRelation="Purchase Header".No. WHERE (Document Type=CONST(Order));
                                                   CaptionML=DAN=K›bsordrenr. }
    { 300 ;   ;Total Estimerede Timer;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum(D›rskemalinie."Total Estimerede timer" WHERE (Document Type=FIELD(Document Type),
                                                                                                                 Dokument No=FIELD(Dokument No)));
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 302 ;   ;Ship-to Name        ;Text50        ;CaptionML=[DAN=Leveringsnavn;
                                                              ENU=Ship-to Name] }
    { 303 ;   ;Ship-to Name 2      ;Text50        ;CaptionML=[DAN=Leveringsnavn 2;
                                                              ENU=Ship-to Name 2] }
    { 304 ;   ;Ship-to Address     ;Text50        ;CaptionML=[DAN=Leveringsadresse;
                                                              ENU=Ship-to Address] }
    { 305 ;   ;Ship-to Address 2   ;Text50        ;CaptionML=[DAN=Leveringsadresse 2;
                                                              ENU=Ship-to Address 2] }
    { 306 ;   ;Ship-to Post Code   ;Code10        ;TableRelation="Post Code".Code;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DAN=Leveringspostnr.;
                                                              ENU=Ship-to Post Code] }
    { 307 ;   ;Ship-to City        ;Text50        ;CaptionML=[DAN=Leveringsby;
                                                              ENU=Ship-to City] }
    { 308 ;   ;Ship-to Country     ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[DAN=Leveringslandekode;
                                                              ENU=Ship-to Country] }
    { 309 ;   ;Ship-to Code        ;Code20        ;TableRelation="Ship-to Address - Glasskema".Code WHERE (Type=CONST(Glasskema));
                                                   OnValidate=BEGIN
                                                                IF ShiptoAddressGlasskema.GET(0,"Ship-to Code") THEN BEGIN
                                                                  VALIDATE("Levering byggeplads",FALSE);
                                                                  "Ship-to Name" := ShiptoAddressGlasskema.Name;
                                                                  "Ship-to Name 2" := ShiptoAddressGlasskema."Name 2";
                                                                  "Ship-to Address" := ShiptoAddressGlasskema.Address;
                                                                  "Ship-to Address 2" := ShiptoAddressGlasskema."Address 2";
                                                                  "Ship-to Post Code" := ShiptoAddressGlasskema."Post Code";
                                                                  "Ship-to City" := ShiptoAddressGlasskema.City;
                                                                  "Ship-to Country" := ShiptoAddressGlasskema."Country/Region Code";
                                                                END
                                                                ELSE BEGIN
                                                                  "Ship-to Name" := '';
                                                                  "Ship-to Name 2" := '';
                                                                  "Ship-to Address" := '';
                                                                  "Ship-to Address 2" := '';
                                                                  "Ship-to Post Code" := '';
                                                                  "Ship-to City" := '';
                                                                  "Ship-to Country" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[DAN=Leveringsadressekode;
                                                              ENU=Ship-to Code] }
    { 310 ;   ;Levering byggeplads ;Boolean       ;OnValidate=BEGIN
                                                                IF "Levering byggeplads" = TRUE THEN BEGIN
                                                                  VALIDATE("Ship-to Code",'');
                                                                  IF SalesHeader2.GET("Document Type","Dokument No") THEN BEGIN
                                                                    "Ship-to Name" := SalesHeader2."Ship-to Name";
                                                                    "Ship-to Name 2" := SalesHeader2."Ship-to Name 2";
                                                                    "Ship-to Address" := SalesHeader2."Ship-to Address";
                                                                    "Ship-to Address 2" := SalesHeader2."Ship-to Address 2";
                                                                    "Ship-to Post Code" := SalesHeader2."Ship-to Post Code";
                                                                    "Ship-to City" := SalesHeader2."Ship-to City";
                                                                    "Ship-to Country" := SalesHeader2."Ship-to Country/Region Code";
                                                                  END;
                                                                END
                                                                ELSE BEGIN
                                                                  "Ship-to Name" := '';
                                                                  "Ship-to Name 2" := '';
                                                                  "Ship-to Address" := '';
                                                                  "Ship-to Address 2" := '';
                                                                  "Ship-to Post Code" := '';
                                                                  "Ship-to City" := '';
                                                                  "Ship-to Country" := '';
                                                                END;
                                                              END;
                                                               }
    { 50001;  ;KarmLevTid          ;Integer       ;CaptionML=DAN=Karme Lev.tid er p.t. }
    { 50002;  ;Entreprise Leder    ;Code20        ;TableRelation="User Setup" }
    { 50003;  ;Ordre Giver         ;Code20        ;TableRelation="User Setup" }
    { 50004;  ;K›bsordrenr.        ;Code20        ;TableRelation="Purchase Header".No. WHERE (Document Type=FIELD(Document Type));
                                                   Editable=No }
    { 50005;  ;Forsendelse         ;Option        ;OptionCaptionML=[DAN=" ,Buk,Kasse,Palle,Profilboks";
                                                                    ENU=" ,Buk,Kasse,Palle,Profilboks"];
                                                   OptionString=[ ,Buk,Kasse,Palle,Profilboks] }
  }
  KEYS
  {
    {    ;Document Type,Dokument No               ;Clustered=Yes }
    {    ;Document Type,D›r Ordrenr.               }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Linie@1000000000 : Record 50016;
      SalesLine@1000000005 : Record 37;
      NextLineNo@1000000002 : Integer;
      SalesHeader@1000000001 : Record 36;
      D›rSalesHeader@1060001 : Record 36;
      UserSetup@1000000003 : Record 91;
      D›rTekst@1000000004 : Text[30];
      KarmTekst@1000000006 : Text[30];
      SideTekst@1060000 : Text[30];
      DateRec@1060002 : Record 2000000007;
      Mail@1060003 : Codeunit 397;
      DimensionValue@1060004 : Record 349;
      Salesperson@1060005 : Record 13;
      KarmFarve@1060006 : Record 50037;
      GummiFarve@1060007 : Record 50039;
      JobsSetup@1060008 : Record 315;
      i@1000000007 : Integer;
      Kalenderdagedage@1000000008 : Integer;
      Subject@1000000010 : Text[250];
      Item@1000000009 : Record 27;
      ShiptoAddressGlasskema@1000000012 : Record 50054;
      SalesHeader2@1000000011 : Record 36;
      CompanyInfo@1000000013 : Record 79;

    PROCEDURE CreateSalesLines@1000000000(OpdelOrdrer@1060000 : Boolean);
    VAR
      SletLinie@1000000000 : Integer;
      Job@1000000001 : Record 167;
    BEGIN
      SalesHeader.GET("Document Type","Dokument No");

      // >> 3:
      SalesHeader.TESTFIELD("Shortcut Dimension 1 Code");
      // << 3
      // >> SYS1.02
      // >> 9:
      //TESTFIELD("Karm Farve");
      // << 9
      // << SYS1.02
      // >> 7:
      IF NOT OpdelOrdrer THEN BEGIN
        "D›r Ordrenr." := "Dokument No";
        MODIFY;
      END;
      // << 7

      // >> 6
      IF "D›r Ordrenr." <> '' THEN
        OpdelOrdrer := "Dokument No" <> "D›r Ordrenr.";

      IF ("D›r Ordrenr." = '') OR (NOT D›rSalesHeader.GET("Document Type","D›r Ordrenr.")) AND OpdelOrdrer THEN BEGIN // Opret D›rordre
        Linie.RESET;
        Linie.SETRANGE("Document Type","Document Type");
        Linie.SETRANGE("Dokument No","Dokument No");
        Linie.SETRANGE(Textlinie,FALSE);
        Linie.SETFILTER(Ordre,'%1|%2',Linie.Ordre::Begge,Linie.Ordre::D›r);
        IF Linie.FINDFIRST THEN BEGIN
          D›rSalesHeader.INIT;
          D›rSalesHeader."Document Type" := D›rSalesHeader."Document Type"::Order;

          Job.LOCKTABLE;
          Job.GET(SalesHeader."Job No.");
          IF Job."N‘ste Salgsordre" = '' THEN
            Job."N‘ste Salgsordre" := '0000';
          Job."N‘ste Salgsordre" := INCSTR(Job."N‘ste Salgsordre");
          Job.MODIFY;

          D›rSalesHeader."No." := Job."No." + '-' + Job."N‘ste Salgsordre";
          D›rSalesHeader.INSERT(TRUE);

          D›rSalesHeader.VALIDATE("Sell-to Customer No.",SalesHeader."Sell-to Customer No.");
          D›rSalesHeader.VALIDATE("Bill-to Customer No.",SalesHeader."Bill-to Customer No.");
          D›rSalesHeader.VALIDATE("Order Date",SalesHeader."Order Date");
          D›rSalesHeader.VALIDATE("Posting Date",SalesHeader."Posting Date");
          D›rSalesHeader.VALIDATE("Shipment Date",SalesHeader."Shipment Date");
          D›rSalesHeader.VALIDATE("Shortcut Dimension 1 Code",SalesHeader."Shortcut Dimension 1 Code");
          D›rSalesHeader.VALIDATE("Shortcut Dimension 2 Code",SalesHeader."Shortcut Dimension 2 Code");
          D›rSalesHeader.VALIDATE("Salesperson Code",SalesHeader."Salesperson Code");
          IF SalesHeader."Job No." <> '' THEN
            D›rSalesHeader.VALIDATE("Job No.",SalesHeader."Job No.");
          IF SalesHeader."Indk›bes til Sagsnr." <> '' THEN
            D›rSalesHeader.VALIDATE("Indk›bes til Sagsnr.",SalesHeader."Indk›bes til Sagsnr.");
          D›rSalesHeader.VALIDATE("Your Reference",SalesHeader."Your Reference");
          D›rSalesHeader.VALIDATE("Deres M‘rke",SalesHeader."Deres M‘rke");
          D›rSalesHeader."Ship-to Name" := SalesHeader."Ship-to Name";
          D›rSalesHeader."Ship-to Name 2" := SalesHeader."Ship-to Name 2";
          D›rSalesHeader."Ship-to Address" := SalesHeader."Ship-to Address";
          D›rSalesHeader."Ship-to Address 2" := SalesHeader."Ship-to Address 2";
          D›rSalesHeader."Ship-to City" := SalesHeader."Ship-to City";
          D›rSalesHeader."Ship-to Contact" := SalesHeader."Ship-to Contact";
          D›rSalesHeader."Ship-to Post Code" := SalesHeader."Ship-to Post Code";
          D›rSalesHeader."Ship-to County" := SalesHeader."Ship-to County";
          D›rSalesHeader."Ship-to Country/Region Code" := SalesHeader."Ship-to Country/Region Code";
          D›rSalesHeader.MODIFY(TRUE);

          "D›r Ordrenr." := D›rSalesHeader."No.";
          MODIFY;
        END ELSE
          ERROR('Ingen d›re p† ordren.');
      END;
      D›rSalesHeader.GET("Document Type","D›r Ordrenr.");
      // << 6

      // >> 1:
      IF SalesHeader."Language Code" = '' THEN BEGIN
        D›rTekst := 'D›r ';
        KarmTekst := 'Karm ';
      END ELSE BEGIN
        D›rTekst := ' Door ';
        KarmTekst := ' Frame ';
      END;
      // << 1

      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","Dokument No");
      IF SalesLine.FINDLAST THEN
        NextLineNo := SalesLine."Line No." + 10000
      ELSE
        NextLineNo := 10000;

      Linie.RESET;
      Linie.SETRANGE("Document Type","Document Type");
      Linie.SETRANGE("Dokument No","Dokument No");
      // >> 5:
      Linie.SETRANGE(Textlinie,FALSE);
      // << 5
      IF Linie.FINDFIRST THEN REPEAT

      // Evt slet linier der er oprettet ved en fejl
        IF (Linie."D›r Linienr." <> 0) AND (Linie.Ordre = Linie.Ordre::Karm) THEN BEGIN
          SletLinie := Linie."D›r Linienr.";
          Linie."D›r Linienr." := 0;
          Linie.MODIFY;
          COMMIT;
          IF SalesLine.GET("Document Type","Dokument No",SletLinie) THEN
            SalesLine.DELETE(TRUE);
        END;
        IF (Linie."Karm Linienr." <> 0) AND (Linie.Ordre = Linie.Ordre::D›r) THEN BEGIN
          SletLinie := Linie."Karm Linienr.";
          Linie."Karm Linienr." := 0;
          Linie.MODIFY;
          COMMIT;
      // >> 6:
      //    IF SalesLine.GET("Document Type","Dokument No",SletLinie) THEN
      //      SalesLine.DELETE(TRUE);
          IF SalesLine.GET("Document Type","D›r Ordrenr.",SletLinie) THEN
            SalesLine.DELETE(TRUE);
      // << 6
        END;

      // >> 4:
        SideTekst := '';
        IF (Linie."Stk. V" <> 0) AND (Linie."Stk. H" = 0) THEN BEGIN
          IF SalesHeader."Language Code" = '' THEN
            SideTekst := ' V'
          ELSE
            SideTekst := ' L';
        END;
        IF (Linie."Stk. V" = 0) AND (Linie."Stk. H" <> 0) THEN BEGIN
          IF SalesHeader."Language Code" = '' THEN
            SideTekst := ' H'
          ELSE
            SideTekst := ' R';
        END;
      // << 4

      // Opdater hvis linier er oprettet
        IF (Linie."D›r Linienr." <> 0) AND (Linie.Ordre IN [Linie.Ordre::Begge,Linie.Ordre::D›r]) THEN
          ModifySalesLine(Linie,TRUE);
        IF (Linie."Karm Linienr." <> 0) AND (Linie.Ordre IN [Linie.Ordre::Begge,Linie.Ordre::Karm]) THEN
          ModifySalesLine(Linie,FALSE);

      // Opret linier
        IF (Linie."D›r Linienr." = 0) AND (Linie.Ordre IN [Linie.Ordre::Begge,Linie.Ordre::D›r]) THEN
          CreateSalesLine(Linie,TRUE);
        IF (Linie."Karm Linienr." = 0) AND (Linie.Ordre IN [Linie.Ordre::Begge,Linie.Ordre::Karm]) THEN
          CreateSalesLine(Linie,FALSE);

      UNTIL Linie.NEXT = 0;

      COMMIT;
      MESSAGE('Ordre opdateret.');
    END;

    PROCEDURE ModifySalesLine@1000000001(VAR SkemaLinie@1000000002 : Record 50016;D›r@1000000001 : Boolean);
    BEGIN
      // DAB
      // >> SYS1.02
      {
      // >> 9:
      IF SkemaLinie."D›rnr." <> '' THEN BEGIN
        SkemaLinie.TESTFIELD("D›r Type");
        SkemaLinie.TESTFIELD("Karm Dim.");
      END;
      // << 9
      }
      // << SYS1.02
      IF D›r THEN BEGIN
      // >> 6:
      //  IF NOT SalesLine.GET(SkemaLinie."Document Type",SkemaLinie."Dokument No",SkemaLinie."D›r Linienr.") THEN
        IF NOT SalesLine.GET(SkemaLinie."Document Type",D›rSalesHeader."No.",SkemaLinie."D›r Linienr.") THEN BEGIN
          SkemaLinie."D›r Linienr." := 0;
      // << 6
          EXIT; // Slettet
        END;
      // >> 1:
        IF SalesLine."Quantity Shipped" <> 0 THEN
          EXIT;
      // << 1
        IF SalesLine."No." <> SkemaLinie."D›r Varenr." THEN
          SalesLine.VALIDATE("No.",SkemaLinie."D›r Varenr.");
        SalesLine.Description := COPYSTR(D›rTekst + ' ' +SkemaLinie."D›rnr." + ' ' + SkemaLinie."D›r B"+'x'+SkemaLinie."D›r H" + ' ' +
                                 SkemaLinie."D›r Type" + ' ' + SkemaLinie."D›r Overflade",1,50);
      END ELSE BEGIN // Karm
        IF NOT SalesLine.GET(SkemaLinie."Document Type",SkemaLinie."Dokument No",SkemaLinie."Karm Linienr.") THEN
          EXIT; // Slettet
      // >> 1:
        IF SalesLine."Quantity Shipped" <> 0 THEN
          EXIT;
      // << 1

        IF SalesLine."No." <> SkemaLinie."Karm Varenr." THEN
          SalesLine.VALIDATE("No.",SkemaLinie."Karm Varenr.");
        SalesLine.Description := COPYSTR(KarmTekst + SkemaLinie."D›rnr." + ' ' +
                                 SkemaLinie."Udv. Karmm†l B" + 'x' + SkemaLinie."Udv. Karmm†l H" + ' ' +
                                 SkemaLinie."D›r Type" + ' ' + SkemaLinie."Karm Dim." + ' ' + SkemaLinie."Karm Farve" + SideTekst,1,50);
      END;

      SalesLine.VALIDATE(Quantity,Linie."Stk. V"+Linie."Stk. H");
      SalesLine.MODIFY;

      //>>SYS
      IF SalesLine.Type = SalesLine.Type::Item THEN BEGIN
        IF Item.GET(SalesLine."No.") THEN BEGIN
          IF Item.Skaffevare = TRUE THEN BEGIN
            IF SalesLine.Quantity <> 0 THEN BEGIN
              SalesLine.DeleteLotNo;
              SalesLine.CreateLotNo;
            END;
          END;
        END;
      END;
      //<<SYS
    END;

    PROCEDURE CreateSalesLine@1000000002(VAR SkemaLinie@1000000001 : Record 50016;D›r@1000000000 : Boolean);
    VAR
      PurchaseHeader@1000000002 : Record 38;
      PurchasesSetup@1000000003 : Record 312;
    BEGIN
      // >> 9:
      IF SkemaLinie."D›rnr." <> '' THEN BEGIN
        SkemaLinie.TESTFIELD("D›r Type");
        SkemaLinie.TESTFIELD("Karm Dim.");
      END;
      // << 9

      SalesLine.INIT;
      SalesLine."Document Type" := SkemaLinie."Document Type";
      // >> 6:
      IF D›r THEN
        SalesLine."Document No." := D›rSalesHeader."No."
      ELSE
      // << 6
        SalesLine."Document No." := SkemaLinie."Dokument No";
      SalesLine."Line No." := NextLineNo;
      NextLineNo := NextLineNo + 10000;
      SalesLine.VALIDATE(Type,SalesLine.Type::Item);
      SalesLine.INSERT;

      IF D›r THEN BEGIN
        SkemaLinie.TESTFIELD("D›r Varenr.");
        SalesLine.VALIDATE("No.",SkemaLinie."D›r Varenr.");
        SalesLine.Description := COPYSTR(D›rTekst + ' '+SkemaLinie."D›rnr." + ' ' + SkemaLinie."D›r B"+'x'+SkemaLinie."D›r H" + ' ' +
                                 SkemaLinie."D›r Type" + ' ' + SkemaLinie."D›r Overflade",1,50);
        SkemaLinie."D›r Linienr." := SalesLine."Line No.";
      END ELSE BEGIN // Karm
        SkemaLinie.TESTFIELD("Karm Varenr." );
        SalesLine.VALIDATE("No.",SkemaLinie."Karm Varenr.");
        SalesLine.Description := COPYSTR(KarmTekst + SkemaLinie."D›rnr." + ' ' +
                                 SkemaLinie."Udv. Karmm†l B" + 'x' + SkemaLinie."Udv. Karmm†l H" + ' ' +
                                 SkemaLinie."D›r Type" + ' ' + SkemaLinie."Karm Dim." + ' ' + SkemaLinie."Karm Farve" + SideTekst,1,50);
        SkemaLinie."Karm Linienr." := SalesLine."Line No.";
      END;

      SalesLine.VALIDATE(Quantity,SkemaLinie."Stk. V"+SkemaLinie."Stk. H");

      // >> 2:
      PurchasesSetup.GET;
      PurchasesSetup.TESTFIELD("Standard D›r leverand›r");
      PurchaseHeader.SETRANGE("Document Type",PurchaseHeader."Document Type"::Order);
      PurchaseHeader.SETRANGE("Buy-from Vendor No.",PurchasesSetup."Standard D›r leverand›r");
      IF SalesHeader."Job No." <> '' THEN
        PurchaseHeader.SETRANGE("Job No.",SalesHeader."Job No.")
      ELSE
        PurchaseHeader.SETRANGE("Job No.",SalesHeader."Indk›bes til Sagsnr.");
      // >> 6:
      //PurchaseHeader.SETRANGE("Salgsordrenr.",SalesHeader."No.");
      PurchaseHeader.SETRANGE("Salgsordrenr.",D›rSalesHeader."No.");
      // << 6
      IF PurchaseHeader.FINDFIRST THEN
        SalesLine."K›bsordrenr." := PurchaseHeader."No.";
      // << 2

      SalesLine.MODIFY(TRUE);

      //>>SYS
      IF SalesLine.Type = SalesLine.Type::Item THEN BEGIN
        IF Item.GET(SalesLine."No.") THEN BEGIN
          IF Item.Skaffevare = TRUE THEN BEGIN
            IF SalesLine.Quantity <> 0 THEN
              SalesLine.CreateLotNo;
          END;
        END;
      END;
      //<<SYS

      SkemaLinie.MODIFY;
    END;

    BEGIN
    {
      >> 1: RCG 251107 Stopper ikke ved leverede linier - men hopper over
                       Hvis ikke dansk - s† p† engelsk.
                       Hvis der er planlagt leveringsuge - m† kun ansvarlig ‘ndre
      >> 2: RCG 210909 Hvis der er k›bsordre tilknyttet - angives denne p† salgslinien.
      >> 3: RCG 230112 Skal angives afdelingskode p† ordren f›r der dannes linier.
      >> 4: RCG 031012 H›jre / Venstre skal angives p† ordrelinie.
      >> 5: RCG 221112 Tekstlinier skal ikke overf›res til salgsordre.
      >> 6: RCG 251112 Der opdateres 2 ordrer. Den f›rste/originale til Karme - og den anden til D›re.
      >> 7: RCG 191212 Mulighed for stadig at have Karme og D›re p† ‚n ordre.
      >> 8: RCG 191212 nsket Dato - 10 dage fra i dag. Mail til Sagsansvarlig + Gruppe ved dato‘ndringer.
      >> 9: RCG 191212 Kontrol p† at visse felter er indtastet.
      >> 10:RCG 070213 Sender mails med datoer til ansvarlig p† sagen.
      >> SYS1.02 DAB 06062013 Fjernet blokering p† Dyr type, karm.dim ved opdatering
      >> SYS1.03 DAB 19092013 Added field 50001 KarmLevTid og "›snket dato" skal ikke udregnes automatisk efter ›nske fra Torben Dalsgaard
      >> SYS1.03 DAB 27092013 Addd code to define KarmLevTid
    }
    END.
  }
}

